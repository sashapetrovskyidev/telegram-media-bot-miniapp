{"ast":null,"code":"import _objectWithoutProperties from \"/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nimport _objectSpread from \"/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nconst _excluded = [\"postEvent\", \"version\"],\n  _excluded2 = [\"reason\"],\n  _excluded3 = [\"reason\"],\n  _excluded4 = [\"token\"],\n  _excluded5 = [\"postEvent\"],\n  _excluded6 = [\"postEvent\", \"createRequestId\", \"version\", \"botInline\"],\n  _excluded7 = [\"themeParams\", \"botInline\", \"state\"],\n  _excluded8 = [\"is_expanded\", \"is_state_stable\"],\n  _excluded9 = [\"isStateStable\"],\n  _excluded0 = [\"params\"];\nvar Wt = Object.defineProperty;\nvar Ut = (e, t, s) => t in e ? Wt(e, t, {\n  enumerable: !0,\n  configurable: !0,\n  writable: !0,\n  value: s\n}) : e[t] = s;\nvar c = (e, t, s) => Ut(e, typeof t != \"symbol\" ? t + \"\" : t, s);\nfunction ot(e, t) {\n  let s;\n  const n = () => {\n    s !== void 0 && t && t(s), s = void 0;\n  };\n  return [() => s === void 0 ? s = e(n) : s, n];\n}\nfunction at(e) {\n  const t = V(),\n    {\n      count: s\n    } = t;\n  t.unsubscribe(e), s && !t.count && ie();\n}\nfunction Ht(e) {\n  return V().subscribe(e), () => at(e);\n}\nclass Ot {\n  constructor(t) {\n    let s = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    this.scope = t, this.options = s;\n  }\n  /**\n   * Prints message into a console in case, logger is currently enabled.\n   * @param level - log level.\n   * @param args - arguments.\n   */\n  print(t) {\n    const n = /* @__PURE__ */new Date(),\n      r = Intl.DateTimeFormat(\"en-GB\", {\n        hour: \"2-digit\",\n        minute: \"2-digit\",\n        second: \"2-digit\",\n        fractionalSecondDigits: 3,\n        timeZone: \"UTC\"\n      }).format(n),\n      {\n        textColor: i,\n        bgColor: o\n      } = this.options,\n      a = \"font-weight: bold;padding: 0 5px;border-radius:5px\";\n    for (var _len = arguments.length, s = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      s[_key - 1] = arguments[_key];\n    }\n    console[t](\"%c\".concat(r, \"%c / %c\").concat(this.scope), \"\".concat(a, \";background-color: lightblue;color:black\"), \"\", \"\".concat(a, \";\").concat(i ? \"color:\".concat(i, \";\") : \"\").concat(o ? \"background-color:\".concat(o) : \"\"), ...s);\n  }\n  /**\n   * Prints error message into a console.\n   * @param args\n   */\n  error() {\n    for (var _len2 = arguments.length, t = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      t[_key2] = arguments[_key2];\n    }\n    this.print(\"error\", ...t);\n  }\n  /**\n   * Prints log message into a console.\n   * @param args\n   */\n  log() {\n    for (var _len3 = arguments.length, t = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      t[_key3] = arguments[_key3];\n    }\n    this.print(\"log\", ...t);\n  }\n}\nconst F = new Ot(\"SDK\", {\n  bgColor: \"forestgreen\",\n  textColor: \"white\"\n});\nlet O = !1;\nconst st = _ref => {\n  let {\n    name: e,\n    payload: t\n  } = _ref;\n  F.log(\"Event received:\", t ? {\n    name: e,\n    payload: t\n  } : {\n    name: e\n  });\n};\nfunction Ze(e) {\n  O !== e && (O = e, e ? Ht(st) : at(st));\n}\nfunction Gt() {\n  O && F.log(...arguments);\n}\nclass T {\n  constructor() {\n    c(this, \"listeners\", /* @__PURE__ */new Map());\n    c(this, \"listenersCount\", 0);\n    c(this, \"subscribeListeners\", []);\n  }\n  /**\n   * Removes all event listeners.\n   */\n  clear() {\n    this.listeners.clear(), this.subscribeListeners = [];\n  }\n  /**\n   * Returns count of bound listeners.\n   */\n  get count() {\n    return this.listenersCount + this.subscribeListeners.length;\n  }\n  emit(t) {\n    for (var _len4 = arguments.length, s = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n      s[_key4 - 1] = arguments[_key4];\n    }\n    this.subscribeListeners.forEach(r => r({\n      event: t,\n      args: s\n    })), (this.listeners.get(t) || []).forEach(_ref2 => {\n      let [r, i] = _ref2;\n      r(...s), i && this.off(t, r);\n    });\n  }\n  /**\n   * Adds new event listener.\n   * @param event - event name.\n   * @param listener - event listener.\n   * @param once - should listener be called only once.\n   * @returns Function to remove bound event listener.\n   */\n  on(t, s, n) {\n    let r = this.listeners.get(t);\n    return r || this.listeners.set(t, r = []), r.push([s, n]), this.listenersCount += 1, () => this.off(t, s);\n  }\n  /**\n   * Removes event listener. In case, specified listener was bound several times, it removes\n   * only a single one.\n   * @param event - event name.\n   * @param listener - event listener.\n   */\n  off(t, s) {\n    const n = this.listeners.get(t) || [];\n    for (let r = 0; r < n.length; r += 1) if (s === n[r][0]) {\n      n.splice(r, 1), this.listenersCount -= 1;\n      return;\n    }\n  }\n  /**\n   * Adds a new event listener for all events.\n   * @param listener - event listener.\n   * @returns Function to remove event listener.\n   */\n  subscribe(t) {\n    return this.subscribeListeners.push(t), () => this.unsubscribe(t);\n  }\n  /**\n   * Removes global event listener. In case, specified listener was bound several times, it removes\n   * only a single one.\n   * @param listener - event listener.\n   */\n  unsubscribe(t) {\n    for (let s = 0; s < this.subscribeListeners.length; s += 1) if (this.subscribeListeners[s] === t) {\n      this.subscribeListeners.splice(s, 1);\n      return;\n    }\n  }\n}\nfunction G(e, t, s) {\n  return window.addEventListener(e, t, s), () => window.removeEventListener(e, t, s);\n}\nfunction J() {\n  let t = !1;\n  for (var _len5 = arguments.length, e = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n    e[_key5] = arguments[_key5];\n  }\n  const s = e.flat(1);\n  return [n => !t && s.push(n), () => {\n    t || (t = !0, s.forEach(n => n()));\n  }, t];\n}\nclass D extends Error {\n  constructor(t, s, n) {\n    super(s, {\n      cause: n\n    }), this.type = t, Object.setPrototypeOf(this, D.prototype);\n  }\n}\nfunction f(e, t, s) {\n  return new D(e, t, s);\n}\nconst jt = \"ERR_METHOD_UNSUPPORTED\",\n  zt = \"ERR_METHOD_PARAMETER_UNSUPPORTED\",\n  Ft = \"ERR_UNKNOWN_ENV\",\n  Jt = \"ERR_INVOKE_CUSTOM_METHOD_RESPONSE\",\n  Qt = \"ERR_TIMED_OUT\",\n  Yt = \"ERR_UNEXPECTED_TYPE\",\n  ct = \"ERR_PARSE\",\n  Zt = \"ERR_NAVIGATION_LIST_EMPTY\",\n  Kt = \"ERR_NAVIGATION_CURSOR_INVALID\",\n  Ke = \"ERR_NAVIGATION_ITEM_INVALID\",\n  Xe = \"ERR_SSR_INIT\",\n  Xt = \"ERR_INVALID_PATH_BASE\";\nfunction E() {\n  return f(Yt, \"Value has unexpected type\");\n}\nclass M {\n  constructor(t, s, n) {\n    this.parser = t, this.isOptional = s, this.type = n;\n  }\n  /**\n   * Attempts to parse passed value\n   * @param value - value to parse.\n   * @throws {SDKError} ERR_PARSE\n   * @see ERR_PARSE\n   */\n  parse(t) {\n    if (!(this.isOptional && t === void 0)) try {\n      return this.parser(t);\n    } catch (s) {\n      throw f(ct, \"Unable to parse value\".concat(this.type ? \" as \".concat(this.type) : \"\"), s);\n    }\n  }\n  optional() {\n    return this.isOptional = !0, this;\n  }\n}\nfunction x(e, t) {\n  return () => new M(e, !1, t);\n}\nconst w = x(e => {\n  if (typeof e == \"boolean\") return e;\n  const t = String(e);\n  if (t === \"1\" || t === \"true\") return !0;\n  if (t === \"0\" || t === \"false\") return !1;\n  throw E();\n}, \"boolean\");\nfunction ht(e, t) {\n  const s = {};\n  for (const n in e) {\n    const r = e[n];\n    if (!r) continue;\n    let i, o;\n    if (typeof r == \"function\" || \"parse\" in r) i = n, o = typeof r == \"function\" ? r : r.parse.bind(r);else {\n      const {\n        type: a\n      } = r;\n      i = r.from || n, o = typeof a == \"function\" ? a : a.parse.bind(a);\n    }\n    try {\n      const a = o(t(i));\n      a !== void 0 && (s[n] = a);\n    } catch (a) {\n      throw f(ct, \"Unable to parse field \\\"\".concat(n, \"\\\"\"), a);\n    }\n  }\n  return s;\n}\nfunction pt(e) {\n  let t = e;\n  if (typeof t == \"string\" && (t = JSON.parse(t)), typeof t != \"object\" || t === null || Array.isArray(t)) throw E();\n  return t;\n}\nfunction g(e, t) {\n  return new M(s => {\n    const n = pt(s);\n    return ht(e, r => n[r]);\n  }, !1, t);\n}\nconst y = x(e => {\n    if (typeof e == \"number\") return e;\n    if (typeof e == \"string\") {\n      const t = Number(e);\n      if (!Number.isNaN(t)) return t;\n    }\n    throw E();\n  }, \"number\"),\n  p = x(e => {\n    if (typeof e == \"string\" || typeof e == \"number\") return e.toString();\n    throw E();\n  }, \"string\");\nfunction ut(e) {\n  return g({\n    eventType: p(),\n    eventData: t => t\n  }).parse(e);\n}\nfunction te() {\n  [\"TelegramGameProxy_receiveEvent\", \"TelegramGameProxy\", \"Telegram\"].forEach(e => {\n    delete window[e];\n  });\n}\nfunction j(e, t) {\n  window.dispatchEvent(new MessageEvent(\"message\", {\n    data: JSON.stringify({\n      eventType: e,\n      eventData: t\n    }),\n    // We specify window.parent to imitate the case, the parent iframe sent us this event.\n    source: window.parent\n  }));\n}\nfunction ee() {\n  [[\"TelegramGameProxy_receiveEvent\"],\n  // Windows Phone.\n  [\"TelegramGameProxy\", \"receiveEvent\"],\n  // Desktop.\n  [\"Telegram\", \"WebView\", \"receiveEvent\"]\n  // Android and iOS.\n  ].forEach(e => {\n    let t = window;\n    e.forEach((s, n, r) => {\n      if (n === r.length - 1) {\n        t[s] = j;\n        return;\n      }\n      s in t || (t[s] = {}), t = t[s];\n    });\n  });\n}\nconst se = {\n  clipboard_text_received: g({\n    req_id: p(),\n    data: e => e === null ? e : p().optional().parse(e)\n  }),\n  custom_method_invoked: g({\n    req_id: p(),\n    result: e => e,\n    error: p().optional()\n  }),\n  popup_closed: {\n    parse(e) {\n      return g({\n        button_id: t => t == null ? void 0 : p().parse(t)\n      }).parse(e !== null && e !== void 0 ? e : {});\n    }\n  },\n  viewport_changed: g({\n    height: y(),\n    width: e => e == null ? window.innerWidth : y().parse(e),\n    is_state_stable: w(),\n    is_expanded: w()\n  })\n};\nfunction ne() {\n  const e = new T(),\n    t = new T();\n  t.subscribe(n => {\n    e.emit(\"event\", {\n      name: n.event,\n      payload: n.args[0]\n    });\n  }), ee();\n  const [, s] = J(\n  // Don't forget to remove created handlers.\n  te,\n  // Add \"resize\" event listener to make sure, we always have fresh viewport information.\n  // Desktop version of Telegram is sometimes not sending the viewport_changed\n  // event. For example, when the MainButton is shown. That's why we should\n  // add our own listener to make sure, viewport information is always fresh.\n  // Issue: https://github.com/Telegram-Mini-Apps/tma.js/issues/10\n  G(\"resize\", () => {\n    t.emit(\"viewport_changed\", {\n      width: window.innerWidth,\n      height: window.innerHeight,\n      is_state_stable: !0,\n      is_expanded: !0\n    });\n  }),\n  // Add listener, which handles events sent from the Telegram web application and also events\n  // generated by the local emitEvent function.\n  G(\"message\", n => {\n    if (n.source !== window.parent) return;\n    let r;\n    try {\n      r = ut(n.data);\n    } catch (_unused) {\n      return;\n    }\n    const {\n        eventType: i,\n        eventData: o\n      } = r,\n      a = se[i];\n    try {\n      const h = a ? a.parse(o) : o;\n      t.emit(...(h ? [i, h] : [i]));\n    } catch (h) {\n      F.error(\"An error occurred processing the \\\"\".concat(i, \"\\\" event from the Telegram application.\\nPlease, file an issue here:\\nhttps://github.com/Telegram-Mini-Apps/tma.js/issues/new/choose\"), r, h);\n    }\n  }),\n  // Clear emitters.\n  () => e.clear(), () => t.clear());\n  return [{\n    on: t.on.bind(t),\n    off: t.off.bind(t),\n    subscribe(n) {\n      return e.on(\"event\", n);\n    },\n    unsubscribe(n) {\n      e.off(\"event\", n);\n    },\n    get count() {\n      return t.count + e.count;\n    }\n  }, s];\n}\nconst [re, ie] = ot(e => {\n  const [t, s] = ne(),\n    n = t.off.bind(t);\n  return t.off = (r, i) => {\n    const {\n      count: o\n    } = t;\n    n(r, i), o && !t.count && e();\n  }, [t, s];\n}, _ref3 => {\n  let [, e] = _ref3;\n  return e();\n});\nfunction V() {\n  return re()[0];\n}\nfunction L(e, t) {\n  V().off(e, t);\n}\nfunction b(e, t, s) {\n  return V().on(e, t, s);\n}\nfunction q(e) {\n  return typeof e == \"object\" && e !== null && !Array.isArray(e);\n}\nfunction oe(e, t) {\n  const s = e.split(\".\"),\n    n = t.split(\".\"),\n    r = Math.max(s.length, n.length);\n  for (let i = 0; i < r; i += 1) {\n    const o = parseInt(s[i] || \"0\", 10),\n      a = parseInt(n[i] || \"0\", 10);\n    if (o !== a) return o > a ? 1 : -1;\n  }\n  return 0;\n}\nfunction _(e, t) {\n  return oe(e, t) <= 0;\n}\nfunction v(e, t, s) {\n  if (typeof s == \"string\") {\n    if (e === \"web_app_open_link\") {\n      if (t === \"try_instant_view\") return _(\"6.4\", s);\n      if (t === \"try_browser\") return _(\"7.6\", s);\n    }\n    if (e === \"web_app_set_header_color\" && t === \"color\") return _(\"6.9\", s);\n    if (e === \"web_app_close\" && t === \"return_back\") return _(\"7.6\", s);\n  }\n  switch (e) {\n    case \"web_app_open_tg_link\":\n    case \"web_app_open_invoice\":\n    case \"web_app_setup_back_button\":\n    case \"web_app_set_background_color\":\n    case \"web_app_set_header_color\":\n    case \"web_app_trigger_haptic_feedback\":\n      return _(\"6.1\", t);\n    case \"web_app_open_popup\":\n      return _(\"6.2\", t);\n    case \"web_app_close_scan_qr_popup\":\n    case \"web_app_open_scan_qr_popup\":\n    case \"web_app_read_text_from_clipboard\":\n      return _(\"6.4\", t);\n    case \"web_app_switch_inline_query\":\n      return _(\"6.7\", t);\n    case \"web_app_invoke_custom_method\":\n    case \"web_app_request_write_access\":\n    case \"web_app_request_phone\":\n      return _(\"6.9\", t);\n    case \"web_app_setup_settings_button\":\n      return _(\"6.10\", t);\n    case \"web_app_biometry_get_info\":\n    case \"web_app_biometry_open_settings\":\n    case \"web_app_biometry_request_access\":\n    case \"web_app_biometry_request_auth\":\n    case \"web_app_biometry_update_token\":\n      return _(\"7.2\", t);\n    default:\n      return [\"iframe_ready\", \"iframe_will_reload\", \"web_app_close\", \"web_app_data_send\", \"web_app_expand\", \"web_app_open_link\", \"web_app_ready\", \"web_app_request_theme\", \"web_app_request_viewport\", \"web_app_setup_main_button\", \"web_app_setup_closing_behavior\"].includes(e);\n  }\n}\nfunction lt(e) {\n  return \"external\" in e && q(e.external) && \"notify\" in e.external && typeof e.external.notify == \"function\";\n}\nfunction dt(e) {\n  return \"TelegramWebviewProxy\" in e && q(e.TelegramWebviewProxy) && \"postEvent\" in e.TelegramWebviewProxy && typeof e.TelegramWebviewProxy.postEvent == \"function\";\n}\nfunction _t() {\n  try {\n    return window.self !== window.top;\n  } catch (_unused2) {\n    return !0;\n  }\n}\nconst ae = \"https://web.telegram.org\";\nlet ft = ae;\nfunction ts(e) {\n  ft = e;\n}\nfunction ce() {\n  return ft;\n}\nfunction R(e, t, s) {\n  let n = {},\n    r;\n  if (!t && !s ? n = {} : t && s ? (n = s, r = t) : t && (\"targetOrigin\" in t ? n = t : r = t), Gt(\"Posting event:\", r ? {\n    event: e,\n    data: r\n  } : {\n    event: e\n  }), _t()) return window.parent.postMessage(JSON.stringify({\n    eventType: e,\n    eventData: r\n  }), n.targetOrigin || ce());\n  if (lt(window)) {\n    window.external.notify(JSON.stringify({\n      eventType: e,\n      eventData: r\n    }));\n    return;\n  }\n  if (dt(window)) {\n    window.TelegramWebviewProxy.postEvent(e, JSON.stringify(r));\n    return;\n  }\n  throw f(Ft, \"Unable to determine current environment and possible way to send event. You are probably trying to use Mini Apps method outside the Telegram application environment.\");\n}\nfunction he(e) {\n  return (t, s) => {\n    if (!v(t, e)) throw f(jt, \"Method \\\"\".concat(t, \"\\\" is unsupported in Mini Apps version \").concat(e));\n    if (q(s) && t === \"web_app_set_header_color\" && \"color\" in s && !v(t, \"color\", e)) throw f(zt, \"Parameter \\\"color\\\" of \\\"\".concat(t, \"\\\" method is unsupported in Mini Apps version \").concat(e));\n    return R(t, s);\n  };\n}\nfunction gt(e) {\n  return _ref4 => {\n    let {\n      req_id: t\n    } = _ref4;\n    return t === e;\n  };\n}\nfunction bt(e) {\n  return f(Qt, \"Timeout reached: \".concat(e, \"ms\"));\n}\nfunction wt(e, t) {\n  return Promise.race([typeof e == \"function\" ? e() : e, new Promise((s, n) => {\n    setTimeout(() => {\n      n(bt(t));\n    }, t);\n  })]);\n}\nasync function d(e) {\n  let t;\n  const s = new Promise(a => t = a),\n    {\n      event: n,\n      capture: r,\n      timeout: i\n    } = e,\n    [, o] = J(\n    // We need to iterate over all tracked events, and create their event listeners.\n    (Array.isArray(n) ? n : [n]).map(a => b(a, h => {\n      (!r || (Array.isArray(n) ? r({\n        event: a,\n        payload: h\n      }) : r(h))) && t(h);\n    })));\n  try {\n    return (e.postEvent || R)(e.method, e.params), await (i ? wt(s, i) : s);\n  } finally {\n    o();\n  }\n}\nasync function S(e, t, s) {\n  let n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  const {\n    result: r,\n    error: i\n  } = await d(_objectSpread(_objectSpread({}, n), {}, {\n    method: \"web_app_invoke_custom_method\",\n    event: \"custom_method_invoked\",\n    params: {\n      method: e,\n      params: t,\n      req_id: s\n    },\n    capture: gt(s)\n  }));\n  if (i) throw f(Jt, i);\n  return r;\n}\nfunction z() {\n  for (var _len6 = arguments.length, e = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {\n    e[_key6] = arguments[_key6];\n  }\n  return e.map(t => {\n    if (typeof t == \"string\") return t;\n    if (q(t)) return z(Object.entries(t).map(s => s[1] && s[0]));\n    if (Array.isArray(t)) return z(...t);\n  }).filter(Boolean).join(\" \");\n}\nfunction es() {\n  for (var _len7 = arguments.length, e = new Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {\n    e[_key7] = arguments[_key7];\n  }\n  return e.reduce((t, s) => (q(s) && Object.entries(s).forEach(_ref5 => {\n    let [n, r] = _ref5;\n    const i = z(t[n], r);\n    i.length && (t[n] = i);\n  }), t), {});\n}\nfunction Q(e) {\n  return /^#[\\da-f]{6}$/i.test(e);\n}\nfunction pe(e) {\n  return /^#[\\da-f]{3}$/i.test(e);\n}\nfunction mt(e) {\n  const t = e.replace(/\\s/g, \"\").toLowerCase();\n  if (Q(t)) return t;\n  if (pe(t)) {\n    let n = \"#\";\n    for (let r = 0; r < 3; r += 1) n += t[1 + r].repeat(2);\n    return n;\n  }\n  const s = t.match(/^rgb\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3})\\)$/) || t.match(/^rgba\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3}),\\d{1,3}\\)$/);\n  if (!s) throw new Error(\"Value \\\"\".concat(e, \"\\\" does not satisfy any of known RGB formats.\"));\n  return s.slice(1).reduce((n, r) => {\n    const i = parseInt(r, 10).toString(16);\n    return n + (i.length === 1 ? \"0\" : \"\") + i;\n  }, \"#\");\n}\nfunction yt(e) {\n  const t = mt(e);\n  return Math.sqrt([0.299, 0.587, 0.114].reduce((s, n, r) => {\n    const i = parseInt(t.slice(1 + r * 2, 1 + (r + 1) * 2), 16);\n    return s + i * i * n;\n  }, 0)) < 120;\n}\nclass ue {\n  constructor(t) {\n    c(this, \"ee\", new T());\n    /**\n     * Adds new event listener.\n     */\n    c(this, \"on\", this.ee.on.bind(this.ee));\n    /**\n     * Removes event listener.\n     */\n    c(this, \"off\", this.ee.off.bind(this.ee));\n    this.state = t;\n  }\n  /**\n   * Clones current state and returns its copy.\n   */\n  clone() {\n    return _objectSpread({}, this.state);\n  }\n  set(t, s) {\n    Object.entries(typeof t == \"string\" ? {\n      [t]: s\n    } : t).reduce((r, _ref6) => {\n      let [i, o] = _ref6;\n      return this.state[i] === o || o === void 0 ? r : (this.state[i] = o, this.ee.emit(\"change:\".concat(i), o), !0);\n    }, !1) && this.ee.emit(\"change\", this.state);\n  }\n  /**\n   * Returns value by specified key.\n   * @param key - state key.\n   */\n  get(t) {\n    return this.state[t];\n  }\n}\nclass Y {\n  constructor(t) {\n    c(this, \"state\");\n    /**\n     * Gets the state value.\n     */\n    c(this, \"get\");\n    /**\n     * Sets the state value.\n     */\n    c(this, \"set\");\n    /**\n     * Clones the current state.\n     */\n    c(this, \"clone\");\n    this.state = new ue(t), this.set = this.state.set.bind(this.state), this.get = this.state.get.bind(this.state), this.clone = this.state.clone.bind(this.state);\n  }\n}\nfunction vt(e, t) {\n  return s => v(t[s], e);\n}\nclass Z extends Y {\n  constructor(s, n, r) {\n    super(s);\n    /**\n     * @returns True, if specified method is supported by the current component.\n     */\n    c(this, \"supports\");\n    this.supports = vt(n, r);\n  }\n}\nclass le extends Z {\n  constructor(s, n, r) {\n    super({\n      isVisible: s\n    }, n, {\n      show: \"web_app_setup_back_button\",\n      hide: \"web_app_setup_back_button\"\n    });\n    /**\n     * Adds a new event listener.\n     * @param event - event to listen.\n     * @param listener - listener to add.\n     */\n    c(this, \"on\", (s, n) => s === \"click\" ? b(\"back_button_pressed\", n) : this.state.on(s, n));\n    /**\n     * Removes the event listener.\n     * @param event - event to listen.\n     * @param listener - listener to remove.\n     */\n    c(this, \"off\", (s, n) => s === \"click\" ? L(\"back_button_pressed\", n) : this.state.off(s, n));\n    this.postEvent = r;\n  }\n  set isVisible(s) {\n    this.set(\"isVisible\", s), this.postEvent(\"web_app_setup_back_button\", {\n      is_visible: s\n    });\n  }\n  /**\n   * True if BackButton is currently visible.\n   */\n  get isVisible() {\n    return this.get(\"isVisible\");\n  }\n  /**\n   * Hides the BackButton.\n   */\n  hide() {\n    this.isVisible = !1;\n  }\n  /**\n   * Shows the BackButton.\n   */\n  show() {\n    this.isVisible = !0;\n  }\n}\nconst Et = x(e => e instanceof Date ? e : new Date(y().parse(e) * 1e3), \"Date\");\nfunction K(e, t) {\n  return new M(s => {\n    if (typeof s != \"string\" && !(s instanceof URLSearchParams)) throw E();\n    const n = typeof s == \"string\" ? new URLSearchParams(s) : s;\n    return ht(e, r => {\n      const i = n.get(r);\n      return i === null ? void 0 : i;\n    });\n  }, !1, t);\n}\nconst de = g({\n    id: y(),\n    type: p(),\n    title: p(),\n    photoUrl: {\n      type: p().optional(),\n      from: \"photo_url\"\n    },\n    username: p().optional()\n  }, \"Chat\").optional(),\n  nt = g({\n    addedToAttachmentMenu: {\n      type: w().optional(),\n      from: \"added_to_attachment_menu\"\n    },\n    allowsWriteToPm: {\n      type: w().optional(),\n      from: \"allows_write_to_pm\"\n    },\n    firstName: {\n      type: p(),\n      from: \"first_name\"\n    },\n    id: y(),\n    isBot: {\n      type: w().optional(),\n      from: \"is_bot\"\n    },\n    isPremium: {\n      type: w().optional(),\n      from: \"is_premium\"\n    },\n    languageCode: {\n      type: p().optional(),\n      from: \"language_code\"\n    },\n    lastName: {\n      type: p().optional(),\n      from: \"last_name\"\n    },\n    photoUrl: {\n      type: p().optional(),\n      from: \"photo_url\"\n    },\n    username: p().optional()\n  }, \"User\").optional();\nfunction xt() {\n  return K({\n    authDate: {\n      type: Et(),\n      from: \"auth_date\"\n    },\n    canSendAfter: {\n      type: y().optional(),\n      from: \"can_send_after\"\n    },\n    chat: de,\n    chatInstance: {\n      type: p().optional(),\n      from: \"chat_instance\"\n    },\n    chatType: {\n      type: p().optional(),\n      from: \"chat_type\"\n    },\n    hash: p(),\n    queryId: {\n      type: p().optional(),\n      from: \"query_id\"\n    },\n    receiver: nt,\n    startParam: {\n      type: p().optional(),\n      from: \"start_param\"\n    },\n    user: nt\n  }, \"InitData\");\n}\nconst _e = x(e => mt(p().parse(e)), \"rgb\");\nfunction fe(e) {\n  return e.replace(/_[a-z]/g, t => t[1].toUpperCase());\n}\nfunction ge(e) {\n  return e.replace(/[A-Z]/g, t => \"_\".concat(t.toLowerCase()));\n}\nconst Pt = x(e => {\n  const t = _e().optional();\n  return Object.entries(pt(e)).reduce((s, _ref7) => {\n    let [n, r] = _ref7;\n    return s[fe(n)] = t.parse(r), s;\n  }, {});\n}, \"ThemeParams\");\nfunction X(e) {\n  return K({\n    botInline: {\n      type: w().optional(),\n      from: \"tgWebAppBotInline\"\n    },\n    initData: {\n      type: xt().optional(),\n      from: \"tgWebAppData\"\n    },\n    initDataRaw: {\n      type: p().optional(),\n      from: \"tgWebAppData\"\n    },\n    platform: {\n      type: p(),\n      from: \"tgWebAppPlatform\"\n    },\n    showSettings: {\n      type: w().optional(),\n      from: \"tgWebAppShowSettings\"\n    },\n    startParam: {\n      type: p().optional(),\n      from: \"tgWebAppStartParam\"\n    },\n    themeParams: {\n      type: Pt(),\n      from: \"tgWebAppThemeParams\"\n    },\n    version: {\n      type: p(),\n      from: \"tgWebAppVersion\"\n    }\n  }).parse(e);\n}\nfunction St(e) {\n  return X(e.replace(/^[^?#]*[?#]/, \"\").replace(/[?#]/g, \"&\"));\n}\nfunction be() {\n  return St(window.location.href);\n}\nfunction Ct() {\n  return performance.getEntriesByType(\"navigation\")[0];\n}\nfunction we() {\n  const e = Ct();\n  if (!e) throw new Error(\"Unable to get first navigation entry.\");\n  return St(e.name);\n}\nfunction Tt(e) {\n  return \"tma.js/\".concat(e.replace(/[A-Z]/g, t => \"-\".concat(t.toLowerCase())));\n}\nfunction Rt(e, t) {\n  sessionStorage.setItem(Tt(e), JSON.stringify(t));\n}\nfunction At(e) {\n  const t = sessionStorage.getItem(Tt(e));\n  try {\n    return t ? JSON.parse(t) : void 0;\n  } catch (_unused3) {}\n}\nfunction me() {\n  return X(At(\"launchParams\") || \"\");\n}\nfunction It(e) {\n  return JSON.stringify(Object.fromEntries(Object.entries(e).map(_ref8 => {\n    let [t, s] = _ref8;\n    return [ge(t), s];\n  })));\n}\nfunction ye(e) {\n  const {\n      initDataRaw: t,\n      themeParams: s,\n      platform: n,\n      version: r,\n      showSettings: i,\n      startParam: o,\n      botInline: a\n    } = e,\n    h = new URLSearchParams();\n  return h.set(\"tgWebAppPlatform\", n), h.set(\"tgWebAppThemeParams\", It(s)), h.set(\"tgWebAppVersion\", r), t && h.set(\"tgWebAppData\", t), o && h.set(\"tgWebAppStartParam\", o), typeof i == \"boolean\" && h.set(\"tgWebAppShowSettings\", i ? \"1\" : \"0\"), typeof a == \"boolean\" && h.set(\"tgWebAppBotInline\", a ? \"1\" : \"0\"), h.toString();\n}\nfunction qt(e) {\n  Rt(\"launchParams\", ye(e));\n}\nfunction ve() {\n  for (const e of [\n  // Try to retrieve launch parameters from the current location. This method can return\n  // nothing in case, location was changed and then page was reloaded.\n  be,\n  // Then, try using the lower level API - window.performance.\n  we,\n  // Finally, try to extract launch parameters from the session storage.\n  me]) try {\n    const t = e();\n    return qt(t), t;\n  } catch (_unused4) {}\n  throw new Error(\"Unable to retrieve launch parameters from any known source.\");\n}\nfunction kt() {\n  const e = Ct();\n  return !!(e && e.type === \"reload\");\n}\nfunction Ee() {\n  let e = 0;\n  return () => (e += 1).toString();\n}\nconst [xe] = ot(Ee);\nfunction l(e, t) {\n  return () => {\n    const s = ve(),\n      n = _objectSpread(_objectSpread({}, s), {}, {\n        postEvent: he(s.version),\n        createRequestId: xe()\n      });\n    if (typeof e == \"function\") return e(n);\n    const [r, i, o] = J(),\n      a = t(_objectSpread(_objectSpread({}, n), {}, {\n        // State should only be passed only in case, current page was reloaded. If we don't add\n        // this check, state restoration will work improperly in the web version of Telegram,\n        // when we are always working in the same \"session\" (tab).\n        state: kt() ? At(e) : void 0,\n        addCleanup: r\n      })),\n      h = u => (o || r(u.on(\"change\", Bt => {\n        Rt(e, Bt);\n      })), u);\n    return [a instanceof Promise ? a.then(h) : h(a), i];\n  };\n}\nconst ss = l(\"backButton\", _ref9 => {\n  let {\n    postEvent: e,\n    version: t,\n    state: s = {\n      isVisible: !1\n    }\n  } = _ref9;\n  return new le(s.isVisible, t, e);\n});\nclass k extends Z {\n  constructor() {\n    super(...arguments);\n    /**\n     * Adds a new event listener.\n     */\n    c(this, \"on\", this.state.on.bind(this.state));\n    /**\n     * Removes the event listener.\n     */\n    c(this, \"off\", this.state.off.bind(this.state));\n  }\n}\nfunction Nt(e) {\n  const t = e.available ? e : {\n    available: !1,\n    device_id: \"\",\n    token_saved: !1,\n    access_requested: !1,\n    access_granted: !1,\n    type: \"\"\n  };\n  return {\n    available: !0,\n    type: t.type,\n    deviceId: t.device_id,\n    tokenSaved: t.token_saved,\n    accessRequested: t.access_requested,\n    accessGranted: t.access_granted\n  };\n}\nclass Pe extends k {\n  constructor(_ref0) {\n    let {\n        postEvent: s,\n        version: n\n      } = _ref0,\n      r = _objectWithoutProperties(_ref0, _excluded);\n    super(r, n, {\n      auth: \"web_app_biometry_request_auth\",\n      openSettings: \"web_app_biometry_open_settings\",\n      requestAccess: \"web_app_biometry_request_access\",\n      updateToken: \"web_app_biometry_update_token\"\n    });\n    c(this, \"postEvent\");\n    c(this, \"authPromise\");\n    c(this, \"accessPromise\");\n    this.postEvent = s;\n  }\n  /**\n   * Shows whether biometry is available.\n   */\n  get available() {\n    return this.get(\"available\");\n  }\n  /**\n   * Shows whether permission to use biometrics has been granted.\n   */\n  get accessGranted() {\n    return this.get(\"accessGranted\");\n  }\n  /**\n   * Shows whether if permission to use biometrics has been requested.\n   */\n  get accessRequested() {\n    return this.get(\"accessRequested\");\n  }\n  /**\n   * Authenticates the user using biometrics.\n   * @param options - method options.\n   * @since 7.2\n   * @returns Token from the local secure storage, if authentication was successful.\n   */\n  async authenticate(_ref1) {\n    let {\n        reason: s\n      } = _ref1,\n      n = _objectWithoutProperties(_ref1, _excluded2);\n    return this.authPromise || (this.authPromise = d(_objectSpread(_objectSpread({}, n), {}, {\n      method: \"web_app_biometry_request_auth\",\n      event: \"biometry_auth_requested\",\n      postEvent: this.postEvent,\n      params: {\n        // TODO: Check if reason is empty works fine.\n        reason: (s || \"\").trim()\n      }\n    })).then(_ref10 => {\n      let {\n        token: r\n      } = _ref10;\n      return r;\n    }).finally(() => this.authPromise = void 0)), this.authPromise;\n  }\n  /**\n   * A unique device identifier that can be used to match the token to the device.\n   */\n  get deviceId() {\n    return this.get(\"deviceId\");\n  }\n  /**\n   * Opens the biometric access settings for bots. Useful when you need to request biometrics\n   * access to users who haven't granted it yet.\n   *\n   * _Note that this method can be called only in response to user interaction with the Mini App\n   * interface (e.g. a click inside the Mini App or on the main button)_.\n   * @since 7.2\n   */\n  openSettings() {\n    this.postEvent(\"web_app_biometry_open_settings\");\n  }\n  /**\n   * Requests permission to use biometrics.\n   * @since 7.2\n   * @returns Promise with true, if access was granted.\n   */\n  requestAccess() {\n    let _ref11 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      {\n        reason: s\n      } = _ref11,\n      n = _objectWithoutProperties(_ref11, _excluded3);\n    return this.accessPromise || (this.accessPromise = d(_objectSpread(_objectSpread({}, n), {}, {\n      postEvent: this.postEvent,\n      method: \"web_app_biometry_request_access\",\n      event: \"biometry_info_received\",\n      params: {\n        reason: s || \"\"\n      }\n    })).then(r => {\n      const i = Nt(r);\n      return this.set(i), i.accessGranted;\n    }).finally(() => this.accessPromise = void 0)), this.accessPromise;\n  }\n  /**\n   * The type of biometrics currently available on the device.\n   */\n  get biometryType() {\n    return this.get(\"biometryType\");\n  }\n  /**\n   * Shows whether token was saved previously in the local secure storage.\n   */\n  get tokenSaved() {\n    return this.get(\"tokenSaved\");\n  }\n  /**\n   * Updates the biometric token in a secure storage on the device.\n   * @returns Promise with `true`, if token was updated.\n   */\n  async updateToken() {\n    let _ref12 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      {\n        token: s\n      } = _ref12,\n      n = _objectWithoutProperties(_ref12, _excluded4);\n    return [\"removed\", \"updated\"].includes((await d(_objectSpread(_objectSpread({}, n), {}, {\n      postEvent: this.postEvent,\n      method: \"web_app_biometry_update_token\",\n      event: \"biometry_token_updated\",\n      params: {\n        token: s || \"\"\n      }\n    }))).status);\n  }\n}\nasync function Se(e) {\n  return Nt(await d(_objectSpread(_objectSpread({}, e || {}), {}, {\n    method: \"web_app_biometry_get_info\",\n    event: \"biometry_info_received\"\n  })));\n}\nconst ns = l(\"biometryManager\", async _ref13 => {\n  let {\n    postEvent: e,\n    version: t,\n    state: s\n  } = _ref13;\n  return new Pe(_objectSpread(_objectSpread({}, s || v(\"web_app_biometry_get_info\", t) ? s || (await Se({\n    timeout: 1e3\n  })) : {\n    available: !1,\n    accessGranted: !1,\n    accessRequested: !1,\n    tokenSaved: !1,\n    deviceId: \"\"\n  }), {}, {\n    version: t,\n    postEvent: e\n  }));\n});\nclass tt extends Y {\n  constructor() {\n    super(...arguments);\n    /**\n     * Adds a new event listener.\n     */\n    c(this, \"on\", this.state.on.bind(this.state));\n    /**\n     * Removes the event listener.\n     */\n    c(this, \"off\", this.state.off.bind(this.state));\n  }\n}\nclass Ce extends tt {\n  constructor(t, s) {\n    super({\n      isConfirmationNeeded: t\n    }), this.postEvent = s;\n  }\n  set isConfirmationNeeded(t) {\n    this.set(\"isConfirmationNeeded\", t), this.postEvent(\"web_app_setup_closing_behavior\", {\n      need_confirmation: t\n    });\n  }\n  /**\n   * True, if the confirmation dialog should be shown while the user is trying to close\n   * the Mini App.\n   */\n  get isConfirmationNeeded() {\n    return this.get(\"isConfirmationNeeded\");\n  }\n  /**\n   * Disables the confirmation dialog when closing the Mini App.\n   */\n  disableConfirmation() {\n    this.isConfirmationNeeded = !1;\n  }\n  /**\n   * Enables the confirmation dialog when closing the Mini App.\n   */\n  enableConfirmation() {\n    this.isConfirmationNeeded = !0;\n  }\n}\nconst rs = l(\"closingBehavior\", _ref14 => {\n  let {\n    postEvent: e,\n    state: t = {\n      isConfirmationNeeded: !1\n    }\n  } = _ref14;\n  return new Ce(t.isConfirmationNeeded, e);\n});\nclass et {\n  constructor(t, s) {\n    /**\n     * @returns True, if specified method is supported by the current component.\n     */\n    c(this, \"supports\");\n    this.supports = vt(t, s);\n  }\n}\nfunction Te(e) {\n  if (Array.isArray(e)) return e;\n  if (typeof e == \"string\") try {\n    const t = JSON.parse(e);\n    if (Array.isArray(t)) return t;\n  } catch (_unused5) {}\n  throw E();\n}\nclass Re extends M {\n  constructor(s, n, r) {\n    super(Te, n, r);\n    c(this, \"itemParser\");\n    this.itemParser = typeof s == \"function\" ? s : s.parse.bind(s);\n  }\n  /**\n   * Attempts to parse passed value\n   * @param value - value to parse.\n   * @throws {SDKError} ERR_PARSE\n   * @see ERR_PARSE\n   */\n  parse(s) {\n    const n = super.parse(s);\n    return n === void 0 ? n : n.map(this.itemParser);\n  }\n  of(s) {\n    return this.itemParser = typeof s == \"function\" ? s : s.parse.bind(s), this;\n  }\n}\nfunction Ae(e) {\n  return new Re(t => t, !1, e);\n}\nfunction rt(e, t) {\n  return Object.fromEntries(e.map(s => [s, t]));\n}\nclass Ie extends et {\n  constructor(t, s, n) {\n    super(t, {\n      delete: \"web_app_invoke_custom_method\",\n      get: \"web_app_invoke_custom_method\",\n      getKeys: \"web_app_invoke_custom_method\",\n      set: \"web_app_invoke_custom_method\"\n    }), this.createRequestId = s, this.postEvent = n;\n  }\n  /**\n   * Deletes specified key or keys from the cloud storage.\n   * @param keyOrKeys - key or keys to delete.\n   * @param options - request execution options.\n   */\n  async delete(t) {\n    let s = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const n = Array.isArray(t) ? t : [t];\n    n.length && (await S(\"deleteStorageValues\", {\n      keys: n\n    }, this.createRequestId(), _objectSpread(_objectSpread({}, s), {}, {\n      postEvent: this.postEvent\n    })));\n  }\n  /**\n   * Returns list of all keys presented in the cloud storage.\n   * @param options - request execution options.\n   */\n  async getKeys() {\n    let t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return Ae().of(p()).parse(await S(\"getStorageKeys\", {}, this.createRequestId(), _objectSpread(_objectSpread({}, t), {}, {\n      postEvent: this.postEvent\n    })));\n  }\n  async get(t) {\n    let s = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const n = Array.isArray(t) ? t : [t];\n    if (!n.length) return rt(n, \"\");\n    const r = await S(\"getStorageValues\", {\n        keys: n\n      }, this.createRequestId(), _objectSpread(_objectSpread({}, s), {}, {\n        postEvent: this.postEvent\n      })),\n      i = g(rt(n, p()), \"CloudStorageData\").parse(r);\n    return Array.isArray(t) ? i : i[t];\n  }\n  /**\n   * Saves specified value by key.\n   * @param key - storage key.\n   * @param value - storage value.\n   * @param options - request execution options.\n   */\n  async set(t, s) {\n    let n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    await S(\"saveStorageValue\", {\n      key: t,\n      value: s\n    }, this.createRequestId(), _objectSpread(_objectSpread({}, n), {}, {\n      postEvent: this.postEvent\n    }));\n  }\n}\nconst is = l(_ref15 => {\n  let {\n    createRequestId: e,\n    postEvent: t,\n    version: s\n  } = _ref15;\n  return new Ie(s, e, t);\n});\nclass qe extends et {\n  constructor(t, s) {\n    super(t, {\n      impactOccurred: \"web_app_trigger_haptic_feedback\",\n      notificationOccurred: \"web_app_trigger_haptic_feedback\",\n      selectionChanged: \"web_app_trigger_haptic_feedback\"\n    }), this.postEvent = s;\n  }\n  /**\n   * A method tells that an impact occurred. The Telegram app may play the\n   * appropriate haptics based on style value passed.\n   * @param style - impact style.\n   */\n  impactOccurred(t) {\n    this.postEvent(\"web_app_trigger_haptic_feedback\", {\n      type: \"impact\",\n      impact_style: t\n    });\n  }\n  /**\n   * A method tells that a task or action has succeeded, failed, or produced\n   * a warning. The Telegram app may play the appropriate haptics based on\n   * type value passed.\n   * @param type - notification type.\n   */\n  notificationOccurred(t) {\n    this.postEvent(\"web_app_trigger_haptic_feedback\", {\n      type: \"notification\",\n      notification_type: t\n    });\n  }\n  /**\n   * A method tells that the user has changed a selection. The Telegram app\n   * may play the appropriate haptics.\n   *\n   * Do not use this feedback when the user makes or confirms a selection;\n   * use it only when the selection changes.\n   */\n  selectionChanged() {\n    this.postEvent(\"web_app_trigger_haptic_feedback\", {\n      type: \"selection_change\"\n    });\n  }\n}\nconst os = l(_ref16 => {\n  let {\n    version: e,\n    postEvent: t\n  } = _ref16;\n  return new qe(e, t);\n});\nclass ke {\n  constructor(t) {\n    this.initData = t;\n  }\n  /**\n   * @see InitDataParsed.authDate\n   */\n  get authDate() {\n    return this.initData.authDate;\n  }\n  /**\n   * @see InitDataParsed.canSendAfter\n   */\n  get canSendAfter() {\n    return this.initData.canSendAfter;\n  }\n  /**\n   * Date after which it is allowed to call\n   * the [answerWebAppQuery](https://core.telegram.org/bots/api#answerwebappquery) method.\n   */\n  get canSendAfterDate() {\n    const {\n      canSendAfter: t\n    } = this;\n    return t ? new Date(this.authDate.getTime() + t * 1e3) : void 0;\n  }\n  /**\n   * @see InitDataParsed.chat\n   */\n  get chat() {\n    return this.initData.chat;\n  }\n  /**\n   * @see InitDataParsed.chatType\n   */\n  get chatType() {\n    return this.initData.chatType;\n  }\n  /**\n   * @see InitDataParsed.chatInstance\n   */\n  get chatInstance() {\n    return this.initData.chatInstance;\n  }\n  /**\n   * @see InitDataParsed.hash\n   */\n  get hash() {\n    return this.initData.hash;\n  }\n  /**\n   * @see InitDataParsed.queryId\n   */\n  get queryId() {\n    return this.initData.queryId;\n  }\n  /**\n   * @see InitDataParsed.receiver\n   */\n  get receiver() {\n    return this.initData.receiver;\n  }\n  /**\n   * @see InitDataParsed.startParam\n   */\n  get startParam() {\n    return this.initData.startParam;\n  }\n  /**\n   * @see InitDataParsed.user\n   */\n  get user() {\n    return this.initData.user;\n  }\n}\nconst as = l(_ref17 => {\n  let {\n    initData: e\n  } = _ref17;\n  return e ? new ke(e) : void 0;\n});\nfunction cs(e) {\n  return xt().parse(e);\n}\nclass Ne extends k {\n  constructor(t, s, n) {\n    super({\n      isOpened: t\n    }, s, {\n      open: \"web_app_open_invoice\"\n    }), this.postEvent = n;\n  }\n  set isOpened(t) {\n    this.set(\"isOpened\", t);\n  }\n  /**\n   * True if invoice is currently opened.\n   */\n  get isOpened() {\n    return this.get(\"isOpened\");\n  }\n  async open(t, s) {\n    if (this.isOpened) throw new Error(\"Invoice is already opened\");\n    let n;\n    if (!s) n = t;else {\n      const {\n        hostname: r,\n        pathname: i\n      } = new URL(t, window.location.href);\n      if (r !== \"t.me\") throw new Error(\"Incorrect hostname: \".concat(r));\n      const o = i.match(/^\\/(\\$|invoice\\/)([A-Za-z0-9\\-_=]+)$/);\n      if (!o) throw new Error('Link pathname has incorrect format. Expected to receive \"/invoice/{slug}\" or \"/${slug}\"');\n      [,, n] = o;\n    }\n    this.isOpened = !0;\n    try {\n      return (await d({\n        method: \"web_app_open_invoice\",\n        event: \"invoice_closed\",\n        params: {\n          slug: n\n        },\n        postEvent: this.postEvent,\n        capture(i) {\n          return n === i.slug;\n        }\n      })).status;\n    } finally {\n      this.isOpened = !1;\n    }\n  }\n}\nconst hs = l(_ref18 => {\n  let {\n    version: e,\n    postEvent: t\n  } = _ref18;\n  return new Ne(!1, e, t);\n});\nclass De extends Y {\n  constructor(_ref19) {\n    let {\n        postEvent: s\n      } = _ref19,\n      n = _objectWithoutProperties(_ref19, _excluded5);\n    super(n);\n    c(this, \"postEvent\");\n    /**\n     * Adds a new event listener.\n     * @param event - event to listen.\n     * @param listener - listener to add.\n     */\n    c(this, \"on\", (s, n) => s === \"click\" ? b(\"main_button_pressed\", n) : this.state.on(s, n));\n    /**\n     * Removes the event listener.\n     * @param event - event to listen.\n     * @param listener - listener to remove.\n     */\n    c(this, \"off\", (s, n) => s === \"click\" ? L(\"main_button_pressed\", n) : this.state.off(s, n));\n    this.postEvent = s;\n  }\n  /**\n   * The MainButton background color.\n   */\n  get bgColor() {\n    return this.get(\"bgColor\");\n  }\n  /**\n   * Sends current local state to the Telegram application.\n   */\n  commit() {\n    this.text !== \"\" && this.postEvent(\"web_app_setup_main_button\", {\n      is_visible: this.isVisible,\n      is_active: this.isEnabled,\n      is_progress_visible: this.isLoaderVisible,\n      text: this.text,\n      color: this.bgColor,\n      text_color: this.textColor\n    });\n  }\n  /**\n   * Disables the MainButton.\n   * @see Does not work on Android: https://github.com/Telegram-Mini-Apps/issues/issues/1\n   */\n  disable() {\n    return this.isEnabled = !1, this;\n  }\n  /**\n   * Enables the MainButton.\n   */\n  enable() {\n    return this.isEnabled = !0, this;\n  }\n  /**\n   * Hides the MainButton.\n   */\n  hide() {\n    return this.isVisible = !1, this;\n  }\n  /**\n   * Hides the MainButton loading indicator.\n   */\n  hideLoader() {\n    return this.isLoaderVisible = !1, this;\n  }\n  set isEnabled(s) {\n    this.setParams({\n      isEnabled: s\n    });\n  }\n  /**\n   * True if the MainButton is enabled.\n   */\n  get isEnabled() {\n    return this.get(\"isEnabled\");\n  }\n  set isLoaderVisible(s) {\n    this.setParams({\n      isLoaderVisible: s\n    });\n  }\n  /**\n   * True if the MainButton loader is visible.\n   */\n  get isLoaderVisible() {\n    return this.get(\"isLoaderVisible\");\n  }\n  set isVisible(s) {\n    this.setParams({\n      isVisible: s\n    });\n  }\n  /**\n   * True if the MainButton is visible.\n   */\n  get isVisible() {\n    return this.get(\"isVisible\");\n  }\n  /**\n   * Shows the MainButton.\n   *\n   * Note that opening the Mini App from the attachment menu hides the main button until the\n   * user interacts with the Mini App interface.\n   */\n  show() {\n    return this.isVisible = !0, this;\n  }\n  /**\n   * Shows a loading indicator on the Main Button.\n   */\n  showLoader() {\n    return this.isLoaderVisible = !0, this;\n  }\n  /**\n   * Sets a new MainButton text. Minimal length for the text is 1 symbol, and maximum is 64 symbols.\n   * @param text - a new text.\n   */\n  setText(s) {\n    return this.setParams({\n      text: s\n    });\n  }\n  /**\n   * Sets a new Main Button text color.\n   * @param textColor - new text color.\n   */\n  setTextColor(s) {\n    return this.setParams({\n      textColor: s\n    });\n  }\n  /**\n   * Updates current Main Button color.\n   * @param bgColor - color to set.\n   */\n  setBgColor(s) {\n    return this.setParams({\n      bgColor: s\n    });\n  }\n  /**\n   * Allows setting multiple Main Button parameters.\n   * @param params - Main Button parameters.\n   */\n  setParams(s) {\n    return this.set(s), this.commit(), this;\n  }\n  /**\n   * The MainButton text.\n   */\n  get text() {\n    return this.get(\"text\");\n  }\n  /**\n   * The MainButton text color.\n   */\n  get textColor() {\n    return this.get(\"textColor\");\n  }\n}\nconst ps = l(\"mainButton\", _ref20 => {\n  let {\n    postEvent: e,\n    themeParams: t,\n    state: s = {\n      isVisible: !1,\n      isEnabled: !1,\n      text: \"\",\n      isLoaderVisible: !1,\n      textColor: t.buttonTextColor || \"#ffffff\",\n      bgColor: t.buttonColor || \"#000000\"\n    }\n  } = _ref20;\n  return new De(_objectSpread(_objectSpread({}, s), {}, {\n    postEvent: e\n  }));\n});\nfunction Me() {\n  return K({\n    contact: g({\n      userId: {\n        type: y(),\n        from: \"user_id\"\n      },\n      phoneNumber: {\n        type: p(),\n        from: \"phone_number\"\n      },\n      firstName: {\n        type: p(),\n        from: \"first_name\"\n      },\n      lastName: {\n        type: p().optional(),\n        from: \"last_name\"\n      }\n    }),\n    authDate: {\n      type: Et(),\n      from: \"auth_date\"\n    },\n    hash: p()\n  }, \"RequestedContact\");\n}\nfunction Dt(e, t) {\n  return s => {\n    const [n, r] = t[s];\n    return v(n, r, e);\n  };\n}\nfunction Ve(e) {\n  return new Promise(t => {\n    setTimeout(t, e);\n  });\n}\nclass Le extends k {\n  constructor(_ref21) {\n    let {\n        postEvent: s,\n        createRequestId: n,\n        version: r,\n        botInline: i\n      } = _ref21,\n      o = _objectWithoutProperties(_ref21, _excluded6);\n    super(o, r, {\n      requestPhoneAccess: \"web_app_request_phone\",\n      requestWriteAccess: \"web_app_request_write_access\",\n      switchInlineQuery: \"web_app_switch_inline_query\",\n      setHeaderColor: \"web_app_set_header_color\",\n      setBackgroundColor: \"web_app_set_background_color\"\n    });\n    c(this, \"botInline\");\n    c(this, \"postEvent\");\n    c(this, \"createRequestId\");\n    c(this, \"requestPhoneAccessPromise\");\n    c(this, \"requestWriteAccessPromise\");\n    /**\n     * Checks if specified method parameter is supported by current component.\n     */\n    c(this, \"supportsParam\");\n    this.createRequestId = n, this.postEvent = s, this.botInline = i;\n    const a = this.supports.bind(this);\n    this.supports = h => a(h) ? h !== \"switchInlineQuery\" || i : !1, this.supportsParam = Dt(r, {\n      \"setHeaderColor.color\": [\"web_app_set_header_color\", \"color\"]\n    });\n  }\n  /**\n   * Attempts to get requested contact.\n   * @param timeout - request timeout.\n   */\n  async getRequestedContact() {\n    let {\n      timeout: s = 1e4\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return Me().parse(await S(\"getRequestedContact\", {}, this.createRequestId(), {\n      postEvent: this.postEvent,\n      timeout: s\n    }));\n  }\n  /**\n   * The Mini App background color.\n   * @example \"#ffaabb\"\n   */\n  get bgColor() {\n    return this.get(\"bgColor\");\n  }\n  /**\n   * Closes the Mini App.\n   * @param returnBack - should the application be wrapped into the bottom bar.\n   */\n  close(s) {\n    this.postEvent(\"web_app_close\", {\n      return_back: s\n    });\n  }\n  /**\n   * The Mini App header color.\n   * @example \"#ffaabb\"\n   * @example \"bg_color\"\n   */\n  get headerColor() {\n    return this.get(\"headerColor\");\n  }\n  /**\n   * True if the Mini App is currently launched in bot inline mode.\n   */\n  get isBotInline() {\n    return this.botInline;\n  }\n  /**\n   * True if the current Mini App background color is recognized as dark.\n   */\n  get isDark() {\n    return yt(this.bgColor);\n  }\n  /**\n   * Informs the Telegram app that the Mini App is ready to be displayed.\n   *\n   * It is recommended to call this method as early as possible, as soon as all essential\n   * interface elements loaded. Once this method called, the loading placeholder is hidden\n   * and the Mini App shown.\n   *\n   * If the method not called, the placeholder will be hidden only when the page fully loaded.\n   */\n  ready() {\n    this.postEvent(\"web_app_ready\");\n  }\n  /**\n   * Requests current user contact information. In contrary to requestPhoneAccess, this method\n   * returns promise with contact information that rejects in case, user denied access, or request\n   * failed.\n   * @param options - additional options.\n   */\n  async requestContact() {\n    let {\n      timeout: s = 5e3\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    try {\n      return await this.getRequestedContact();\n    } catch (_unused6) {}\n    if ((await this.requestPhoneAccess()) !== \"sent\") throw new Error(\"Access denied.\");\n    const r = Date.now() + s;\n    let i = 50;\n    return wt(async () => {\n      for (; Date.now() < r;) {\n        try {\n          return await this.getRequestedContact();\n        } catch (_unused7) {}\n        await Ve(i), i += 50;\n      }\n      throw bt(s);\n    }, s);\n  }\n  /**\n   * Requests current user phone access. Method returns promise, which resolves\n   * status of the request. In case, user accepted the request, Mini App bot will receive\n   * the according notification.\n   *\n   * To obtain the retrieved information instead, utilize the `requestContact` method.\n   * @param options - additional options.\n   * @see requestContact\n   */\n  async requestPhoneAccess() {\n    let s = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return this.requestPhoneAccessPromise || (this.requestPhoneAccessPromise = d(_objectSpread(_objectSpread({}, s), {}, {\n      method: \"web_app_request_phone\",\n      event: \"phone_requested\",\n      postEvent: this.postEvent\n    })).then(_ref22 => {\n      let {\n        status: n\n      } = _ref22;\n      return n;\n    }).finally(() => this.requestPhoneAccessPromise = void 0)), this.requestPhoneAccessPromise;\n  }\n  /**\n   * Requests write message access to current user.\n   * @param options - additional options.\n   */\n  async requestWriteAccess() {\n    let s = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return this.requestWriteAccessPromise || (this.requestWriteAccessPromise = d(_objectSpread(_objectSpread({}, s), {}, {\n      method: \"web_app_request_write_access\",\n      event: \"write_access_requested\",\n      postEvent: this.postEvent\n    })).then(_ref23 => {\n      let {\n        status: n\n      } = _ref23;\n      return n;\n    }).finally(() => this.requestWriteAccessPromise = void 0)), this.requestWriteAccessPromise;\n  }\n  /**\n   * A method used to send data to the bot. When this method called, a service message sent to\n   * the bot containing the data of the length up to 4096 bytes, and the Mini App closed. See the\n   * field `web_app_data` in the class [Message](https://core.telegram.org/bots/api#message).\n   *\n   * This method is only available for Mini Apps launched via a Keyboard button.\n   * @param data - data to send to bot.\n   * @throws {Error} data has incorrect size.\n   */\n  sendData(s) {\n    const {\n      size: n\n    } = new Blob([s]);\n    if (!n || n > 4096) throw new Error(\"Passed data has incorrect size: \".concat(n));\n    this.postEvent(\"web_app_data_send\", {\n      data: s\n    });\n  }\n  /**\n   * Updates current Mini App header color.\n   *\n   * @see No effect on desktop: https://github.com/Telegram-Mini-Apps/tma.js/issues/9\n   * @see Works incorrectly in Android: https://github.com/Telegram-Mini-Apps/tma.js/issues/8\n   * @param color - color key or RGB color.\n   */\n  setHeaderColor(s) {\n    this.postEvent(\"web_app_set_header_color\", Q(s) ? {\n      color: s\n    } : {\n      color_key: s\n    }), this.set(\"headerColor\", s);\n  }\n  /**\n   * Updates current Mini App background color.\n   *\n   * @see No effect on desktop: https://github.com/Telegram-Mini-Apps/tma.js/issues/9\n   * @see Works incorrectly in Android: https://github.com/Telegram-Mini-Apps/tma.js/issues/8\n   * @param color - RGB color.\n   */\n  setBgColor(s) {\n    this.postEvent(\"web_app_set_background_color\", {\n      color: s\n    }), this.set(\"bgColor\", s);\n  }\n  /**\n   * Inserts the bot's username and the specified inline query in the current chat's input field.\n   * Query may be empty, in which case only the bot's username will be inserted. The client prompts\n   * the user to choose a specific chat, then opens that chat and inserts the bot's username and\n   * the specified inline query in the input field.\n   * @param text - text which should be inserted in the input after the current bot name. Max\n   * length is 256 symbols.\n   * @param chatTypes - List of chat types which could be chosen to send the message. Could be\n   * empty list.\n   */\n  switchInlineQuery(s) {\n    let n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    if (!this.supports(\"switchInlineQuery\") && !this.isBotInline) throw new Error(\"Method is unsupported because Mini App should be launched in inline mode.\");\n    this.postEvent(\"web_app_switch_inline_query\", {\n      query: s,\n      chat_types: n\n    });\n  }\n}\nconst us = l(\"miniApp\", _ref24 => {\n  let {\n      themeParams: e,\n      botInline: t = !1,\n      state: s = {\n        bgColor: e.bgColor || \"#ffffff\",\n        headerColor: e.headerBgColor || \"#000000\"\n      }\n    } = _ref24,\n    n = _objectWithoutProperties(_ref24, _excluded7);\n  return new Le(_objectSpread(_objectSpread(_objectSpread({}, n), s), {}, {\n    botInline: t\n  }));\n});\nfunction $e(e) {\n  const t = e.message.trim(),\n    s = (e.title || \"\").trim(),\n    n = e.buttons || [];\n  let r;\n  if (s.length > 64) throw new Error(\"Title has incorrect size: \".concat(s.length));\n  if (!t.length || t.length > 256) throw new Error(\"Message has incorrect size: \".concat(t.length));\n  if (n.length > 3) throw new Error(\"Buttons have incorrect size: \".concat(n.length));\n  return n.length ? r = n.map(i => {\n    const {\n      id: o = \"\"\n    } = i;\n    if (o.length > 64) throw new Error(\"Button ID has incorrect size: \".concat(o));\n    if (!i.type || i.type === \"default\" || i.type === \"destructive\") {\n      const a = i.text.trim();\n      if (!a.length || a.length > 64) {\n        const h = i.type || \"default\";\n        throw new Error(\"Button text with type \\\"\".concat(h, \"\\\" has incorrect size: \").concat(i.text.length));\n      }\n      return _objectSpread(_objectSpread({}, i), {}, {\n        text: a,\n        id: o\n      });\n    }\n    return _objectSpread(_objectSpread({}, i), {}, {\n      id: o\n    });\n  }) : r = [{\n    type: \"close\",\n    id: \"\"\n  }], {\n    title: s,\n    message: t,\n    buttons: r\n  };\n}\nclass Be extends k {\n  constructor(t, s, n) {\n    super({\n      isOpened: t\n    }, s, {\n      open: \"web_app_open_popup\"\n    }), this.postEvent = n;\n  }\n  set isOpened(t) {\n    this.set(\"isOpened\", t);\n  }\n  /**\n   * True if the Popup is opened.\n   */\n  get isOpened() {\n    return this.get(\"isOpened\");\n  }\n  /**\n   * A method that shows a native popup described by the `params` argument.\n   * Promise will be resolved when popup is closed. Resolved value will have\n   * an identifier of pressed button.\n   *\n   * In case, user clicked outside the popup or clicked top right popup close\n   * button, null will be returned.\n   *\n   * @param options - popup parameters.\n   * @throws {Error} Popup is already opened.\n   */\n  async open(t) {\n    if (this.isOpened) throw new Error(\"Popup is already opened.\");\n    this.isOpened = !0;\n    try {\n      const {\n        button_id: s = null\n      } = await d({\n        event: \"popup_closed\",\n        method: \"web_app_open_popup\",\n        postEvent: this.postEvent,\n        params: $e(t)\n      });\n      return s;\n    } finally {\n      this.isOpened = !1;\n    }\n  }\n}\nconst ls = l(_ref25 => {\n  let {\n    postEvent: e,\n    version: t\n  } = _ref25;\n  return new Be(!1, t, e);\n});\nclass We extends k {\n  constructor(t, s, n) {\n    super({\n      isOpened: t\n    }, s, {\n      close: \"web_app_close_scan_qr_popup\",\n      open: \"web_app_open_scan_qr_popup\"\n    }), this.postEvent = n;\n  }\n  /**\n   * Closes the scanner.\n   */\n  close() {\n    this.postEvent(\"web_app_close_scan_qr_popup\"), this.isOpened = !1;\n  }\n  set isOpened(t) {\n    this.set(\"isOpened\", t);\n  }\n  /**\n   * Returns true if the scanner is currently opened.\n   */\n  get isOpened() {\n    return this.get(\"isOpened\");\n  }\n  async open(t) {\n    if (this.isOpened) throw new Error(\"The scanner is already opened\");\n    const {\n      text: s,\n      capture: n\n    } = (typeof t == \"string\" ? {\n      text: t\n    } : t) || {};\n    this.isOpened = !0;\n    try {\n      const i = ((await d({\n        method: \"web_app_open_scan_qr_popup\",\n        event: [\"qr_text_received\", \"scan_qr_popup_closed\"],\n        postEvent: this.postEvent,\n        params: {\n          text: s\n        },\n        capture(o) {\n          return o.event === \"scan_qr_popup_closed\" || !n || n(o.payload);\n        }\n      })) || {}).data || null;\n      return i && this.close(), i;\n    } finally {\n      this.isOpened = !1;\n    }\n  }\n  // TODO: Streaming mode, allowing to scan several QRs until closed.\n}\nconst ds = l(_ref26 => {\n  let {\n    version: e,\n    postEvent: t\n  } = _ref26;\n  return new We(!1, e, t);\n});\nclass Ue extends Z {\n  constructor(s, n, r) {\n    super({\n      isVisible: s\n    }, n, {\n      show: \"web_app_setup_settings_button\",\n      hide: \"web_app_setup_settings_button\"\n    });\n    /**\n     * Adds a new event listener.\n     * @param event - event to listen.\n     * @param listener - listener to add.\n     */\n    c(this, \"on\", (s, n) => s === \"click\" ? b(\"settings_button_pressed\", n) : this.state.on(s, n));\n    /**\n     * Removes the event listener.\n     * @param event - event to listen.\n     * @param listener - listener to remove.\n     */\n    c(this, \"off\", (s, n) => s === \"click\" ? L(\"settings_button_pressed\", n) : this.state.off(s, n));\n    this.postEvent = r;\n  }\n  set isVisible(s) {\n    this.set(\"isVisible\", s), this.postEvent(\"web_app_setup_settings_button\", {\n      is_visible: s\n    });\n  }\n  /**\n   * True if the SettingsButton is visible.\n   */\n  get isVisible() {\n    return this.get(\"isVisible\");\n  }\n  /**\n   * Hides the SettingsButton.\n   */\n  hide() {\n    this.isVisible = !1;\n  }\n  /**\n   * Shows the SettingsButton.\n   */\n  show() {\n    this.isVisible = !0;\n  }\n}\nconst _s = l(\"settingsButton\", _ref27 => {\n  let {\n    version: e,\n    postEvent: t,\n    state: s = {\n      isVisible: !1\n    }\n  } = _ref27;\n  return new Ue(s.isVisible, e, t);\n});\nfunction Mt(e) {\n  return Pt().parse(e);\n}\nclass He extends tt {\n  /**\n   * @since v6.10\n   */\n  get accentTextColor() {\n    return this.get(\"accentTextColor\");\n  }\n  get bgColor() {\n    return this.get(\"bgColor\");\n  }\n  get buttonColor() {\n    return this.get(\"buttonColor\");\n  }\n  get buttonTextColor() {\n    return this.get(\"buttonTextColor\");\n  }\n  get destructiveTextColor() {\n    return this.get(\"destructiveTextColor\");\n  }\n  /**\n   * Returns the copy of the internal state of the current component instance.\n   */\n  getState() {\n    return this.clone();\n  }\n  /**\n   * @since v6.10\n   */\n  get headerBgColor() {\n    return this.get(\"headerBgColor\");\n  }\n  get hintColor() {\n    return this.get(\"hintColor\");\n  }\n  /**\n   * @returns True in case, current color scheme is recognized as dark. This\n   * value is calculated according to theme bg color.\n   */\n  get isDark() {\n    return !this.bgColor || yt(this.bgColor);\n  }\n  get linkColor() {\n    return this.get(\"linkColor\");\n  }\n  get secondaryBgColor() {\n    return this.get(\"secondaryBgColor\");\n  }\n  /**\n   * @since v6.10\n   */\n  get sectionBgColor() {\n    return this.get(\"sectionBgColor\");\n  }\n  /**\n   * @since v6.10\n   */\n  get sectionHeaderTextColor() {\n    return this.get(\"sectionHeaderTextColor\");\n  }\n  /**\n   * @since v7.6\n   */\n  get sectionSeparatorColor() {\n    return this.get(\"sectionHeaderTextColor\");\n  }\n  /**\n   * Starts listening to the external theme changes and applies them.\n   * @returns Function to stop listening.\n   */\n  listen() {\n    return b(\"theme_changed\", t => {\n      this.set(Mt(t.theme_params));\n    });\n  }\n  /**\n   * @since v6.10\n   */\n  get subtitleTextColor() {\n    return this.get(\"subtitleTextColor\");\n  }\n  get textColor() {\n    return this.get(\"textColor\");\n  }\n}\nconst fs = l(\"themeParams\", _ref28 => {\n  let {\n    themeParams: e,\n    state: t = e,\n    addCleanup: s\n  } = _ref28;\n  const n = new He(t);\n  return s(n.listen()), n;\n});\nfunction gs() {\n  let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return d(_objectSpread(_objectSpread({}, e), {}, {\n    method: \"web_app_request_theme\",\n    event: \"theme_changed\"\n  })).then(Mt);\n}\nfunction A(e, t) {\n  return e.startsWith(t) ? e : \"\".concat(t).concat(e);\n}\nfunction I(e) {\n  return new URL(typeof e == \"string\" ? e : \"\".concat(e.pathname || \"\").concat(A(e.search || \"\", \"?\")).concat(A(e.hash || \"\", \"#\")), \"http://a\");\n}\nclass Oe extends et {\n  constructor(s, n, r) {\n    super(s, {\n      readTextFromClipboard: \"web_app_read_text_from_clipboard\"\n    });\n    /**\n     * Checks if specified method parameter is supported by current component.\n     */\n    c(this, \"supportsParam\");\n    this.version = s, this.createRequestId = n, this.postEvent = r, this.supportsParam = Dt(s, {\n      \"openLink.tryInstantView\": [\"web_app_open_link\", \"try_instant_view\"]\n    });\n  }\n  openLink(s, n) {\n    const r = I(s).toString();\n    if (!v(\"web_app_open_link\", this.version)) {\n      window.open(r, \"_blank\");\n      return;\n    }\n    const i = typeof n == \"boolean\" ? {\n      tryInstantView: n\n    } : n || {};\n    this.postEvent(\"web_app_open_link\", {\n      url: r,\n      try_browser: i.tryBrowser,\n      try_instant_view: i.tryInstantView\n    });\n  }\n  /**\n   * Opens a Telegram link inside Telegram app. The Mini App will be closed. It expects passing\n   * link in full format, with hostname \"t.me\".\n   * @param url - URL to be opened.\n   * @throws {Error} URL has not allowed hostname.\n   */\n  openTelegramLink(s) {\n    const {\n      hostname: n,\n      pathname: r,\n      search: i\n    } = new URL(s, \"https://t.me\");\n    if (n !== \"t.me\") throw new Error(\"URL has not allowed hostname: \".concat(n, \". Only \\\"t.me\\\" is allowed\"));\n    if (!v(\"web_app_open_tg_link\", this.version)) {\n      window.location.href = s;\n      return;\n    }\n    this.postEvent(\"web_app_open_tg_link\", {\n      path_full: r + i\n    });\n  }\n  /**\n   * Reads text from clipboard and returns string or null. null is returned\n   * in cases:\n   * - Value in clipboard is not text\n   * - Access to clipboard is not allowed\n   */\n  async readTextFromClipboard() {\n    const s = this.createRequestId(),\n      {\n        data: n = null\n      } = await d({\n        method: \"web_app_read_text_from_clipboard\",\n        event: \"clipboard_text_received\",\n        postEvent: this.postEvent,\n        params: {\n          req_id: s\n        },\n        capture: gt(s)\n      });\n    return n;\n  }\n  /**\n   * Shares specified URL with the passed to the chats, selected by user. After being called,\n   * it closes the mini application.\n   *\n   * This method uses Telegram's Share Links.\n   * @param url - URL to share.\n   * @param text - text to append after the URL.\n   * @see https://core.telegram.org/api/links#share-links\n   * @see https://core.telegram.org/widgets/share#custom-buttons\n   */\n  shareURL(s, n) {\n    this.openTelegramLink(\"https://t.me/share/url?\" + new URLSearchParams({\n      url: s,\n      text: n || \"\"\n    }).toString().replace(/\\+/g, \"%20\"));\n  }\n}\nconst bs = l(_ref29 => {\n  let {\n    version: e,\n    postEvent: t,\n    createRequestId: s\n  } = _ref29;\n  return new Oe(e, s, t);\n});\nasync function Vt() {\n  let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  const _await$d = await d(_objectSpread(_objectSpread({}, e), {}, {\n      method: \"web_app_request_viewport\",\n      event: \"viewport_changed\"\n    })),\n    {\n      is_expanded: t,\n      is_state_stable: s\n    } = _await$d,\n    n = _objectWithoutProperties(_await$d, _excluded8);\n  return _objectSpread(_objectSpread({}, n), {}, {\n    isExpanded: t,\n    isStateStable: s\n  });\n}\nfunction P(e) {\n  return e < 0 ? 0 : e;\n}\nclass Ge extends tt {\n  constructor(_ref30) {\n    let {\n      postEvent: s,\n      stableHeight: n,\n      height: r,\n      width: i,\n      isExpanded: o\n    } = _ref30;\n    super({\n      height: P(r),\n      isExpanded: o,\n      stableHeight: P(n),\n      width: P(i)\n    });\n    c(this, \"postEvent\");\n    this.postEvent = s;\n  }\n  /**\n   * Requests viewport information from the Telegram application and updates current Viewport\n   * instance.\n   * @param options - options to request fresh data.\n   */\n  async sync(s) {\n    const _await$Vt = await Vt(s),\n      {\n        isStateStable: n\n      } = _await$Vt,\n      r = _objectWithoutProperties(_await$Vt, _excluded9);\n    this.set(_objectSpread(_objectSpread({}, r), {}, {\n      stableHeight: n ? r.height : this.get(\"stableHeight\")\n    }));\n  }\n  /**\n   * The current height of the **visible area** of the Mini App.\n   *\n   * The application can display just the top part of the Mini App, with its lower part remaining\n   * outside the screen area. From this position, the user can \"pull\" the Mini App to its\n   * maximum height, while the bot can do the same by calling `expand` method. As the position of\n   * the Mini App changes, the current height value of the visible area will be updated  in real\n   * time.\n   *\n   * Please note that the refresh rate of this value is not sufficient to smoothly follow the\n   * lower border of the window. It should not be used to pin interface elements to the bottom\n   * of the visible area. It's more appropriate to use the value of the `stableHeight`\n   * field for this purpose.\n   *\n   * @see stableHeight\n   */\n  get height() {\n    return this.get(\"height\");\n  }\n  /**\n   * The height of the visible area of the Mini App in its last stable state.\n   *\n   * The application can display just the top part of the Mini App, with its lower part remaining\n   * outside the screen area. From this position, the user can \"pull\" the Mini App to its\n   * maximum height, while the application can do the same by calling `expand` method.\n   *\n   * Unlike the value of `height`, the value of `stableHeight` does not change as the position\n   * of the Mini App changes with user gestures or during animations. The value of `stableHeight`\n   * will be updated after all gestures and animations are completed and\n   * the Mini App reaches its final size.\n   *\n   * @see height\n   */\n  get stableHeight() {\n    return this.get(\"stableHeight\");\n  }\n  /**\n   * Starts listening to viewport changes and applies them.\n   * @returns Function to stop listening.\n   */\n  listen() {\n    return b(\"viewport_changed\", s => {\n      const {\n          height: n,\n          width: r,\n          is_expanded: i,\n          is_state_stable: o\n        } = s,\n        a = P(n);\n      this.set(_objectSpread({\n        height: a,\n        isExpanded: i,\n        width: P(r)\n      }, o ? {\n        stableHeight: a\n      } : {}));\n    });\n  }\n  /**\n   * True if the Mini App is expanded to the maximum available height. Otherwise, if\n   * the Mini App occupies part of the screen and can be expanded to the full height using\n   * `expand` method.\n   * @see expand\n   */\n  get isExpanded() {\n    return this.get(\"isExpanded\");\n  }\n  /**\n   * Current visible area width.\n   */\n  get width() {\n    return this.get(\"width\");\n  }\n  /**\n   * A method that expands the Mini App to the maximum available height. To find out if the Mini\n   * App is expanded to the maximum height, refer to the value of the `isExpanded`.\n   * @see isExpanded\n   */\n  expand() {\n    this.postEvent(\"web_app_expand\"), this.set(\"isExpanded\", !0);\n  }\n  /**\n   * True if the current viewport height is stable and is not going to change in the next moment.\n   */\n  get isStable() {\n    return this.stableHeight === this.height;\n  }\n}\nconst ws = l(\"viewport\", async _ref31 => {\n  let {\n    state: e,\n    platform: t,\n    postEvent: s,\n    addCleanup: n\n  } = _ref31;\n  let r = !1,\n    i = 0,\n    o = 0,\n    a = 0;\n  if (e) r = e.isExpanded, i = e.height, o = e.width, a = e.stableHeight;else if ([\"macos\", \"tdesktop\", \"unigram\", \"webk\", \"weba\", \"web\"].includes(t)) r = !0, i = window.innerHeight, o = window.innerWidth, a = window.innerHeight;else {\n    const u = await Vt({\n      timeout: 1e3,\n      postEvent: s\n    });\n    r = u.isExpanded, i = u.height, o = u.width, a = u.isStateStable ? i : 0;\n  }\n  const h = new Ge({\n    postEvent: s,\n    height: i,\n    width: o,\n    stableHeight: a,\n    isExpanded: r\n  });\n  return n(h.listen()), h;\n});\nfunction m(e, t) {\n  document.documentElement.style.setProperty(e, t);\n}\nfunction ms(e, t, s) {\n  s || (s = a => \"--tg-\".concat(a, \"-color\"));\n  const n = s(\"header\"),\n    r = s(\"bg\"),\n    i = () => {\n      const {\n        headerColor: a\n      } = e;\n      if (Q(a)) m(n, a);else {\n        const {\n          bgColor: h,\n          secondaryBgColor: u\n        } = t;\n        a === \"bg_color\" && h ? m(n, h) : a === \"secondary_bg_color\" && u && m(n, u);\n      }\n      m(r, e.bgColor);\n    },\n    o = [t.on(\"change\", i), e.on(\"change\", i)];\n  return i(), () => o.forEach(a => a());\n}\nfunction ys(e, t) {\n  t || (t = n => \"--tg-theme-\".concat(n.replace(/[A-Z]/g, r => \"-\".concat(r.toLowerCase()))));\n  const s = () => {\n    Object.entries(e.getState()).forEach(_ref32 => {\n      let [n, r] = _ref32;\n      r && m(t(n), r);\n    });\n  };\n  return s(), e.on(\"change\", s);\n}\nfunction vs(e, t) {\n  t || (t = u => \"--tg-viewport-\".concat(u));\n  const [s, n, r] = [\"height\", \"width\", \"stable-height\"].map(u => t(u)),\n    i = () => m(s, \"\".concat(e.height, \"px\")),\n    o = () => m(n, \"\".concat(e.width, \"px\")),\n    a = () => m(r, \"\".concat(e.stableHeight, \"px\")),\n    h = [e.on(\"change:height\", i), e.on(\"change:width\", o), e.on(\"change:stableHeight\", a)];\n  return i(), o(), a(), () => h.forEach(u => u());\n}\nfunction Es() {\n  let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !0;\n  const t = [b(\"reload_iframe\", () => {\n      R(\"iframe_will_reload\"), window.location.reload();\n    })],\n    s = () => t.forEach(n => n());\n  if (e) {\n    const n = document.createElement(\"style\");\n    n.id = \"telegram-custom-styles\", document.head.appendChild(n), t.push(b(\"set_custom_style\", r => {\n      n.innerHTML = r;\n    }), () => document.head.removeChild(n));\n  }\n  return R(\"iframe_ready\", {\n    reload_supported: !0\n  }), s;\n}\nfunction xs() {\n  return typeof window > \"u\";\n}\nasync function Ps() {\n  if (dt(window)) return !0;\n  try {\n    return await d({\n      method: \"web_app_request_theme\",\n      event: \"theme_changed\",\n      timeout: 100\n    }), !0;\n  } catch (_unused8) {\n    return !1;\n  }\n}\nfunction Ss(e) {\n  const t = typeof e == \"string\" ? X(e) : e;\n  qt(t);\n  function s(r) {\n    if (typeof r == \"string\") try {\n      const {\n        eventType: i\n      } = ut(r);\n      i === \"web_app_request_theme\" && j(\"theme_changed\", {\n        theme_params: JSON.parse(It(t.themeParams))\n      }), i === \"web_app_request_viewport\" && j(\"viewport_changed\", {\n        width: window.innerWidth,\n        height: window.innerHeight,\n        is_state_stable: !0,\n        is_expanded: !0\n      });\n    } catch (_unused9) {}\n  }\n  if (_t()) {\n    const r = window.parent.postMessage.bind(window.parent);\n    window.parent.postMessage = i => {\n      s(i), r(i);\n    };\n    return;\n  }\n  if (lt(window)) {\n    const r = window.external.notify.bind(window.external);\n    window.external.notify = i => {\n      s(i), r(i);\n    };\n    return;\n  }\n  const n = window.TelegramWebviewProxy;\n  window.TelegramWebviewProxy = _objectSpread(_objectSpread({}, n || {}), {}, {\n    postEvent() {\n      s(JSON.stringify({\n        eventType: arguments.length <= 0 ? undefined : arguments[0],\n        eventData: arguments.length <= 1 ? undefined : arguments[1]\n      })), n && n.postEvent(...arguments);\n    }\n  });\n}\nfunction je(e) {\n  return e instanceof D;\n}\nfunction Cs(e, t) {\n  return je(e) && e.type === t;\n}\nfunction $(e, t) {\n  let s, n, r;\n  return typeof e == \"string\" ? s = e : (s = e.pathname === void 0 ? t : e.pathname, n = e.params, r = e.id), Object.freeze({\n    id: r || (Math.random() * 2 ** 14 | 0).toString(16),\n    pathname: s,\n    params: n\n  });\n}\nclass ze {\n  constructor(t, s) {\n    let n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : R;\n    /**\n     * Navigation history.\n     */\n    c(this, \"history\");\n    c(this, \"ee\", new T());\n    /**\n     * True, if current navigator is currently attached.\n     */\n    c(this, \"attached\", !1);\n    /**\n     * Goes to the previous history item.\n     */\n    c(this, \"back\", () => this.go(-1));\n    /**\n     * Adds new event listener.\n     */\n    c(this, \"on\", this.ee.on.bind(this.ee));\n    /**\n     * Removes event listener.\n     */\n    c(this, \"off\", this.ee.off.bind(this.ee));\n    if (this._index = s, this.postEvent = n, t.length === 0) throw f(Zt, \"History should not be empty.\");\n    if (s < 0 || s >= t.length) throw f(Kt, \"Index should not be zero and higher or equal than history size.\");\n    this.history = t.map(r => $(r, \"\"));\n  }\n  /**\n   * Allows this navigator to control the `BackButton` visibility state. It also tracks the\n   * `BackButton` clicks and calls the `back` method.\n   */\n  attach() {\n    this.attached || (this.attached = !0, this.sync(), b(\"back_button_pressed\", this.back));\n  }\n  /**\n   * Currently active history item.\n   */\n  get current() {\n    return this.history[this.index];\n  }\n  /**\n   * Prevents current navigator from controlling the BackButton visibility state.\n   */\n  detach() {\n    this.attached = !1, L(\"back_button_pressed\", this.back);\n  }\n  /**\n   * Goes to the next history item.\n   */\n  forward() {\n    this.go(1);\n  }\n  /**\n   * Changes currently active history item index by the specified delta. This method doesn't\n   * change index in case, the updated index points to the non-existing history item. This behavior\n   * is preserved until the `fit` argument is specified.\n   * @param delta - index delta.\n   * @param fit - cuts the delta argument to fit the bounds `[0, history.length - 1]`.\n   */\n  go(t, s) {\n    const n = this.index + t,\n      r = Math.min(Math.max(0, n), this.history.length - 1);\n    (n === r || s) && this.replaceAndMove(r, this.history[r]);\n  }\n  /**\n   * Goes to the specified index. Method does nothing in case, passed index is out of bounds.\n   *\n   * If \"fit\" option was specified and index is out of bounds, it will be cut to the nearest\n   * bound.\n   * @param index - target index.\n   * @param fit - cuts the index argument to fit the bounds `[0, history.length - 1]`.\n   */\n  goTo(t, s) {\n    this.go(t - this.index, s);\n  }\n  /**\n   * True if navigator has items before the current item.\n   */\n  get hasPrev() {\n    return this.index > 0;\n  }\n  /**\n   * True if navigator has items after the current item.\n   */\n  get hasNext() {\n    return this.index !== this.history.length - 1;\n  }\n  /**\n   * Currently active history item index.\n   */\n  get index() {\n    return this._index;\n  }\n  /**\n   * Adds a new history item removing all after the current one.\n   * @param item - item to add.\n   */\n  push(t) {\n    this.hasNext && this.history.splice(this.index + 1), this.replaceAndMove(this.index + 1, $(t, this.current.pathname));\n  }\n  /**\n   * Replaces the current history item.\n   * @param item - item to replace the current item with.\n   */\n  replace(t) {\n    this.replaceAndMove(this.index, $(t, this.current.pathname));\n  }\n  /**\n   * Sets history item by the specified index.\n   * @param index - history item index to replace.\n   * @param historyItem - history item to set.\n   */\n  replaceAndMove(t, s) {\n    const n = t - this.index;\n    if (!n && this.current === s) return;\n    const r = this.current;\n    if (this.index !== t) {\n      const i = this._index;\n      this._index = t, this.attached && i > 0 != t > 0 && this.sync();\n    }\n    this.history[t] = s, this.ee.emit(\"change\", {\n      navigator: this,\n      from: r,\n      to: this.current,\n      delta: n\n    });\n  }\n  /**\n   * Actualizes the `BackButton` visibility state.\n   */\n  sync() {\n    this.postEvent(\"web_app_setup_back_button\", {\n      is_visible: !!this.index\n    });\n  }\n}\nfunction B(_ref33) {\n  let {\n      params: e\n    } = _ref33,\n    t = _objectWithoutProperties(_ref33, _excluded0);\n  return _objectSpread(_objectSpread({}, e || {\n    hash: \"\",\n    search: \"\"\n  }), t);\n}\nfunction N(e) {\n  const t = typeof e == \"string\" ? e.startsWith(\"/\") : !!(e.pathname && e.pathname.startsWith(\"/\")),\n    s = I(e);\n  return \"\".concat(t ? s.pathname : s.pathname.slice(1)).concat(s.search).concat(s.hash);\n}\nfunction W(e, t, s) {\n  let n, r;\n  typeof e == \"string\" ? n = e : (n = N(e), s = e.state, r = e.id);\n  const {\n    pathname: i,\n    search: o,\n    hash: a\n  } = new URL(n, \"http://a\".concat(A(t, \"/\")));\n  return {\n    id: r,\n    pathname: i,\n    params: {\n      hash: a,\n      search: o,\n      state: s\n    }\n  };\n}\nasync function C(e) {\n  return e === 0 ? !0 : Promise.race([new Promise(t => {\n    const s = G(\"popstate\", () => {\n      s(), t(!0);\n    });\n    window.history.go(e);\n  }),\n  // Usually, it takes about 1ms to emit this event, but we use some buffer.\n  new Promise(t => {\n    setTimeout(t, 50, !1);\n  })]);\n}\nasync function Fe() {\n  if (window.history.length <= 1 || (window.history.pushState(null, \"\"), await C(1 - window.history.length))) return;\n  let t = await C(-1);\n  for (; t;) t = await C(-1);\n}\nfunction Lt(e) {\n  return I(e).pathname;\n}\nconst it = 0,\n  U = 1,\n  H = 2;\nclass $t {\n  constructor(t, s) {\n    let {\n      postEvent: n,\n      hashMode: r = \"classic\",\n      base: i\n    } = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    c(this, \"navigator\");\n    c(this, \"ee\", new T());\n    c(this, \"hashMode\");\n    c(this, \"base\");\n    /**\n     * Shows whether the navigator is currently attached to the browser history.\n     */\n    c(this, \"attached\", !1);\n    /**\n     * Handles the window \"popstate\" event.\n     * @param state - event state.\n     */\n    c(this, \"onPopState\", _ref34 => {\n      let {\n        state: t\n      } = _ref34;\n      if (t === null) return this.push(this.parsePath(window.location.href));\n      t === it ? window.history.forward() : t === U && this.back(), t === H && this.forward();\n    });\n    /**\n     * Underlying navigator change event listener.\n     */\n    c(this, \"onNavigatorChange\", async _ref35 => {\n      let {\n        to: t,\n        from: s,\n        delta: n\n      } = _ref35;\n      this.attached && (await this.syncHistory()), this.ee.emit(\"change\", {\n        delta: n,\n        from: B(s),\n        to: B(t),\n        navigator: this\n      });\n    });\n    /**\n     * Adds new event listener.\n     */\n    c(this, \"on\", this.ee.on.bind(this.ee));\n    /**\n     * Removes event listener.\n     */\n    c(this, \"off\", this.ee.off.bind(this.ee));\n    this.navigator = new ze(t.map(o => W(o, \"/\")), s, n), this.navigator.on(\"change\", o => {\n      this.onNavigatorChange(o);\n    }), this.hashMode = r, this.base = Lt(i || \"\");\n  }\n  /**\n   * Attaches current navigator to the browser history allowing navigator to manipulate it.\n   */\n  async attach() {\n    this.attached || (this.attached = !0, this.navigator.attach(), window.addEventListener(\"popstate\", this.onPopState), await this.syncHistory());\n  }\n  /**\n   * Goes back in history by 1.\n   */\n  back() {\n    this.navigator.back();\n  }\n  /**\n   * Detaches current navigator from the browser history.\n   */\n  detach() {\n    this.attached = !1, this.navigator.detach(), window.removeEventListener(\"popstate\", this.onPopState);\n  }\n  /**\n   * Goes forward in history.\n   */\n  forward() {\n    return this.navigator.forward();\n  }\n  /**\n   * Current history cursor.\n   */\n  get index() {\n    return this.navigator.index;\n  }\n  /**\n   * Current history item identifier.\n   */\n  get id() {\n    return this.navigator.current.id;\n  }\n  /**\n   * Changes currently active history item index by the specified delta. This method doesn't\n   * change index in case, the updated index points to the non-existing history item. This behavior\n   * is preserved until the `fit` argument is specified.\n   * @param delta - index delta.\n   * @param fit - cuts the delta argument to fit the bounds `[0, history.length - 1]`.\n   */\n  go(t, s) {\n    return this.navigator.go(t, s);\n  }\n  /**\n   * Goes to the specified index. Method does nothing in case, passed index is out of bounds.\n   *\n   * If \"fit\" option was specified and index is out of bounds, it will be cut to the nearest\n   * bound.\n   * @param index - target index.\n   * @param fit - cuts the index argument to fit the bounds `[0, history.length - 1]`.\n   */\n  goTo(t, s) {\n    this.navigator.goTo(t, s);\n  }\n  /**\n   * Current history item hash.\n   * @see URL.hash\n   * @example\n   * \"\", \"#my-hash\"\n   */\n  get hash() {\n    return (this.navigator.current.params || {}).hash || \"\";\n  }\n  /**\n   * True if navigator has items before the current item.\n   */\n  get hasPrev() {\n    return this.navigator.hasPrev;\n  }\n  /**\n   * True if navigator has items after the current item.\n   */\n  get hasNext() {\n    return this.navigator.hasNext;\n  }\n  /**\n   * Navigation history.\n   */\n  get history() {\n    return this.navigator.history.map(B);\n  }\n  /**\n   * Path, including pathname, search and hash.\n   * @example Pathname only.\n   * \"/pathname\"\n   * @example Pathname + search.\n   * \"/pathname?search\"\n   * @example Pathname + hash.\n   * \"/pathname#hash\"\n   * @example Pathname + search + hash.\n   * \"/pathname?search#hash\"\n   */\n  get path() {\n    return N(this);\n  }\n  /**\n   * Current pathname. Always starts with the slash.\n   * @see URL.pathname\n   * @example\n   * \"/\", \"/abc\"\n   */\n  get pathname() {\n    return this.navigator.current.pathname;\n  }\n  /**\n   * Depending on the current navigation type, parses incoming path and returns it presented as\n   * an object. In other words, this method parses the passed path and returns object, describing\n   * how the navigator \"sees\" it.\n   *\n   * @example Hash mode is omitted.\n   * parsePath('/abc?a=1#hash');\n   * // { pathname: '/abc', search: '?a=1', hash: '#hash' }\n   * parsePath('http://example.com/abc?a=1#hash');\n   * // { pathname: '/abc', search: '?a=1', hash: '#hash' }\n   *\n   * @example Hash mode is enabled.\n   * parsePath('/abc?a=1#tma?is=cool#yeah');\n   * // { pathname: '/tma', search: '?is=cool', hash: '#yeah' }\n   * parsePath('http://example.com/abc?a=1#tma?is=cool#yeah');\n   * // { pathname: '/tma', search: '?is=cool', hash: '#yeah' }\n   */\n  parsePath(t) {\n    let s = I(t);\n    return this.hashMode && (s = I(s.hash.slice(1))), {\n      pathname: s.pathname,\n      search: s.search,\n      hash: s.hash\n    };\n  }\n  push(t, s) {\n    const n = W(t, this.path),\n      {\n        state: r = s\n      } = n.params;\n    this.navigator.push(_objectSpread(_objectSpread({}, n), {}, {\n      params: _objectSpread(_objectSpread({}, n.params), {}, {\n        state: r\n      })\n    }));\n  }\n  replace(t, s) {\n    const n = W(t, this.path),\n      {\n        state: r = s\n      } = n.params;\n    this.navigator.replace(_objectSpread(_objectSpread({}, n), {}, {\n      params: _objectSpread(_objectSpread({}, n.params), {}, {\n        state: r\n      })\n    }));\n  }\n  /**\n   * Combines the navigator `base` property with the passed path data applying the navigator\n   * navigation mode.\n   * @param value - path presented as string or URLLike.\n   */\n  renderPath(t) {\n    const s = (this.base.length === 1 ? \"\" : this.base) + A(N(t), \"/\");\n    return this.hashMode ? A(s.slice(1), this.hashMode === \"classic\" ? \"#\" : \"#/\") : s;\n  }\n  /**\n   * Synchronizes current navigator state with browser history.\n   */\n  async syncHistory() {\n    window.removeEventListener(\"popstate\", this.onPopState);\n    const {\n        state: t\n      } = this,\n      s = this.renderPath(this);\n    await Fe(), this.hasPrev && this.hasNext ? (window.history.replaceState(U, \"\"), window.history.pushState(t, \"\", s), window.history.pushState(H, \"\"), await C(-1)) : this.hasPrev ? (window.history.replaceState(U, \"\"), window.history.pushState(t, \"\", s)) : this.hasNext ? (window.history.replaceState(t, s), window.history.pushState(H, \"\"), await C(-1)) : (window.history.replaceState(it, \"\"), window.history.pushState(t, \"\", s)), window.addEventListener(\"popstate\", this.onPopState);\n  }\n  /**\n   * Current query parameters.\n   * @see URL.search\n   * @example\n   * \"\", \"?\", \"?a=1\"\n   */\n  get search() {\n    return (this.navigator.current.params || {}).search || \"\";\n  }\n  /**\n   * Current history item state.\n   */\n  get state() {\n    return (this.navigator.current.params || {}).state;\n  }\n}\nfunction Je(e) {\n  e || (e = {});\n  const {\n    href: t,\n    hash: s\n  } = window.location;\n  let n = N(e.hashMode === null ? t : s.includes(\"?\") ? s.slice(1) : \"?\".concat(s.slice(1)));\n  const r = e.base ? Lt(e.base) : void 0;\n  if (r) {\n    if (!n.startsWith(r)) throw f(Xt, \"Path \\\"\".concat(n, \"\\\" expected to be starting with \\\"\").concat(r, \"\\\"\"));\n    n = n.slice(r.length);\n  }\n  return new $t([n], 0, e);\n}\nfunction Ts(e) {\n  const t = e.match(/#(.+)/);\n  return t ? t[1] : null;\n}\nfunction Qe(e, t) {\n  if (kt()) {\n    const s = sessionStorage.getItem(e);\n    if (s) try {\n      const {\n        index: n,\n        history: r\n      } = JSON.parse(s);\n      return new $t(r, n, t);\n    } catch (n) {\n      console.error(\"Unable to restore hash navigator state.\", n);\n    }\n  }\n  return Je(t);\n}\nfunction Rs(e, t) {\n  const s = Qe(e, t),\n    n = () => sessionStorage.setItem(e, JSON.stringify({\n      index: s.index,\n      history: s.history\n    }));\n  return s.on(\"change\", n), n(), s;\n}\nexport { le as BackButton, ze as BasicNavigator, Pe as BiometryManager, $t as BrowserNavigator, Ce as ClosingBehavior, Ie as CloudStorage, Xt as ERR_INVALID_PATH_BASE, Jt as ERR_INVOKE_CUSTOM_METHOD_RESPONSE, zt as ERR_METHOD_PARAMETER_UNSUPPORTED, jt as ERR_METHOD_UNSUPPORTED, Zt as ERR_NAVIGATION_HISTORY_EMPTY, Kt as ERR_NAVIGATION_INDEX_INVALID, Ke as ERR_NAVIGATION_ITEM_INVALID, ct as ERR_PARSE, Xe as ERR_SSR_INIT, Qt as ERR_TIMED_OUT, Yt as ERR_UNEXPECTED_TYPE, Ft as ERR_UNKNOWN_ENV, T as EventEmitter, qe as HapticFeedback, ke as InitData, Ne as Invoice, De as MainButton, Le as MiniApp, Be as Popup, We as QRScanner, D as SDKError, Ue as SettingsButton, He as ThemeParams, Oe as Utils, Ge as Viewport, Ae as array, ms as bindMiniAppCSSVars, ys as bindThemeParamsCSSVars, vs as bindViewportCSSVars, w as boolean, gt as captureSameReq, z as classNames, oe as compareVersions, Je as createBrowserNavigatorFromLocation, he as createPostEvent, I as createSafeURL, Et as date, Ts as getHash, Lt as getPathname, ss as initBackButton, ns as initBiometryManager, rs as initClosingBehavior, is as initCloudStorage, os as initHapticFeedback, as as initInitData, hs as initInvoice, ps as initMainButton, us as initMiniApp, Rs as initNavigator, ls as initPopup, ds as initQRScanner, _s as initSettingsButton, fs as initThemeParams, bs as initUtils, ws as initViewport, Es as initWeb, S as invokeCustomMethod, yt as isColorDark, _t as isIframe, kt as isPageReload, Q as isRGB, pe as isRGBShort, je as isSDKError, Cs as isSDKErrorOfType, xs as isSSR, Ps as isTMA, g as json, es as mergeClassNames, Ss as mockTelegramEnv, y as number, L as off, b as on, cs as parseInitData, X as parseLaunchParams, Mt as parseThemeParams, R as postEvent, d as request, Se as requestBiometryInfo, gs as requestThemeParams, Vt as requestViewport, ve as retrieveLaunchParams, _e as rgb, K as searchParams, ye as serializeLaunchParams, It as serializeThemeParams, m as setCSSVar, Ze as setDebug, ts as setTargetOrigin, p as string, Ht as subscribe, v as supports, ce as targetOrigin, mt as toRGB, at as unsubscribe, N as urlToPath, wt as withTimeout };","map":{"version":3,"names":["ot","e","t","s","n","reset","at","V","count","unsubscribe","ie","Ht","subscribe","Ot","constructor","arguments","length","undefined","scope","options","print","Date","r","Intl","DateTimeFormat","hour","minute","second","fractionalSecondDigits","timeZone","format","textColor","i","bgColor","o","a","_len","Array","_key","console","concat","error","_len2","_key2","log","_len3","_key3","F","O","st","_ref","name","payload","Ze","Gt","T","c","Map","clear","listeners","subscribeListeners","listenersCount","emit","_len4","_key4","forEach","event","args","get","_ref2","off","on","set","push","splice","G","window","addEventListener","removeEventListener","J","_len5","_key5","flat","D","Error","cause","type","Object","setPrototypeOf","prototype","f","jt","zt","Ft","Jt","Qt","Yt","ct","Zt","Kt","Ke","Xe","Xt","E","M","parser","isOptional","parse","optional","x","w","String","ht","bind","from","pt","JSON","isArray","g","y","Number","isNaN","p","toString","ut","eventType","eventData","te","j","dispatchEvent","MessageEvent","data","stringify","source","parent","ee","se","clipboard_text_received","req_id","custom_method_invoked","result","popup_closed","button_id","viewport_changed","height","width","innerWidth","is_state_stable","is_expanded","ne","innerHeight","_unused","h","re","_ref3","L","b","q","oe","split","Math","max","parseInt","_","v","includes","lt","external","notify","dt","TelegramWebviewProxy","postEvent","_t","self","top","_unused2","ae","ft","ts","ce","R","postMessage","targetOrigin","he","gt","_ref4","bt","wt","Promise","race","setTimeout","d","capture","timeout","map","method","params","S","_objectSpread","z","_len6","_key6","entries","filter","Boolean","join","es","_len7","_key7","reduce","_ref5","Q","test","pe","mt","replace","toLowerCase","repeat","match","slice","yt","sqrt","ue","state","clone","_ref6","Y","vt","Z","supports","le","isVisible","show","hide","is_visible","Et","K","URLSearchParams","de","id","title","photoUrl","username","nt","addedToAttachmentMenu","allowsWriteToPm","firstName","isBot","isPremium","languageCode","lastName","xt","authDate","canSendAfter","chat","chatInstance","chatType","hash","queryId","receiver","startParam","user","_e","fe","toUpperCase","ge","Pt","_ref7","X","botInline","initData","initDataRaw","platform","showSettings","themeParams","version","St","be","location","href","Ct","performance","getEntriesByType","we","Tt","Rt","sessionStorage","setItem","At","getItem","_unused3","me","It","fromEntries","_ref8","ye","qt","ve","_unused4","kt","Ee","xe","l","createRequestId","addCleanup","u","Bt","then","ss","_ref9","k","Nt","available","device_id","token_saved","access_requested","access_granted","deviceId","tokenSaved","accessRequested","accessGranted","Pe","_ref0","_objectWithoutProperties","_excluded","auth","openSettings","requestAccess","updateToken","authenticate","_ref1","reason","_excluded2","authPromise","trim","_ref10","token","finally","_ref11","_excluded3","accessPromise","biometryType","_ref12","_excluded4","status","Se","ns","_ref13","tt","Ce","isConfirmationNeeded","need_confirmation","disableConfirmation","enableConfirmation","rs","_ref14","et","Te","_unused5","Re","itemParser","of","Ae","rt","Ie","delete","getKeys","keys","key","value","is","_ref15","qe","impactOccurred","notificationOccurred","selectionChanged","impact_style","notification_type","os","_ref16","ke","canSendAfterDate","getTime","as","_ref17","cs","Ne","isOpened","open","hostname","pathname","URL","slug","hs","_ref18","De","_ref19","_excluded5","commit","text","is_active","isEnabled","is_progress_visible","isLoaderVisible","color","text_color","disable","enable","hideLoader","setParams","showLoader","setText","setTextColor","setBgColor","ps","_ref20","buttonTextColor","buttonColor","Me","contact","userId","phoneNumber","Dt","Ve","Le","_ref21","_excluded6","requestPhoneAccess","requestWriteAccess","switchInlineQuery","setHeaderColor","setBackgroundColor","supportsParam","getRequestedContact","close","return_back","headerColor","isBotInline","isDark","ready","requestContact","_unused6","now","_unused7","requestPhoneAccessPromise","_ref22","requestWriteAccessPromise","_ref23","sendData","size","Blob","color_key","query","chat_types","us","_ref24","headerBgColor","_excluded7","$e","message","buttons","Be","ls","_ref25","We","ds","_ref26","Ue","_s","_ref27","Mt","He","accentTextColor","destructiveTextColor","getState","hintColor","linkColor","secondaryBgColor","sectionBgColor","sectionHeaderTextColor","sectionSeparatorColor","listen","theme_params","subtitleTextColor","fs","_ref28","gs","A","startsWith","I","search","Oe","readTextFromClipboard","openLink","tryInstantView","url","try_browser","tryBrowser","try_instant_view","openTelegramLink","path_full","shareURL","bs","_ref29","Vt","_await$d","_excluded8","isExpanded","isStateStable","P","Ge","_ref30","stableHeight","sync","_await$Vt","_excluded9","expand","isStable","ws","_ref31","m","document","documentElement","style","setProperty","ms","actualize","ys","_ref32","vs","setHeight","setWidth","setStableHeight","Es","reload","cleanup","createElement","head","appendChild","innerHTML","removeChild","reload_supported","xs","Ps","_unused8","Ss","_unused9","je","Cs","$","freeze","random","ze","go","_index","history","attach","attached","back","current","index","detach","forward","min","replaceAndMove","goTo","hasPrev","hasNext","navigator","to","delta","B","_ref33","_excluded0","N","W","C","Fe","pushState","Lt","it","U","H","$t","hashMode","base","_ref34","parsePath","_ref35","syncHistory","onNavigatorChange","onPopState","path","renderPath","replaceState","Je","Ts","Qe","Rs","saveState"],"sources":["/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/misc/createSingleton.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/events/listening/unsubscribe.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/events/listening/subscribe.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/logger/Logger.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/debug/debug.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/events/event-emitter/EventEmitter.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/events/onWindow.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/misc/createCleanup.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/errors/SDKError.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/errors/createError.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/errors/errors.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/parsing/createTypeError.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/parsing/ValueParser/ValueParser.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/parsing/createValueParserGenerator.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/parsing/parsers/boolean.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/parsing/parseBySchema.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/parsing/toRecord.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/parsing/parsers/json.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/parsing/parsers/number.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/parsing/parsers/string.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/parseMessage.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/events/event-handlers/cleanupEventHandlers.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/events/event-handlers/emitMiniAppsEvent.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/events/event-handlers/defineEventHandlers.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/events/event-emitter/createMiniAppsEventEmitter.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/events/event-emitter/singleton.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/events/listening/off.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/events/listening/on.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/misc/isRecord.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/version/compareVersions.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/supports/supports.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/env/hasExternalNotify.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/env/hasWebviewProxy.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/env/isIframe.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/target-origin.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/methods/postEvent.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/methods/createPostEvent.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/captureSameReq.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/timeout/createTimeoutError.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/timeout/withTimeout.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/request.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/bridge/invokeCustomMethod.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/classnames/classNames.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/classnames/mergeClassNames.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/colors/isRGB.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/colors/isRGBShort.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/colors/toRGB.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/colors/isColorDark.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/classes/State/State.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/classes/WithStateUtils.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/supports/createSupportsFn.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/classes/WithSupportsAndStateUtils.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/BackButton/BackButton.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/parsing/parsers/date.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/parsing/parsers/searchParams.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/InitData/parsers/chat.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/InitData/parsers/user.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/InitData/parsers/initData.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/parsing/parsers/rgb.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/ThemeParams/keys.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/ThemeParams/parsing/themeParams.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/launch-params/parseLaunchParams.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/launch-params/retrieveFromUrl.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/launch-params/retrieveFromLocation.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/getFirstNavigationEntry.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/launch-params/retrieveFromPerformance.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/storage/storage.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/launch-params/retrieveFromStorage.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/ThemeParams/parsing/serializeThemeParams.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/launch-params/serializeLaunchParams.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/launch-params/saveToStorage.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/launch-params/retrieveLaunchParams.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/isPageReload.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/request-id/createRequestIdGenerator.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/misc/createComponentInitFn/createComponentInitFn.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/BackButton/initBackButton.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/classes/WithSupportsAndTrackableState.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/BiometryManager/formatEvent.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/BiometryManager/BiometryManager.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/BiometryManager/requestBiometryInfo.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/BiometryManager/initBiometryManager.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/classes/WithTrackableState.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/ClosingBehavior/ClosingBehavior.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/ClosingBehavior/initClosingBehavior.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/classes/WithSupports.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/parsing/ArrayParser/ArrayParser.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/parsing/parsers/array.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/CloudStorage/CloudStorage.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/CloudStorage/initCloudStorage.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/HapticFeedback/HapticFeedback.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/HapticFeedback/initHapticFeedback.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/InitData/InitData.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/InitData/initInitData.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/InitData/parseInitData.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/Invoice/Invoice.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/Invoice/initInvoice.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/MainButton/MainButton.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/MainButton/initMainButton.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/MiniApp/parsing/contact.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/supports/createSupportsParamFn.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/timeout/sleep.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/MiniApp/MiniApp.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/MiniApp/initMiniApp.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/Popup/preparePopupParams.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/Popup/Popup.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/Popup/initPopup.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/QRScanner/QRScanner.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/QRScanner/initQRScanner.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/SettingsButton/SettingsButton.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/SettingsButton/initSettingsButton.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/ThemeParams/parsing/parseThemeParams.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/ThemeParams/ThemeParams.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/ThemeParams/initThemeParams.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/ThemeParams/requestThemeParams.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/ensurePrefix.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/createSafeURL.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/Utils/Utils.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/Utils/initUtils.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/Viewport/requestViewport.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/Viewport/Viewport.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/components/Viewport/initViewport.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/css-vars/setCSSVar.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/css-vars/bindMiniAppCSSVars.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/css-vars/bindThemeParamsCSSVars.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/css-vars/bindViewportCSSVars.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/env/initWeb.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/env/isSSR.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/env/isTMA.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/env/mockTelegramEnv.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/errors/isSDKError.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/errors/isSDKErrorOfType.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/BasicNavigator/prepareItem.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/BasicNavigator/BasicNavigator.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/BrowserNavigator/basicItemToBrowser.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/urlToPath.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/BrowserNavigator/prepareItem.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/go.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/drop.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/getPathname.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/BrowserNavigator/BrowserNavigator.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/BrowserNavigator/createBrowserNavigatorFromLocation.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/getHash.ts","/Users/alexandr_petrovskyi/Desktop/vinyl_bot/mini_app/node_modules/@tma.js/sdk/src/navigation/initNavigator.ts"],"sourcesContent":["/**\n * Creates resettable singleton. We mostly need it for test purposes.\n * @param create - function which creates singleton entity.\n * @param onReset - function which will be called in case, singleton was reset.\n */\nexport function createSingleton<T>(\n  create: (reset: () => void) => T,\n  onReset?: (entity: T) => void,\n): [\n  /**\n   * Returns singleton entity.\n   */\n  get: () => T,\n  /**\n   * Resets last stored entity.\n   */\n  reset: () => void,\n] {\n  let cached: T | undefined;\n  const reset = () => {\n    cached !== undefined && onReset && onReset(cached);\n    cached = undefined;\n  };\n\n  return [() => (cached === undefined ? cached = create(reset) : cached), reset];\n}\n","import { miniAppsEventEmitter, resetMiniAppsEventEmitter } from '../event-emitter/singleton.js';\nimport type { MiniAppsSubscribeListener } from '../types.js';\n\n/**\n * Removes global event listener.\n * @param listener - event listener.\n */\nexport function unsubscribe(listener: MiniAppsSubscribeListener): void {\n  const ee = miniAppsEventEmitter();\n  const { count } = ee;\n  ee.unsubscribe(listener);\n\n  // If event emitter now has no listeners, we can make a cleanup.\n  if (count && !ee.count) {\n    resetMiniAppsEventEmitter();\n  }\n}\n","import type { RemoveEventListenerFn } from '@/events/types.js';\n\nimport { miniAppsEventEmitter } from '../event-emitter/singleton.js';\nimport { unsubscribe } from '../listening/unsubscribe.js';\nimport type { MiniAppsSubscribeListener } from '../types.js';\n\n/**\n * Subscribes to all events sent from the native Telegram application.\n * @param listener - event listener to bind.\n * @returns Function to remove bound event listener.\n */\nexport function subscribe(listener: MiniAppsSubscribeListener): RemoveEventListenerFn {\n  miniAppsEventEmitter().subscribe(listener);\n  return () => unsubscribe(listener);\n}\n","/**\n * Message log level.\n */\nexport type LogLevel = 'log' | 'error';\n\nexport interface LoggerOptions {\n  bgColor?: string;\n  textColor?: string;\n}\n\nexport class Logger implements Pick<Console, 'log' | 'error'> {\n  constructor(\n    private readonly scope: string,\n    private readonly options: LoggerOptions = {},\n  ) {\n  }\n\n  /**\n   * Prints message into a console in case, logger is currently enabled.\n   * @param level - log level.\n   * @param args - arguments.\n   */\n  private print(level: LogLevel, ...args: any[]): void {\n    const now = new Date();\n    const date = Intl\n      .DateTimeFormat('en-GB', {\n        hour: '2-digit',\n        minute: '2-digit',\n        second: '2-digit',\n        fractionalSecondDigits: 3,\n        timeZone: 'UTC',\n      })\n      .format(now);\n\n    const { textColor, bgColor } = this.options;\n    const commonCss = 'font-weight: bold;padding: 0 5px;border-radius:5px';\n\n    console[level](\n      `%c${date}%c / %c${this.scope}`,\n      `${commonCss};background-color: lightblue;color:black`,\n      '',\n      `${commonCss};${textColor ? `color:${textColor};` : ''}${bgColor ? `background-color:${bgColor}` : ''}`,\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n      ...args,\n    );\n  }\n\n  /**\n   * Prints error message into a console.\n   * @param args\n   */\n  error(...args: any[]): void {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n    this.print('error', ...args);\n  }\n\n  /**\n   * Prints log message into a console.\n   * @param args\n   */\n  log(...args: any[]): void {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n    this.print('log', ...args);\n  }\n}\n","import { subscribe } from '@/bridge/events/listening/subscribe.js';\nimport { unsubscribe } from '@/bridge/events/listening/unsubscribe.js';\nimport { Logger } from '@/logger/Logger.js';\nimport type { MiniAppsSubscribeListener } from '@/bridge/events/types.js';\n\nexport const logger = new Logger('SDK', {\n  bgColor: 'forestgreen',\n  textColor: 'white',\n});\n\nlet debugEnabled = false;\n\nconst onEvent: MiniAppsSubscribeListener = ({ name, payload }) => {\n  logger.log('Event received:', payload ? { name, payload } : { name });\n};\n\n/**\n * Sets new debug mode. Enabling debug mode leads to printing additional messages in the console,\n * related to the processes inside the package.\n * @param enable - should debug be enabled.\n */\nexport function setDebug(enable: boolean): void {\n  if (debugEnabled !== enable) {\n    debugEnabled = enable;\n    enable ? subscribe(onEvent) : unsubscribe(onEvent);\n  }\n}\n\n/**\n * Logs info message into the console.\n * @param args - additional arguments.\n */\nexport function log(...args: any[]): void {\n  if (debugEnabled) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n    logger.log(...args);\n  }\n}\n","import type { RemoveEventListenerFn } from '../types.js';\nimport type {\n  EmptyEventName,\n  EventListener,\n  EventName,\n  EventParams,\n  NonEmptyEventName,\n  SubscribeListener,\n} from './types.js';\n\nexport class EventEmitter<Schema> {\n  private readonly listeners: Map<\n    string,\n    [listener: EventListener<any>, once?: boolean][]\n  > = new Map();\n\n  private listenersCount = 0;\n\n  private subscribeListeners: SubscribeListener<Schema>[] = [];\n\n  /**\n   * Removes all event listeners.\n   */\n  clear() {\n    this.listeners.clear();\n    this.subscribeListeners = [];\n  }\n\n  /**\n   * Returns count of bound listeners.\n   */\n  get count(): number {\n    return this.listenersCount + this.subscribeListeners.length;\n  }\n\n  /**\n   * Emits known event which has no parameters.\n   * @param event - event name.\n   */\n  emit<E extends EmptyEventName<Schema>>(event: E): void;\n\n  /**\n   * Emits known event which has parameters.\n   * @param event - event name.\n   * @param args - list of event listener arguments.\n   */\n  emit<E extends NonEmptyEventName<Schema>>(event: E, ...args: EventParams<Schema[E]>): void;\n\n  emit(event: EventName<Schema>, ...args: any[]): void {\n    this.subscribeListeners.forEach((l) => l({\n      event,\n      args: args as EventParams<Schema[EventName<Schema>]>,\n    }));\n\n    const listeners = this.listeners.get(event) || [];\n\n    listeners.forEach(([listener, once]) => {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n      listener(...args);\n      if (once) {\n        this.off(event, listener);\n      }\n    });\n  }\n\n  /**\n   * Adds new event listener.\n   * @param event - event name.\n   * @param listener - event listener.\n   * @param once - should listener be called only once.\n   * @returns Function to remove bound event listener.\n   */\n  on<E extends EventName<Schema>>(\n    event: E,\n    listener: EventListener<Schema[E]>,\n    once?: boolean,\n  ): RemoveEventListenerFn {\n    let listeners = this.listeners.get(event);\n    if (!listeners) {\n      this.listeners.set(event, listeners = []);\n    }\n\n    listeners.push([listener, once]);\n    this.listenersCount += 1;\n\n    return () => this.off(event, listener);\n  }\n\n  /**\n   * Removes event listener. In case, specified listener was bound several times, it removes\n   * only a single one.\n   * @param event - event name.\n   * @param listener - event listener.\n   */\n  off<E extends EventName<Schema>>(event: E, listener: EventListener<Schema[E]>): void {\n    const listeners = this.listeners.get(event) || [];\n    for (let i = 0; i < listeners.length; i += 1) {\n      if (listener === listeners[i][0]) {\n        listeners.splice(i, 1);\n        this.listenersCount -= 1;\n        return;\n      }\n    }\n  }\n\n  /**\n   * Adds a new event listener for all events.\n   * @param listener - event listener.\n   * @returns Function to remove event listener.\n   */\n  subscribe(listener: SubscribeListener<Schema>): RemoveEventListenerFn {\n    this.subscribeListeners.push(listener);\n    return () => this.unsubscribe(listener);\n  }\n\n  /**\n   * Removes global event listener. In case, specified listener was bound several times, it removes\n   * only a single one.\n   * @param listener - event listener.\n   */\n  unsubscribe(listener: SubscribeListener<Schema>): void {\n    for (let i = 0; i < this.subscribeListeners.length; i += 1) {\n      if (this.subscribeListeners[i] === listener) {\n        this.subscribeListeners.splice(i, 1);\n        return;\n      }\n    }\n  }\n}\n","import type { RemoveEventListenerFn } from './types.js';\n\n/**\n * Adds new event listener using window.addEventListener.\n * @param type - event name.\n * @param listener - event listener.\n * @param options - listening options.\n * @returns Function to remove event listener.\n */\nexport function onWindow<K extends keyof WindowEventMap>(\n  type: K,\n  listener: (this: Window, ev: WindowEventMap[K]) => any,\n  options?: boolean | AddEventListenerOptions,\n): RemoveEventListenerFn {\n  window.addEventListener(type, listener, options);\n  return () => window.removeEventListener(type, listener, options);\n}\n","import { CleanupFn } from '@/types/index.js';\n\n/**\n * Returns a tuple, containing function to add cleanup, call cleanup, and flag showing whether\n * cleanup was called. Cleanup will not be performed in case, it was done before.\n */\nexport function createCleanup(...fns: (CleanupFn | CleanupFn[])[]): [\n  add: (fn: CleanupFn) => void,\n  cleanup: () => void,\n  cleanedUp: boolean,\n] {\n  let cleanedUp = false;\n  const cache = fns.flat(1);\n\n  return [\n    (fn) => !cleanedUp && cache.push(fn),\n    () => {\n      if (!cleanedUp) {\n        cleanedUp = true;\n        cache.forEach(clean => clean());\n      }\n    },\n    cleanedUp,\n  ];\n}","import type { ErrorType } from './errors.js';\n\n/**\n * Error used across the SDK.\n */\nexport class SDKError extends Error {\n  constructor(public readonly type: ErrorType, message?: string, cause?: unknown) {\n    super(message, { cause });\n    Object.setPrototypeOf(this, SDKError.prototype);\n  }\n}\n","import { SDKError } from './SDKError.js';\nimport type { ErrorType } from './errors.js';\n\n/**\n * Creates new error using specified type and message.\n * @param type - error code.\n * @param message - error message.\n * @param cause - original error.\n */\nexport function createError(type: ErrorType, message: string, cause?: unknown): SDKError {\n  return new SDKError(type, message, cause);\n}\n","/**\n * Specified Mini Apps method is unsupported.\n */\nexport const ERR_METHOD_UNSUPPORTED = 'ERR_METHOD_UNSUPPORTED';\n\n/**\n * Specified Mini Apps method parameter is unsupported.\n */\nexport const ERR_METHOD_PARAMETER_UNSUPPORTED = 'ERR_METHOD_PARAMETER_UNSUPPORTED';\n\n/**\n * Current environment is not Telegram application.\n */\nexport const ERR_UNKNOWN_ENV = 'ERR_UNKNOWN_ENV';\n\n/**\n * Telegram application returned and error while invoking custom method.\n */\nexport const ERR_INVOKE_CUSTOM_METHOD_RESPONSE = 'ERR_INVOKE_CUSTOM_METHOD_RESPONSE';\n\n/**\n * Timeout reached.\n */\nexport const ERR_TIMED_OUT = 'ERR_TIMED_OUT';\n\n/**\n * Value has unexpected type.\n */\nexport const ERR_UNEXPECTED_TYPE = 'ERR_UNEXPECTED_TYPE';\n\n/**\n * Something went wrong during value parsing.\n */\nexport const ERR_PARSE = 'ERR_PARSE';\n\n/**\n * Navigation entries list is empty.\n */\nexport const ERR_NAVIGATION_HISTORY_EMPTY = 'ERR_NAVIGATION_LIST_EMPTY';\n\n/**\n * Navigation entries cursor is invalid.\n */\nexport const ERR_NAVIGATION_INDEX_INVALID = 'ERR_NAVIGATION_CURSOR_INVALID';\n\n/**\n * Navigation entries item is invalid.\n */\nexport const ERR_NAVIGATION_ITEM_INVALID = 'ERR_NAVIGATION_ITEM_INVALID';\n\n/**\n * SSR component initialization failed.\n */\nexport const ERR_SSR_INIT = 'ERR_SSR_INIT';\n\n/**\n * Path starts from the invalid base.\n */\nexport const ERR_INVALID_PATH_BASE = 'ERR_INVALID_PATH_BASE';\n\nexport type ErrorType =\n  | typeof ERR_METHOD_UNSUPPORTED\n  | typeof ERR_METHOD_PARAMETER_UNSUPPORTED\n  | typeof ERR_UNKNOWN_ENV\n  | typeof ERR_INVOKE_CUSTOM_METHOD_RESPONSE\n  | typeof ERR_TIMED_OUT\n  | typeof ERR_PARSE\n  | typeof ERR_UNEXPECTED_TYPE\n  | typeof ERR_NAVIGATION_HISTORY_EMPTY\n  | typeof ERR_NAVIGATION_INDEX_INVALID\n  | typeof ERR_NAVIGATION_ITEM_INVALID\n  | typeof ERR_SSR_INIT\n  | typeof ERR_INVALID_PATH_BASE;\n","import { createError } from '@/errors/createError.js';\nimport { ERR_UNEXPECTED_TYPE } from '@/errors/errors.js';\nimport type { SDKError } from '@/errors/SDKError.js';\n\n/**\n * Creates instance of TypeError stating, that value has unexpected type.\n */\nexport function createTypeError(): SDKError {\n  return createError(ERR_UNEXPECTED_TYPE, 'Value has unexpected type');\n}\n","import { createError } from '@/errors/createError.js';\nimport { ERR_PARSE } from '@/errors/errors.js';\n\nimport type { Parser } from '../types.js';\nimport type { ValueParserOptionalResult, ValueParserParseResult } from './types.js';\n\nexport class ValueParser<ResultType, IsOptional extends boolean> {\n  constructor(\n    protected parser: Parser<ResultType>,\n    protected isOptional: IsOptional,\n    protected type?: string,\n  ) {\n  }\n\n  /**\n   * Attempts to parse passed value\n   * @param value - value to parse.\n   * @throws {SDKError} ERR_PARSE\n   * @see ERR_PARSE\n   */\n  parse(value: unknown): ValueParserParseResult<ResultType, IsOptional> {\n    // In case, parsing result is specified as optional, and passed value is considered as empty,\n    // we can return undefined. Otherwise, pass to parser.\n    if (this.isOptional && value === undefined) {\n      return undefined as ValueParserParseResult<ResultType, IsOptional>;\n    }\n\n    try {\n      return this.parser(value) as ValueParserParseResult<ResultType, IsOptional>;\n    } catch (cause) {\n      throw createError(\n        ERR_PARSE,\n        `Unable to parse value${this.type ? ` as ${this.type}` : ''}`,\n        cause,\n      );\n    }\n  }\n\n  optional(): ValueParserOptionalResult<this, ResultType> {\n    this.isOptional = true as IsOptional;\n    return this as ValueParserOptionalResult<this, ResultType>;\n  }\n}\n","import { ValueParser } from './ValueParser/ValueParser.js';\nimport type { Parser } from './types.js';\n\nexport type ValueParserGenerator<T> = () => ValueParser<T, false>;\n\n/**\n * Creates function which generates new scalar value parser based on the specified one.\n * @param parser - parser to use as basic.\n * @param type - type name.\n */\nexport function createValueParserGenerator<T>(\n  parser: Parser<T>,\n  type?: string,\n): ValueParserGenerator<T> {\n  return () => new ValueParser(parser, false, type);\n}\n","import { createTypeError } from '../createTypeError.js';\nimport { createValueParserGenerator } from '../createValueParserGenerator.js';\nimport type { ValueParserGenerator } from '../createValueParserGenerator.js';\n\n/**\n * Returns parser to parse value as boolean.\n */\nexport const boolean: ValueParserGenerator<boolean> = createValueParserGenerator((value) => {\n  if (typeof value === 'boolean') {\n    return value;\n  }\n  const asString = String(value);\n\n  if (asString === '1' || asString === 'true') {\n    return true;\n  }\n\n  if (asString === '0' || asString === 'false') {\n    return false;\n  }\n\n  throw createTypeError();\n}, 'boolean');\n","import { createError } from '@/errors/createError.js';\nimport { ERR_PARSE } from '@/errors/errors.js';\n\nimport type { Parser, Schema } from './types.js';\n\n/**\n * Parses external value by specified schema. Functions iterates over each schema field\n * and uses getField function to get its value from the external source.\n * @param schema - object schema.\n * @param getField - function which gets external value by its field name.\n */\nexport function parseBySchema<T>(\n  schema: Schema<T>,\n  getField: (field: string) => unknown,\n): T {\n  const result = {} as T;\n\n  for (const field in schema) {\n    const definition = schema[field];\n    if (!definition) {\n      continue;\n    }\n\n    let from: string;\n    let parser: Parser<any>;\n\n    // In case, definition has \"type\" property, then SchemaFieldDetailed was passed.\n    if (typeof definition === 'function' || 'parse' in definition) {\n      // Otherwise we are working with either parser function or instance.\n      from = field;\n      parser = typeof definition === 'function' ? definition : definition.parse.bind(definition);\n    } else {\n      const { type: definitionType } = definition;\n\n      from = definition.from || field;\n      parser = typeof definitionType === 'function'\n        ? definitionType\n        : definitionType.parse.bind(definitionType);\n    }\n\n    try {\n      const parsedValue = parser(getField(from));\n      if (parsedValue !== undefined) {\n        (result as any)[field] = parsedValue;\n      }\n    } catch (error) {\n      throw createError(ERR_PARSE, `Unable to parse field \"${field}\"`, error);\n    }\n  }\n\n  return result;\n}\n","import { createTypeError } from './createTypeError.js';\n\n/**\n * Converts value to record.\n * @param value - value to convert.\n * @throws {Error} Value passed as a string does not represent JSON object.\n * @throws {Error} Value is not convertable.\n */\nexport function toRecord(value: unknown): Record<string, unknown> {\n  let formattedValue: any = value;\n\n  // Convert value to JSON in case, it is string. We expect value to be JSON string.\n  if (typeof formattedValue === 'string') {\n    formattedValue = JSON.parse(formattedValue);\n  }\n\n  // We expect json to be usual object.\n  if (\n    typeof formattedValue !== 'object'\n    || formattedValue === null\n    || Array.isArray(formattedValue)\n  ) {\n    throw createTypeError();\n  }\n\n  return formattedValue as Record<string, unknown>;\n}\n","import { parseBySchema } from '../parseBySchema.js';\nimport { toRecord } from '../toRecord.js';\nimport { ValueParser } from '../ValueParser/ValueParser.js';\nimport type { Schema } from '../types.js';\n\n/**\n * Creates new Json parser according to passed schema.\n * @param schema - object schema.\n * @param type - parser type name.\n */\nexport function json<T>(schema: Schema<T>, type?: string): ValueParser<T, false> {\n  return new ValueParser((value) => {\n    const record = toRecord(value);\n    return parseBySchema(schema, (field) => record[field]);\n  }, false, type);\n}\n","import { createTypeError } from '../createTypeError.js';\nimport { createValueParserGenerator } from '../createValueParserGenerator.js';\nimport type { ValueParserGenerator } from '../createValueParserGenerator.js';\n\n/**\n * Returns parser to parse value as number.\n */\nexport const number: ValueParserGenerator<number> = createValueParserGenerator((value) => {\n  if (typeof value === 'number') {\n    return value;\n  }\n\n  if (typeof value === 'string') {\n    const num = Number(value);\n\n    if (!Number.isNaN(num)) {\n      return num;\n    }\n  }\n\n  throw createTypeError();\n}, 'number');\n","import { createTypeError } from '../createTypeError.js';\nimport { createValueParserGenerator } from '../createValueParserGenerator.js';\nimport type { ValueParserGenerator } from '../createValueParserGenerator.js';\n\n/**\n * Returns parser to parse value as string.\n */\nexport const string: ValueParserGenerator<string> = createValueParserGenerator((value) => {\n  if (typeof value === 'string' || typeof value === 'number') {\n    return value.toString();\n  }\n  throw createTypeError();\n}, 'string');\n","import { json } from '@/parsing/parsers/json.js';\nimport { string } from '@/parsing/parsers/string.js';\n\n/**\n * Message format used in communication between client and Telegram applications.\n */\nexport interface MiniAppsMessage {\n  /**\n   * Event name.\n   */\n  eventType: string;\n  /**\n   * Event parameters.\n   */\n  eventData?: unknown;\n}\n\n/**\n * Parses value as a message between client and Telegram applications.\n * @param value - value to parse.\n */\nexport function parseMessage(value: unknown): MiniAppsMessage {\n  return json({\n    eventType: string(),\n    eventData: (v) => v,\n  }).parse(value);\n}\n","/**\n * Removes global event handlers, used by the package.\n */\nexport function cleanupEventHandlers(): void {\n  ['TelegramGameProxy_receiveEvent', 'TelegramGameProxy', 'Telegram'].forEach((prop) => {\n    delete window[prop as keyof Window];\n  });\n}\n","/**\n * Emits event sent from Telegram native application like it was sent in\n * default web environment between 2 iframes. It dispatches new MessageEvent\n * and expects it to be handled via `window.addEventListener('message', ...)`\n * as developer would do it to handle messages sent from the parent iframe.\n * @param eventType - event name.\n * @param eventData - event payload.\n */\nexport function emitMiniAppsEvent(eventType: string, eventData: unknown): void {\n  window.dispatchEvent(new MessageEvent('message', {\n    data: JSON.stringify({ eventType, eventData }),\n    // We specify window.parent to imitate the case, the parent iframe sent us this event.\n    source: window.parent,\n  }));\n}\n","import { emitMiniAppsEvent } from './emitMiniAppsEvent.js';\n\n/**\n * Defines special handlers by known paths, which are recognized by\n * Telegram as ports to receive events. This function also sets special\n * function in global window object to prevent duplicate declaration.\n */\nexport function defineEventHandlers() {\n  // Iterate over each path, where \"receiveEvent\" function should be\n  // defined. This function is called by external environment in case,\n  // it wants to emit some event.\n  [\n    ['TelegramGameProxy_receiveEvent'], // Windows Phone.\n    ['TelegramGameProxy', 'receiveEvent'], // Desktop.\n    ['Telegram', 'WebView', 'receiveEvent'], // Android and iOS.\n  ].forEach((path) => {\n    // Path starts from the \"window\" object.\n    let pointer = window as any;\n\n    path.forEach((item, idx, arr) => {\n      // We are on the last iteration, where function property name is passed.\n      if (idx === arr.length - 1) {\n        pointer[item] = emitMiniAppsEvent;\n        return;\n      }\n\n      if (!(item in pointer)) {\n        pointer[item] = {};\n      }\n      pointer = pointer[item];\n    });\n  });\n}\n","import { logger } from '@/debug/debug.js';\nimport { EventEmitter } from '@/events/event-emitter/EventEmitter.js';\nimport { onWindow } from '@/events/onWindow.js';\nimport { createCleanup } from '@/misc/createCleanup.js';\nimport { boolean } from '@/parsing/parsers/boolean.js';\nimport { json } from '@/parsing/parsers/json.js';\nimport { number } from '@/parsing/parsers/number.js';\nimport { string } from '@/parsing/parsers/string.js';\n\nimport { type MiniAppsMessage, parseMessage } from '../../parseMessage.js';\nimport { cleanupEventHandlers } from '../event-handlers/cleanupEventHandlers.js';\nimport { defineEventHandlers } from '../event-handlers/defineEventHandlers.js';\nimport type {\n  MiniAppsEventName,\n  MiniAppsEventPayload,\n  MiniAppsEventEmitter,\n  MiniAppsEvents,\n} from '../types.js';\n\n/**\n * Parsers for problematic Mini Apps events.\n */\nconst parsers: {\n  [E in MiniAppsEventName]?: {\n    parse(value: unknown): MiniAppsEventPayload<E>;\n  }\n} = {\n  clipboard_text_received: json({\n    req_id: string(),\n    data: (value) => (value === null ? value : string().optional().parse(value)),\n  }),\n  custom_method_invoked: json({\n    req_id: string(),\n    result: (value) => value,\n    error: string().optional(),\n  }),\n  popup_closed: {\n    parse(value) {\n      return json({\n        button_id: (value) => (\n          value === null || value === undefined\n            ? undefined\n            : string().parse(value)\n        ),\n      }).parse(value ?? {});\n    },\n  },\n  viewport_changed: json({\n    height: number(),\n    width: (value) => (\n      value === null || value === undefined\n        ? window.innerWidth\n        : number().parse(value)\n    ),\n    is_state_stable: boolean(),\n    is_expanded: boolean(),\n  }),\n};\n\n/**\n * Creates new event emitter, which handles events from the Telegram application.\n */\nexport function createMiniAppsEventEmitter(): [\n  /**\n   * Created event emitter.\n   */\n  emitter: MiniAppsEventEmitter,\n  /**\n   * Function to dispose created emitter.\n   */\n  dispose: () => void,\n] {\n  // We use this event emitter for better developer experience, using the subscribe method.\n  const subEmitter = new EventEmitter<{ event: any[] }>();\n\n  // Event emitter processing all the incoming events.\n  const mainEmitter = new EventEmitter<MiniAppsEvents>();\n\n  mainEmitter.subscribe(event => {\n    subEmitter.emit('event', { name: event.event, payload: event.args[0] });\n  });\n\n  // Define event handles, which will proxy native method calls to their web version.\n  defineEventHandlers();\n\n  // List of cleanup functions, which should be called on dispose.\n  const [, cleanup] = createCleanup(\n    // Don't forget to remove created handlers.\n    cleanupEventHandlers,\n    // Add \"resize\" event listener to make sure, we always have fresh viewport information.\n    // Desktop version of Telegram is sometimes not sending the viewport_changed\n    // event. For example, when the MainButton is shown. That's why we should\n    // add our own listener to make sure, viewport information is always fresh.\n    // Issue: https://github.com/Telegram-Mini-Apps/tma.js/issues/10\n    onWindow('resize', () => {\n      mainEmitter.emit('viewport_changed', {\n        width: window.innerWidth,\n        height: window.innerHeight,\n        is_state_stable: true,\n        is_expanded: true,\n      });\n    }),\n    // Add listener, which handles events sent from the Telegram web application and also events\n    // generated by the local emitEvent function.\n    onWindow('message', (event) => {\n      // Ignore non-parent window messages.\n      if (event.source !== window.parent) {\n        return;\n      }\n\n      // Parse incoming event data.\n      let message: MiniAppsMessage;\n      try {\n        message = parseMessage(event.data);\n      } catch {\n        // We ignore incorrect messages as they could be generated by any other code.\n        return;\n      }\n\n      const { eventType, eventData } = message;\n      const parser = parsers[eventType as keyof typeof parsers];\n\n      try {\n        const data = parser ? parser.parse(eventData) : eventData;\n        mainEmitter.emit(...(data ? [eventType, data] : [eventType]) as [any, any]);\n      } catch (cause) {\n        logger.error(\n          `An error occurred processing the \"${eventType}\" event from the Telegram application.\\nPlease, file an issue here:\\nhttps://github.com/Telegram-Mini-Apps/tma.js/issues/new/choose`,\n          message,\n          cause,\n        );\n      }\n    }),\n    // Clear emitters.\n    () => subEmitter.clear(),\n    () => mainEmitter.clear(),\n  );\n\n  return [{\n    on: mainEmitter.on.bind(mainEmitter),\n    off: mainEmitter.off.bind(mainEmitter),\n    subscribe(listener) {\n      return subEmitter.on('event', listener);\n    },\n    unsubscribe(listener) {\n      subEmitter.off('event', listener);\n    },\n    get count() {\n      return mainEmitter.count + subEmitter.count;\n    },\n  }, cleanup];\n}\n","import { createSingleton } from '@/misc/createSingleton.js';\n\nimport { createMiniAppsEventEmitter } from './createMiniAppsEventEmitter.js';\nimport type { MiniAppsEventEmitter } from '../types.js';\n\nconst [get, resetMiniAppsEventEmitter] = createSingleton(\n  (reset) => {\n    const [emitter, cleanup] = createMiniAppsEventEmitter();\n\n    // Rewire \"off\" method and make it reset singleton if no event listeners left.\n    const off = emitter.off.bind(emitter);\n    emitter.off = (event, listener) => {\n      const { count } = emitter;\n      off(event, listener);\n\n      // If event emitter now has no listeners, we can perform a reset.\n      if (count && !emitter.count) {\n        reset();\n      }\n    };\n\n    return [emitter, cleanup] as const;\n  },\n  ([, cleanup]) => cleanup(),\n);\n\n/**\n * Returns Mini Apps event emitter singleton.\n */\nexport function miniAppsEventEmitter(): MiniAppsEventEmitter {\n  return get()[0];\n}\n\nexport { resetMiniAppsEventEmitter };\n","import { miniAppsEventEmitter } from '../event-emitter/singleton.js';\nimport type { MiniAppsEventListener, MiniAppsEventName } from '../types.js';\n\n/**\n * Removes listener from specified event.\n * @param event - event to listen.\n * @param listener - event listener to remove.\n */\nexport function off<E extends MiniAppsEventName>(\n  event: E,\n  listener: MiniAppsEventListener<E>,\n): void {\n  miniAppsEventEmitter().off(event, listener);\n}\n","import type { RemoveEventListenerFn } from '@/events/types.js';\n\nimport { miniAppsEventEmitter } from '../event-emitter/singleton.js';\nimport type { MiniAppsEventListener, MiniAppsEventName } from '../types.js';\n\n/**\n * Adds new listener to the specified event. Returns handler\n * which allows to stop listening to event.\n * @param event - event name.\n * @param listener - event listener.\n * @param once - should listener be called only once.\n * @returns Function to remove bound event listener.\n */\nexport function on<E extends MiniAppsEventName>(\n  event: E,\n  listener: MiniAppsEventListener<E>,\n  once?: boolean,\n): RemoveEventListenerFn {\n  return miniAppsEventEmitter().on(event, listener, once);\n}\n","/**\n * States that passed value is Record and not Array.\n * @param value - value to check.\n */\nexport function isRecord(value: unknown): value is Record<string, unknown> {\n  return typeof value === 'object' && value !== null && !Array.isArray(value);\n}\n","import type { Version } from './types.js';\n\n/**\n * Returns 1 in case, version \"a\" is greater than \"b\".\n * Returns 0 in case, version \"a\" equal to \"b\".\n * Returns -1 in case, version \"a\" is lower than \"b\".\n * @param a - first version.\n * @param b - second version.\n */\nexport function compareVersions(a: Version, b: Version): number {\n  // Split both of the version by dot.\n  const aParts = a.split('.');\n  const bParts = b.split('.');\n\n  // Compute maximum length.\n  const len = Math.max(aParts.length, bParts.length);\n\n  // Iterate over each part of version and compare them. In case, part is\n  // missing, assume its value is equal to 0.\n  for (let i = 0; i < len; i += 1) {\n    const aVal = parseInt(aParts[i] || '0', 10);\n    const bVal = parseInt(bParts[i] || '0', 10);\n\n    if (aVal === bVal) {\n      continue;\n    }\n    return aVal > bVal ? 1 : -1;\n  }\n  return 0;\n}\n","import { compareVersions } from '@/version/compareVersions.js';\nimport type {\n  MiniAppsMethodName,\n  MiniAppsMethodVersionedParams,\n  MiniAppsMethodWithVersionedParams,\n} from '@/bridge/methods/types/methods.js';\nimport type { Version } from '@/version/types.js';\n\n/**\n * Returns true if \"a\" version is less than or equal to \"b\" version.\n * @param a\n * @param b\n */\nfunction versionLessOrEqual(a: Version, b: Version): boolean {\n  return compareVersions(a, b) <= 0;\n}\n\n/**\n * Returns true in case, passed parameter in specified method is supported.\n * @param method - method name\n * @param param - method parameter\n * @param inVersion - platform version.\n */\nexport function supports<M extends MiniAppsMethodWithVersionedParams>(\n  method: M,\n  param: MiniAppsMethodVersionedParams<M>,\n  inVersion: Version,\n): boolean;\n\n/**\n * Returns true in case, specified method is supported in passed version.\n * @param method - method name.\n * @param inVersion - platform version.\n */\nexport function supports(method: MiniAppsMethodName, inVersion: Version): boolean;\n\nexport function supports(\n  method: MiniAppsMethodName,\n  paramOrVersion: Version | string,\n  inVersion?: string,\n): boolean {\n  // Method name, parameter, target version.\n  if (typeof inVersion === 'string') {\n    if (method === 'web_app_open_link') {\n      if (paramOrVersion === 'try_instant_view') {\n        return versionLessOrEqual('6.4', inVersion);\n      }\n      if (paramOrVersion === 'try_browser') {\n        return versionLessOrEqual('7.6', inVersion);\n      }\n    }\n\n    if (method === 'web_app_set_header_color') {\n      if (paramOrVersion === 'color') {\n        return versionLessOrEqual('6.9', inVersion);\n      }\n    }\n\n    if (method === 'web_app_close' && paramOrVersion === 'return_back') {\n      return versionLessOrEqual('7.6', inVersion);\n    }\n  }\n\n  switch (method) {\n    case 'web_app_open_tg_link':\n    case 'web_app_open_invoice':\n    case 'web_app_setup_back_button':\n    case 'web_app_set_background_color':\n    case 'web_app_set_header_color':\n    case 'web_app_trigger_haptic_feedback':\n      return versionLessOrEqual('6.1', paramOrVersion);\n    case 'web_app_open_popup':\n      return versionLessOrEqual('6.2', paramOrVersion);\n    case 'web_app_close_scan_qr_popup':\n    case 'web_app_open_scan_qr_popup':\n    case 'web_app_read_text_from_clipboard':\n      return versionLessOrEqual('6.4', paramOrVersion);\n    case 'web_app_switch_inline_query':\n      return versionLessOrEqual('6.7', paramOrVersion);\n    case 'web_app_invoke_custom_method':\n    case 'web_app_request_write_access':\n    case 'web_app_request_phone':\n      return versionLessOrEqual('6.9', paramOrVersion);\n    case 'web_app_setup_settings_button':\n      return versionLessOrEqual('6.10', paramOrVersion);\n    case 'web_app_biometry_get_info':\n    case 'web_app_biometry_open_settings':\n    case 'web_app_biometry_request_access':\n    case 'web_app_biometry_request_auth':\n    case 'web_app_biometry_update_token':\n      return versionLessOrEqual('7.2', paramOrVersion);\n    default:\n      return [\n        'iframe_ready',\n        'iframe_will_reload',\n        'web_app_close',\n        'web_app_data_send',\n        'web_app_expand',\n        'web_app_open_link',\n        'web_app_ready',\n        'web_app_request_theme',\n        'web_app_request_viewport',\n        'web_app_setup_main_button',\n        'web_app_setup_closing_behavior',\n      ].includes(method);\n  }\n}\n","import { isRecord } from '@/misc/isRecord.js';\n\n/**\n * Returns true in case, passed value contains path `external.notify` property and `notify` is a\n * function.\n * @param value - value to check.\n */\nexport function hasExternalNotify<T extends object>(value: T): value is (\n  T & {\n  external: {\n    notify: (...args: any) => any;\n  };\n}) {\n  return 'external' in value\n    && isRecord(value.external)\n    && 'notify' in value.external\n    && typeof value.external.notify === 'function';\n}\n","import { isRecord } from '@/misc/isRecord.js';\n\n/**\n * Returns true in case, passed value contains path `TelegramWebviewProxy.postEvent` property and\n * `postEvent` is a function.\n * @param value - value to check.\n */\nexport function hasWebviewProxy<T extends {}>(value: T): value is (\n  T & {\n  TelegramWebviewProxy: {\n    postEvent: (...args: unknown[]) => unknown;\n  }\n}) {\n  return 'TelegramWebviewProxy' in value\n    && isRecord(value.TelegramWebviewProxy)\n    && 'postEvent' in value.TelegramWebviewProxy\n    && typeof value.TelegramWebviewProxy.postEvent === 'function';\n}\n","/**\n * @see https://stackoverflow.com/a/326076\n * @returns True, if current environment is iframe.\n */\nexport function isIframe(): boolean {\n  try {\n    return window.self !== window.top;\n  } catch {\n    return true;\n  }\n}\n","const INITIAL_TARGET_ORIGIN = 'https://web.telegram.org'\n\nlet currentTargetOrigin = INITIAL_TARGET_ORIGIN;\n\n/**\n * Sets a new global targetOrigin, used by the `postEvent` method.\n * The default value is \"https://web.telegram.org\".\n * You don't need to use this method until you know what you are doing.\n *\n * This method could be used for test purposes.\n * @param value - new target origin.\n * @see postEvent\n */\nexport function setTargetOrigin(value: string): void {\n  currentTargetOrigin = value;\n}\n\n/**\n * Sets the initial target origin.\n */\nexport function resetTargetOrigin(): void {\n  setTargetOrigin(INITIAL_TARGET_ORIGIN);\n}\n\n/**\n * Returns current global target origin.\n */\nexport function targetOrigin(): string {\n  return currentTargetOrigin;\n}\n","import { log } from '@/debug/debug.js';\nimport { hasExternalNotify } from '@/env/hasExternalNotify.js';\nimport { hasWebviewProxy } from '@/env/hasWebviewProxy.js';\nimport { isIframe } from '@/env/isIframe.js';\nimport { createError } from '@/errors/createError.js';\nimport { ERR_UNKNOWN_ENV } from '@/errors/errors.js';\n\nimport { targetOrigin as targetOriginFn } from '../target-origin.js';\nimport type {\n  MiniAppsMethodName,\n  MiniAppsMethodParams,\n  MiniAppsMethodWithOptionalParams,\n  MiniAppsMethodWithoutParams,\n  MiniAppsMethodWithRequiredParams,\n} from './types/methods.js';\n\ninterface PostEventOptions {\n  /**\n   * Origin used while posting a message.\n   *\n   * This option is only used if the current environment is browser (Web version of Telegram)\n   * and could be used for test purposes.\n   * @default 'https://web.telegram.org'\n   */\n  targetOrigin?: string;\n}\n\nexport type PostEvent = typeof postEvent;\n\n/**\n * Calls Mini Apps method with optional parameters.\n * @param method - method name.\n * @param params - method parameters.\n * @param options - posting options.\n * @throws {SDKError} ERR_UNKNOWN_ENV\n * @see ERR_UNKNOWN_ENV\n */\nexport function postEvent<Method extends MiniAppsMethodWithOptionalParams>(\n  method: Method,\n  params?: MiniAppsMethodParams<Method>,\n  options?: PostEventOptions,\n): void;\n\n/**\n * Calls Mini Apps method without parameters.\n * @param method - method name.\n * @param options - posting options.\n * @throws {SDKError} ERR_UNKNOWN_ENV\n * @see ERR_UNKNOWN_ENV\n */\nexport function postEvent(\n  method: MiniAppsMethodWithoutParams | MiniAppsMethodWithOptionalParams,\n  options?: PostEventOptions,\n): void;\n\n/**\n * Calls Mini Apps method with parameters.\n * @param method - method name.\n * @param params - method parameters.\n * @param options - posting options.\n * @throws {SDKError} ERR_UNKNOWN_ENV\n * @see ERR_UNKNOWN_ENV\n */\nexport function postEvent<Method extends MiniAppsMethodWithRequiredParams>(\n  method: Method,\n  params: MiniAppsMethodParams<Method>,\n  options?: PostEventOptions,\n): void;\n\nexport function postEvent(\n  eventType: MiniAppsMethodName,\n  paramsOrOptions?: MiniAppsMethodParams<MiniAppsMethodName> | PostEventOptions,\n  options?: PostEventOptions,\n): void {\n  let postOptions: PostEventOptions = {};\n  let eventData: any;\n\n  if (!paramsOrOptions && !options) {\n    // Parameters and options were not passed.\n    postOptions = {};\n  } else if (paramsOrOptions && options) {\n    // Both parameters and options passed.\n    postOptions = options;\n    eventData = paramsOrOptions;\n  } else if (paramsOrOptions) {\n    // Only parameters were passed.\n    if ('targetOrigin' in paramsOrOptions) {\n      postOptions = paramsOrOptions;\n    } else {\n      eventData = paramsOrOptions;\n    }\n  }\n\n  log('Posting event:', eventData\n    ? { event: eventType, data: eventData }\n    : { event: eventType });\n\n  // Telegram Web.\n  if (isIframe()) {\n    return window.parent.postMessage(\n      JSON.stringify({ eventType, eventData }),\n      postOptions.targetOrigin || targetOriginFn(),\n    );\n  }\n\n  // Telegram for Windows Phone or Android.\n  if (hasExternalNotify(window)) {\n    window.external.notify(JSON.stringify({ eventType, eventData }));\n    return;\n  }\n\n  // Telegram for iOS and macOS.\n  if (hasWebviewProxy(window)) {\n    window.TelegramWebviewProxy.postEvent(eventType, JSON.stringify(eventData));\n    return;\n  }\n\n  // Otherwise current environment is unknown, and we are not able to send event.\n  throw createError(\n    ERR_UNKNOWN_ENV,\n    'Unable to determine current environment and possible way to send event. You are probably trying to use Mini Apps method outside the Telegram application environment.',\n  );\n}\n","import { createError } from '@/errors/createError.js';\nimport { ERR_METHOD_PARAMETER_UNSUPPORTED, ERR_METHOD_UNSUPPORTED } from '@/errors/errors.js';\nimport { isRecord } from '@/misc/isRecord.js';\nimport { supports } from '@/supports/supports.js';\nimport type { Version } from '@/version/types.js';\n\nimport { type PostEvent, postEvent } from './postEvent.js';\n\n/**\n * Creates a function which checks if specified method and parameters are supported.\n *\n * If method or parameters are unsupported, an error will be thrown.\n * @param version - Telegram Mini Apps version.\n * @throws {SDKError} ERR_METHOD_UNSUPPORTED\n * @throws {SDKError} ERR_METHOD_PARAMETER_UNSUPPORTED\n * @see ERR_METHOD_UNSUPPORTED\n * @see ERR_METHOD_PARAMETER_UNSUPPORTED\n */\nexport function createPostEvent(version: Version): PostEvent {\n  return (method: any, params: any) => {\n    // Firstly, check if a method is supported.\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n    if (!supports(method, version)) {\n      throw createError(ERR_METHOD_UNSUPPORTED, `Method \"${method}\" is unsupported in Mini Apps version ${version}`);\n    }\n\n    // Method could use parameters, which are supported only in specific\n    // versions of Mini Apps.\n    // We are validating only those parameters, which are not backward compatible.\n    if (\n      isRecord(params)\n      && method === 'web_app_set_header_color'\n      && 'color' in params\n      && !supports(method, 'color', version)\n    ) {\n      throw createError(\n        ERR_METHOD_PARAMETER_UNSUPPORTED,\n        `Parameter \"color\" of \"${method}\" method is unsupported in Mini Apps version ${version}`,\n      );\n    }\n\n    return postEvent(method, params);\n  };\n}\n","type CaptureSameReqFn = (payload: { req_id: string }) => boolean;\n\n/**\n * Returns a function which can be used in `request` function `capture` property to capture\n * the event with the same request identifier.\n * @param reqId - request identifier.\n */\nexport function captureSameReq(reqId: string): CaptureSameReqFn {\n  return ({ req_id }) => req_id === reqId;\n}\n","import { createError } from '@/errors/createError.js';\nimport { ERR_TIMED_OUT } from '@/errors/errors.js';\nimport type { SDKError } from '@/errors/SDKError.js';\n\n/**\n * Creates new timeout error.\n * @param timeout - timeout in ms.\n */\nexport function createTimeoutError(timeout: number): SDKError {\n  return createError(ERR_TIMED_OUT, `Timeout reached: ${timeout}ms`);\n}\n","import { createTimeoutError } from '@/timeout/createTimeoutError.js';\n\n/**\n * Runs passed function or promise with specified deadline presented via timeout argument.\n * @param funcOrPromise - function to execute or pending promise.\n * @param timeout - completion timeout.\n */\nexport function withTimeout<T>(\n  funcOrPromise: Promise<T> | (() => Promise<T>),\n  timeout: number,\n): Promise<T> {\n  return Promise.race([\n    typeof funcOrPromise === 'function' ? funcOrPromise() : funcOrPromise,\n    new Promise<never>((_, rej) => {\n      setTimeout(() => {\n        rej(createTimeoutError(timeout));\n      }, timeout);\n    }),\n  ]);\n}\n","import { withTimeout } from '@/timeout/withTimeout.js';\nimport type { ExecuteWithOptions, If, IsNever } from '@/types/index.js';\n\nimport { on } from './events/listening/on.js';\nimport { postEvent as defaultPostEvent } from './methods/postEvent.js';\nimport type { MiniAppsEventName, MiniAppsEventPayload } from './events/types.js';\nimport type { MiniAppsMethodName, MiniAppsMethodParams } from './methods/types/index.js';\nimport { createCleanup } from '@/misc/createCleanup.js';\n\n/**\n * Returns all possible payloads for the specified events array.\n */\nexport type RequestEventsPayloads<E extends MiniAppsEventName[]> =\n  E extends (infer U extends MiniAppsEventName)[]\n    ? MiniAppsEventPayload<U>\n    : never;\n\nexport type RequestCaptureEventsFn<E extends MiniAppsEventName[]> =\n  E extends (infer U extends MiniAppsEventName)[]\n    ? (payload: {\n      [K in U]: If<\n        IsNever<MiniAppsEventPayload<K>>,\n        { event: K },\n        { event: K; payload: MiniAppsEventPayload<K> }\n      >\n    }[U]) => boolean\n    : never;\n\nexport type RequestCaptureEventFn<E extends MiniAppsEventName> = If<\n  IsNever<MiniAppsEventPayload<E>>,\n  () => boolean,\n  (payload: MiniAppsEventPayload<E>) => boolean\n>;\n\n/**\n * `request` method options.\n * @see request\n */\nexport type RequestOptions<M extends MiniAppsMethodName, E, C> = {\n    /**\n     * Mini Apps method name.\n     */\n    method: M;\n    /**\n     * Tracked Mini Apps events.\n     */\n    event: E;\n    /**\n     * Should return true if this event should be captured.\n     * A request will be captured if this property is omitted.\n     */\n    capture?: C;\n  }\n  & ExecuteWithOptions\n  & If<IsNever<MiniAppsMethodParams<M>>, {}, {\n  /**\n   * List of method parameters.\n   */\n  params: MiniAppsMethodParams<M>\n}>;\n\ntype AnyRequestResult =\n  | MiniAppsEventPayload<MiniAppsEventName>\n  | RequestEventsPayloads<MiniAppsEventName[]>;\n\n/**\n * Calls specified Mini Apps method and captures specified event.\n * @param options - method options.\n * @returns Promise which will be resolved with data of the captured event.\n */\nexport async function request<M extends MiniAppsMethodName, E extends MiniAppsEventName>(\n  options: RequestOptions<M, E, RequestCaptureEventFn<E>>,\n): Promise<MiniAppsEventPayload<E>>;\n\n/**\n * Calls specified Mini Apps method and captures one of the specified events.\n * @param options - method options.\n * @returns Promise which will be resolved with data of the first captured event.\n */\nexport async function request<M extends MiniAppsMethodName, E extends MiniAppsEventName[]>(\n  options: RequestOptions<M, E, RequestCaptureEventsFn<E>>,\n): Promise<RequestEventsPayloads<E>>;\n\nexport async function request<M extends MiniAppsMethodName>(\n  options:\n    | RequestOptions<M, MiniAppsEventName, RequestCaptureEventFn<MiniAppsEventName>>\n    | RequestOptions<M, MiniAppsEventName[], RequestCaptureEventsFn<MiniAppsEventName[]>>,\n): Promise<AnyRequestResult> {\n  let resolve: (payload: AnyRequestResult) => void;\n  const promise = new Promise<AnyRequestResult>(res => resolve = res);\n\n  const { event, capture, timeout } = options;\n  const [, cleanup] = createCleanup(\n    // We need to iterate over all tracked events, and create their event listeners.\n    (Array.isArray(event) ? event : [event]).map((ev) => {\n      // Each event listener waits for the event to occur.\n      // Then, if the capture function was passed, we should check if the event should be captured.\n      // If the function is omitted, we instantly capture the event.\n      return on(ev, (payload) => {\n        if (!capture || (\n          Array.isArray(event)\n            ? (capture as RequestCaptureEventsFn<MiniAppsEventName[]>)({\n              event: ev,\n              payload: payload as any,\n            })\n            : (capture as RequestCaptureEventFn<MiniAppsEventName>)(payload)\n        )) {\n          resolve(payload);\n        }\n      });\n    }),\n  );\n\n  try {\n    (options.postEvent || defaultPostEvent)(options.method as any, (options as any).params);\n    return await (timeout ? withTimeout(promise, timeout) : promise);\n  } finally {\n    // After promise execution was completed, don't forget to remove all the listeners.\n    cleanup();\n  }\n}\n","import { createError } from '@/errors/createError.js';\nimport { ERR_INVOKE_CUSTOM_METHOD_RESPONSE } from '@/errors/errors.js';\nimport type { ExecuteWithOptions } from '@/types/index.js';\n\nimport { captureSameReq } from './captureSameReq.js';\nimport { request } from './request.js';\nimport type { CustomMethodName, CustomMethodParams } from './methods/types/custom-methods.js';\n\n/**\n * Invokes known custom method. Returns method execution result.\n * @param method - method name.\n * @param params - method parameters.\n * @param requestId - request identifier.\n * @param options - additional options.\n * @throws {SDKError} ERR_INVOKE_CUSTOM_METHOD_RESPONSE\n * @see ERR_INVOKE_CUSTOM_METHOD_RESPONSE\n */\nexport async function invokeCustomMethod<M extends CustomMethodName>(\n  method: M,\n  params: CustomMethodParams<M>,\n  requestId: string,\n  options?: ExecuteWithOptions,\n): Promise<unknown>;\n\n/**\n * Invokes unknown custom method. Returns method execution result.\n * @param method - method name.\n * @param params - method parameters.\n * @param requestId - request identifier.\n * @param options - additional options.\n * @throws {SDKError} ERR_INVOKE_CUSTOM_METHOD_RESPONSE\n * @see ERR_INVOKE_CUSTOM_METHOD_RESPONSE\n */\nexport function invokeCustomMethod(\n  method: string,\n  params: object,\n  requestId: string,\n  options?: ExecuteWithOptions,\n): Promise<unknown>;\n\nexport async function invokeCustomMethod(\n  method: string,\n  params: object,\n  requestId: string,\n  options: ExecuteWithOptions = {},\n): Promise<unknown> {\n  const {\n    result,\n    error,\n  } = await request({\n    ...options,\n    method: 'web_app_invoke_custom_method',\n    event: 'custom_method_invoked',\n    params: {\n      method,\n      params,\n      req_id: requestId,\n    },\n    capture: captureSameReq(requestId),\n  });\n\n  if (error) {\n    throw createError(ERR_INVOKE_CUSTOM_METHOD_RESPONSE, error);\n  }\n\n  return result;\n}\n","import { isRecord } from '@/misc/isRecord.js';\n\n/**\n * Function which joins passed values with space following these rules:\n * 1. If value is non-empty string, it will be added to output.\n * 2. If value is object, only those keys will be added, which values are truthy.\n * 3. If value is array, classNames will be called with this value spread.\n * 4. All other values are ignored.\n *\n * You can find this function to similar one from the package {@link https://www.npmjs.com/package/classnames|classnames}.\n * @param values - values array.\n * @returns Final class name.\n */\nexport function classNames(...values: any[]): string {\n  return values\n    .map((value) => {\n      if (typeof value === 'string') {\n        return value;\n      }\n\n      if (isRecord(value)) {\n        return classNames(Object.entries(value).map((entry) => entry[1] && entry[0]));\n      }\n\n      if (Array.isArray(value)) {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n        return classNames(...value);\n      }\n    })\n    .filter(Boolean)\n    .join(' ');\n}\n","import { isRecord } from '@/misc/isRecord.js';\nimport type { UnionOptionalKeys, UnionRequiredKeys } from '@/types/unions.js';\n\nimport { classNames } from './classNames.js';\n\nexport type MergeClassNames<Tuple extends any[]> =\n  // Removes all types from union which will be ignored by the mergeClassNames function.\n  Exclude<Tuple[number], number | string | null | undefined | any[] | boolean> extends infer Union\n    ? {\n    [K in UnionRequiredKeys<Union>]: string;\n  } & {\n    [K in UnionOptionalKeys<Union>]?: string;\n  }\n    : never;\n\n/**\n * Merges 2 sets of parameters. Function expects passing an array of objects with values, which\n * could be passed to `classNames` function. As the result, it returns an object with keys\n * from all objects with merged values.\n * @see classNames\n */\nexport function mergeClassNames<T extends any[]>(...partials: T): MergeClassNames<T> {\n  return partials.reduce<MergeClassNames<T>>((acc, partial) => {\n    if (!isRecord(partial)) {\n      return acc;\n    }\n\n    Object.entries(partial).forEach(([key, value]) => {\n      const className = classNames((acc as any)[key], value);\n\n      if (className.length) {\n        (acc as any)[key] = className;\n      }\n    });\n\n    return acc;\n  }, {} as MergeClassNames<T>);\n}\n","import type { RGB } from './types.js';\n\n/**\n * Returns true in case, passed value has #RRGGBB format.\n * @param value - value to check.\n */\nexport function isRGB(value: string): value is RGB {\n  return /^#[\\da-f]{6}$/i.test(value);\n}\n","import type { RGBShort } from './types.js';\n\n/**\n * Returns true in case, passed value has #RGB format.\n * @param value - value to check.\n */\nexport function isRGBShort(value: string): value is RGBShort {\n  return /^#[\\da-f]{3}$/i.test(value);\n}\n","import { isRGB } from './isRGB.js';\nimport { isRGBShort } from './isRGBShort.js';\nimport type { RGB } from './types.js';\n\n/**\n * Converts passed value to #RRGGBB format. Accepts following color formats:\n * - `#RGB`\n * - `#RRGGBB`\n * - `rgb(1,2,3)`\n * - `rgba(1,2,3,4)`\n * @param value - value to convert.\n * @throws {Error} Passed value does not satisfy any of known RGB formats.\n */\nexport function toRGB(value: string): RGB {\n  // Remove all spaces.\n  const clean = value.replace(/\\s/g, '').toLowerCase();\n\n  // Value already has required format.\n  if (isRGB(clean)) {\n    return clean;\n  }\n\n  // Convert from #RGB.\n  if (isRGBShort(clean)) {\n    let color: RGB = '#';\n    for (let i = 0; i < 3; i += 1) {\n      color += clean[1 + i].repeat(2);\n    }\n    return color;\n  }\n\n  // Example valid values: rgb(0,3,10) rgba(32,114,8,0)\n  const match = clean.match(/^rgb\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3})\\)$/)\n    || clean.match(/^rgba\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3}),\\d{1,3}\\)$/);\n\n  // In case, this didn't work as well, we can't extract RGB color from passed\n  // text.\n  if (!match) {\n    throw new Error(`Value \"${value}\" does not satisfy any of known RGB formats.`);\n  }\n\n  // Otherwise, take R, G and B components, convert to hex and create #RRGGBB\n  // string.\n  return match.slice(1).reduce((acc, component) => {\n    const formatted = parseInt(component, 10).toString(16);\n    return acc + (formatted.length === 1 ? '0' : '') + formatted;\n  }, '#') as RGB;\n}\n","import { toRGB } from './toRGB.js';\n\n/**\n * Returns true in case, the color is recognized as dark.\n * @param color - color in any format acceptable by toRGB function.\n * @see toRGB\n */\nexport function isColorDark(color: string): boolean {\n  // Convert color to RGB.\n  const rgb = toRGB(color);\n\n  // Real formula: hsp = Math.sqrt(0.299 * r * r + 0.587 * g * g + 0.114 * b * b)\n  // See: https://stackoverflow.com/a/596243\n  return Math.sqrt(\n    [0.299, 0.587, 0.114].reduce<number>((acc, modifier, idx) => {\n      // Extract part of #RRGGBB pattern and convert it to DEC.\n      const dec = parseInt(rgb.slice(1 + idx * 2, 1 + (idx + 1) * 2), 16);\n      return acc + dec * dec * modifier;\n    }, 0),\n  ) < 120;\n}\n","import { EventEmitter } from '@/events/event-emitter/EventEmitter.js';\nimport type { StateEvents } from '@/classes/State/types.js';\nimport type { StringKeys } from '@/types/utils.js';\n\ntype Emitter<State extends object> = EventEmitter<StateEvents<State>>;\n\nexport class State<State extends object> {\n  private readonly ee: Emitter<State> = new EventEmitter();\n\n  constructor(\n    /**\n     * Initial state.\n     */\n    private readonly state: State,\n  ) {\n  }\n\n  /**\n   * Clones current state and returns its copy.\n   */\n  clone(): State {\n    return { ...this.state };\n  }\n\n  /**\n   * Sets value by key.\n   * @param key - state key.\n   * @param value - value to set.\n   */\n  set<K extends StringKeys<State>>(key: K, value: State[K]): void;\n  /**\n   * Sets several values simultaneously.\n   * @param state - partial state.\n   */\n  set(state: Partial<State>): void;\n  set(keyOrState: StringKeys<State> | Partial<State>, keyValue?: State[keyof State]): void {\n    const didChange = Object\n      .entries(typeof keyOrState === 'string' ? { [keyOrState]: keyValue } : keyOrState)\n      .reduce((acc, [key, value]) => {\n        // If value is the same or missing at all, we skip it.\n        if (this.state[key as keyof State] === value || value === undefined) {\n          return acc;\n        }\n\n        // Otherwise set new value and emit change event.\n        this.state[key as keyof State] = value;\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n        (this.ee as any).emit(`change:${key}`, value);\n\n        return true;\n      }, false);\n\n    if (didChange) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n      (this.ee as any).emit('change', this.state);\n    }\n  }\n\n  /**\n   * Returns value by specified key.\n   * @param key - state key.\n   */\n  get<K extends StringKeys<State>>(key: K): State[K] {\n    return this.state[key];\n  }\n\n  /**\n   * Adds new event listener.\n   */\n  on: Emitter<State>['on'] = this.ee.on.bind(this.ee);\n\n  /**\n   * Removes event listener.\n   */\n  off: Emitter<State>['off'] = this.ee.off.bind(this.ee);\n}\n","import { State } from '@/classes/State/State.js';\n\nexport class WithStateUtils<Shape extends object> {\n  protected state: State<Shape>;\n\n  constructor(shape: Shape) {\n    this.state = new State(shape);\n    this.set = this.state.set.bind(this.state);\n    this.get = this.state.get.bind(this.state);\n    this.clone = this.state.clone.bind(this.state);\n  }\n\n  /**\n   * Gets the state value.\n   */\n  protected get: State<Shape>['get'];\n\n  /**\n   * Sets the state value.\n   */\n  protected set: State<Shape>['set'];\n\n  /**\n   * Clones the current state.\n   */\n  protected clone: State<Shape>['clone'];\n}\n","import { supports } from '@/supports/supports.js';\nimport type { MiniAppsMethodName } from '@/bridge/methods/types/methods.js';\nimport type { SupportsFn } from '@/supports/types.js';\nimport type { Version } from '@/version/types.js';\n\nexport type SupportsSchema<Method extends string> = Record<Method, MiniAppsMethodName>;\n\n/**\n * Returns function, which accepts predefined method name and checks if it is supported\n * via passed schema and version.\n * @param schema - object which contains methods names and TWA method as a dependency.\n * @param version - platform version.\n */\nexport function createSupportsFn<Method extends string>(\n  version: Version,\n  schema: SupportsSchema<Method>,\n): SupportsFn<Method> {\n  return (method) => supports(schema[method], version);\n}\n","import { WithStateUtils } from '@/classes/WithStateUtils.js';\nimport { createSupportsFn } from '@/supports/createSupportsFn.js';\nimport type { MiniAppsMethodName } from '@/bridge/methods/types/methods.js';\nimport type { SupportsFn } from '@/supports/types.js';\nimport type { Version } from '@/version/types.js';\n\nexport class WithSupportsAndStateUtils<StateShape extends object, SupportsMethod extends string>\nextends WithStateUtils<StateShape> {\n  constructor(\n    /**\n     * Initial state.\n     */\n    stateShape: StateShape,\n    /**\n     * Mini Apps version.\n     */\n    version: Version,\n    /**\n     * Supports method schema.\n     */\n    supportsSchema: Record<SupportsMethod, MiniAppsMethodName>,\n  ) {\n    super(stateShape);\n    this.supports = createSupportsFn(version, supportsSchema);\n  }\n\n  /**\n   * @returns True, if specified method is supported by the current component.\n   */\n  supports: SupportsFn<SupportsMethod>;\n}\n","import { off } from '@/bridge/events/listening/off.js';\nimport { on } from '@/bridge/events/listening/on.js';\nimport { WithSupportsAndStateUtils } from '@/classes/WithSupportsAndStateUtils.js';\nimport type { PostEvent } from '@/bridge/methods/postEvent.js';\nimport type { BackButtonEvents, BackButtonState } from '@/components/BackButton/types.js';\nimport type { EventEmitter } from '@/events/event-emitter/EventEmitter.js';\nimport type { Version } from '@/version/types.js';\n\ntype Emitter = EventEmitter<BackButtonEvents>;\n\n/**\n * @see Usage: https://docs.telegram-mini-apps.com/platform/back-button\n * @see API: https://docs.telegram-mini-apps.com/packages/tma-js-sdk/components/back-button\n */\nexport class BackButton extends WithSupportsAndStateUtils<BackButtonState, 'show' | 'hide'> {\n  constructor(isVisible: boolean, version: Version, private readonly postEvent: PostEvent) {\n    super({ isVisible }, version, {\n      show: 'web_app_setup_back_button',\n      hide: 'web_app_setup_back_button',\n    });\n  }\n\n  private set isVisible(visible: boolean) {\n    this.set('isVisible', visible);\n    this.postEvent('web_app_setup_back_button', { is_visible: visible });\n  }\n\n  /**\n   * True if BackButton is currently visible.\n   */\n  get isVisible(): boolean {\n    return this.get('isVisible');\n  }\n\n  /**\n   * Hides the BackButton.\n   */\n  hide(): void {\n    this.isVisible = false;\n  }\n\n  /**\n   * Adds a new event listener.\n   * @param event - event to listen.\n   * @param listener - listener to add.\n   */\n  on: Emitter['on'] = (event, listener) => (\n    event === 'click'\n      ? on('back_button_pressed', listener)\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n      : this.state.on(event, listener as any)\n  );\n\n  /**\n   * Removes the event listener.\n   * @param event - event to listen.\n   * @param listener - listener to remove.\n   */\n  off: Emitter['off'] = (event, listener) => (\n    event === 'click'\n      ? off('back_button_pressed', listener)\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n      : this.state.off(event, listener as any)\n  );\n\n  /**\n   * Shows the BackButton.\n   */\n  show(): void {\n    this.isVisible = true;\n  }\n}\n","import { createValueParserGenerator } from '../createValueParserGenerator.js';\nimport { number } from './number.js';\nimport type { ValueParserGenerator } from '../createValueParserGenerator.js';\n\n/**\n * Returns parser to parse value as Date.\n */\nexport const date: ValueParserGenerator<Date> = createValueParserGenerator((value) => (\n  value instanceof Date\n    ? value\n    : new Date(number().parse(value) * 1000)\n), 'Date');\n","import { createTypeError } from '../createTypeError.js';\nimport { parseBySchema } from '../parseBySchema.js';\nimport { ValueParser } from '../ValueParser/ValueParser.js';\nimport type { Schema } from '../types.js';\n\n/**\n * Creates new search params parser according to passed schema.\n * @param schema - object schema.\n * @param type - parser type name.\n */\nexport function searchParams<T>(schema: Schema<T>, type?: string): ValueParser<T, false> {\n  return new ValueParser((value) => {\n    if (typeof value !== 'string' && !(value instanceof URLSearchParams)) {\n      throw createTypeError();\n    }\n\n    const params = typeof value === 'string' ? new URLSearchParams(value) : value;\n\n    return parseBySchema(schema, (field) => {\n      const paramValue = params.get(field);\n      return paramValue === null ? undefined : paramValue;\n    });\n  }, false, type);\n}\n","import { json } from '@/parsing/parsers/json.js';\nimport { number } from '@/parsing/parsers/number.js';\nimport { string } from '@/parsing/parsers/string.js';\n\nimport type { Chat } from '../types.js';\n\nexport const chat = json<Chat>({\n  id: number(),\n  type: string(),\n  title: string(),\n  photoUrl: {\n    type: string().optional(),\n    from: 'photo_url',\n  },\n  username: string().optional(),\n}, 'Chat')\n  .optional();\n","import { boolean } from '@/parsing/parsers/boolean.js';\nimport { json } from '@/parsing/parsers/json.js';\nimport { number } from '@/parsing/parsers/number.js';\nimport { string } from '@/parsing/parsers/string.js';\n\nimport type { User } from '../types.js';\n\nexport const user = json<User>({\n  addedToAttachmentMenu: {\n    type: boolean().optional(),\n    from: 'added_to_attachment_menu',\n  },\n  allowsWriteToPm: {\n    type: boolean().optional(),\n    from: 'allows_write_to_pm',\n  },\n  firstName: {\n    type: string(),\n    from: 'first_name',\n  },\n  id: number(),\n  isBot: {\n    type: boolean().optional(),\n    from: 'is_bot',\n  },\n  isPremium: {\n    type: boolean().optional(),\n    from: 'is_premium',\n  },\n  languageCode: {\n    type: string().optional(),\n    from: 'language_code',\n  },\n  lastName: {\n    type: string().optional(),\n    from: 'last_name',\n  },\n  photoUrl: {\n    type: string().optional(),\n    from: 'photo_url',\n  },\n  username: string().optional(),\n}, 'User')\n  .optional();\n","import { date } from '@/parsing/parsers/date.js';\nimport { number } from '@/parsing/parsers/number.js';\nimport { searchParams } from '@/parsing/parsers/searchParams.js';\nimport { string } from '@/parsing/parsers/string.js';\nimport type { ValueParser } from '@/parsing/ValueParser/ValueParser.js';\n\nimport { chat } from './chat.js';\nimport { user } from './user.js';\nimport type { InitDataParsed } from '../types.js';\n\n/**\n * Returns parser used to parse init data, presented as search params.\n */\nexport function initData(): ValueParser<InitDataParsed, false> {\n  return searchParams<InitDataParsed>({\n    authDate: {\n      type: date(),\n      from: 'auth_date',\n    },\n    canSendAfter: {\n      type: number().optional(),\n      from: 'can_send_after',\n    },\n    chat,\n    chatInstance: {\n      type: string().optional(),\n      from: 'chat_instance',\n    },\n    chatType: {\n      type: string().optional(),\n      from: 'chat_type',\n    },\n    hash: string(),\n    queryId: {\n      type: string().optional(),\n      from: 'query_id',\n    },\n    receiver: user,\n    startParam: {\n      type: string().optional(),\n      from: 'start_param',\n    },\n    user,\n  }, 'InitData');\n}\n","import { toRGB } from '@/colors/toRGB.js';\nimport type { RGB } from '@/colors/types.js';\n\nimport { createValueParserGenerator } from '../createValueParserGenerator.js';\nimport { string } from './string.js';\nimport type { ValueParserGenerator } from '../createValueParserGenerator.js';\n\n/**\n * Returns parser to parse value as RGB color.\n */\nexport const rgb: ValueParserGenerator<RGB> = createValueParserGenerator((value) => toRGB(string().parse(value)), 'rgb');\n","/**\n * Converts a palette key from the Telegram application to the representation used by the package.\n * @param key - palette key.\n */\nexport function keyToLocal(key: string): string {\n  return key.replace(/_[a-z]/g, (match) => match[1].toUpperCase());\n}\n\n/**\n * Converts palette key from the local representation to the representation sent from the\n * Telegram application.\n * @param key - palette key.\n */\nexport function keyToExternal(key: string): string {\n  return key.replace(/[A-Z]/g, (match) => `_${match.toLowerCase()}`);\n}\n","import { createValueParserGenerator, type ValueParserGenerator } from '@/parsing/createValueParserGenerator.js';\nimport { rgb } from '@/parsing/parsers/rgb.js';\nimport { toRecord } from '@/parsing/toRecord.js';\n\nimport { keyToLocal } from '../keys.js';\nimport type { ThemeParamsParsed } from '../types.js';\n\nexport const themeParams: ValueParserGenerator<ThemeParamsParsed> = createValueParserGenerator(\n  (value) => {\n    const rgbOptional = rgb().optional();\n\n    return Object\n      .entries(toRecord(value))\n      .reduce<ThemeParamsParsed>((acc, [k, v]) => {\n        acc[keyToLocal(k)] = rgbOptional.parse(v);\n        return acc;\n      }, {});\n  },\n  'ThemeParams',\n);\n","import { initData } from '@/components/InitData/parsers/initData.js';\nimport { themeParams } from '@/components/ThemeParams/parsing/themeParams.js';\nimport { boolean } from '@/parsing/parsers/boolean.js';\nimport { searchParams } from '@/parsing/parsers/searchParams.js';\nimport { string } from '@/parsing/parsers/string.js';\n\nimport type { LaunchParams } from './types.js';\n\n/**\n * Parses value as launch parameters.\n * @param value - value to parse.\n */\nexport function parseLaunchParams(value: unknown): LaunchParams {\n  return searchParams({\n    botInline: {\n      type: boolean().optional(),\n      from: 'tgWebAppBotInline',\n    },\n    initData: {\n      type: initData().optional(),\n      from: 'tgWebAppData',\n    },\n    initDataRaw: {\n      type: string().optional(),\n      from: 'tgWebAppData',\n    },\n    platform: {\n      type: string(),\n      from: 'tgWebAppPlatform',\n    },\n    showSettings: {\n      type: boolean().optional(),\n      from: 'tgWebAppShowSettings',\n    },\n    startParam: {\n      type: string().optional(),\n      from: 'tgWebAppStartParam',\n    },\n    themeParams: {\n      type: themeParams(),\n      from: 'tgWebAppThemeParams',\n    },\n    version: {\n      type: string(),\n      from: 'tgWebAppVersion',\n    },\n  }).parse(value);\n}\n","import { parseLaunchParams } from './parseLaunchParams.js';\nimport type { LaunchParams } from './types.js';\n\n/**\n * @param urlString - URL to extract launch parameters from.\n * @returns Launch parameters from the specified URL.\n * @throws Error if function was unable to extract launch parameters from the passed URL.\n */\nexport function retrieveFromUrl(urlString: string): LaunchParams {\n  return parseLaunchParams(\n    urlString\n      // Replace everything before this first hashtag or question sign.\n      .replace(/^[^?#]*[?#]/, '')\n      // Replace all hashtags and question signs to make it look like some search params.\n      .replace(/[?#]/g, '&'),\n  );\n}\n","import { retrieveFromUrl } from './retrieveFromUrl.js';\nimport type { LaunchParams } from './types.js';\n\n/**\n * @returns Launch parameters from the current window location hash.\n * @throws Error if function was unable to extract launch parameters from the window location hash.\n */\nexport function retrieveFromLocation(): LaunchParams {\n  return retrieveFromUrl(window.location.href);\n}\n","/**\n * Returns the first navigation entry from window.performance.\n * @returns First navigation entry or null, in case performance functionality is not supported\n * or navigation entry was not found.\n */\nexport function getFirstNavigationEntry(): PerformanceNavigationTiming | undefined {\n  return performance.getEntriesByType('navigation')[0] as PerformanceNavigationTiming | undefined;\n}\n","import { getFirstNavigationEntry } from '@/navigation/getFirstNavigationEntry.js';\n\nimport { retrieveFromUrl } from './retrieveFromUrl.js';\nimport type { LaunchParams } from './types.js';\n\n/**\n * @returns Launch parameters based on the first navigation entry.\n * @throws Error if function was unable to extract launch parameters from the navigation entry.\n */\nexport function retrieveFromPerformance(): LaunchParams {\n  const navigationEntry = getFirstNavigationEntry();\n  if (!navigationEntry) {\n    throw new Error('Unable to get first navigation entry.');\n  }\n\n  return retrieveFromUrl(navigationEntry.name);\n}\n","import type { BackButtonState } from '@/components/BackButton/types.js';\nimport type { BiometryManagerState } from '@/components/BiometryManager/types.js';\nimport type { ClosingBehaviorState } from '@/components/ClosingBehavior/types.js';\nimport type { MainButtonState } from '@/components/MainButton/types.js';\nimport type { MiniAppState } from '@/components/MiniApp/types.js';\nimport type { SettingsButtonState } from '@/components/SettingsButton/types.js';\nimport type { ThemeParamsParsed } from '@/components/ThemeParams/types.js';\nimport type { ViewportState } from '@/components/Viewport/types.js';\n\n/**\n * Describes storage keys and according values.\n */\nexport interface StorageParams {\n  backButton: BackButtonState;\n  biometryManager: BiometryManagerState;\n  closingBehavior: ClosingBehaviorState;\n  launchParams: string;\n  mainButton: MainButtonState;\n  miniApp: MiniAppState;\n  settingsButton: SettingsButtonState;\n  themeParams: ThemeParamsParsed;\n  viewport: ViewportState;\n}\n\n/**\n * Key which could be used to store data in the storage.\n */\nexport type StorageKey = keyof StorageParams;\n\n/**\n * Type specific to the specified storage key.\n */\nexport type StorageValue<K extends StorageKey> = StorageParams[K];\n\n/**\n * Converts passed storage key to the formatted state.\n * @param key - storage key.\n */\nfunction formatKey(key: StorageKey): string {\n  return `tma.js/${key.replace(/[A-Z]/g, (m) => `-${m.toLowerCase()}`)}`;\n}\n\n/**\n * Saves value in the storage.\n * @param key - storage key.\n * @param value - storage value.\n */\nexport function setStorageValue<K extends StorageKey>(key: K, value: StorageValue<K>): void {\n  sessionStorage.setItem(formatKey(key), JSON.stringify(value));\n}\n\n/**\n * Extracts value from the storage.\n * @param key - storage key.\n */\nexport function getStorageValue<K extends StorageKey>(key: K): StorageValue<K> | undefined {\n  const value = sessionStorage.getItem(formatKey(key));\n  try {\n    return value ? JSON.parse(value) as StorageValue<K> : undefined;\n  } catch { /* empty */ }\n}\n","import { parseLaunchParams } from '@/launch-params/parseLaunchParams.js';\nimport { getStorageValue } from '@/storage/storage.js';\nimport type { LaunchParams } from '@/launch-params/types.js';\n\n/**\n * @returns Launch parameters stored in the session storage.\n * @throws Error if function was unable to extract launch parameters from the window location hash.\n */\nexport function retrieveFromStorage(): LaunchParams {\n  return parseLaunchParams(getStorageValue('launchParams') || '');\n}\n","import { keyToExternal } from '../keys.js';\nimport type { ThemeParamsParsed } from '../types.js';\n\n/**\n * Serializes theme parameters to representation sent from the Telegram application.\n */\nexport function serializeThemeParams(themeParams: ThemeParamsParsed): string {\n  return JSON.stringify(\n    Object.fromEntries(\n      Object\n        .entries(themeParams)\n        .map(([key, value]) => [keyToExternal(key), value]),\n    ),\n  );\n}\n","import { serializeThemeParams } from '@/components/ThemeParams/parsing/serializeThemeParams.js';\n\nimport type { LaunchParams } from './types.js';\n\n/**\n * Converts launch parameters to its initial representation.\n * @param value - launch parameters.\n */\nexport function serializeLaunchParams(value: LaunchParams): string {\n  const {\n    initDataRaw,\n    themeParams,\n    platform,\n    version,\n    showSettings,\n    startParam,\n    botInline,\n  } = value;\n\n  const params = new URLSearchParams();\n\n  params.set('tgWebAppPlatform', platform);\n  params.set('tgWebAppThemeParams', serializeThemeParams(themeParams));\n  params.set('tgWebAppVersion', version);\n\n  if (initDataRaw) {\n    params.set('tgWebAppData', initDataRaw);\n  }\n\n  if (startParam) {\n    params.set('tgWebAppStartParam', startParam);\n  }\n\n  if (typeof showSettings === 'boolean') {\n    params.set('tgWebAppShowSettings', showSettings ? '1' : '0');\n  }\n\n  if (typeof botInline === 'boolean') {\n    params.set('tgWebAppBotInline', botInline ? '1' : '0');\n  }\n\n  return params.toString();\n}\n","import { setStorageValue } from '@/storage/storage.js';\n\nimport { serializeLaunchParams } from './serializeLaunchParams.js';\nimport type { LaunchParams } from './types.js';\n\n/**\n * Saves specified launch parameters in the session storage.\n * @param value - launch params to save.\n */\nexport function saveToStorage(value: LaunchParams): void {\n  setStorageValue('launchParams', serializeLaunchParams(value));\n}\n","import { retrieveFromLocation } from './retrieveFromLocation.js';\nimport { retrieveFromPerformance } from './retrieveFromPerformance.js';\nimport { retrieveFromStorage } from './retrieveFromStorage.js';\nimport { saveToStorage } from './saveToStorage.js';\nimport type { LaunchParams } from './types.js';\n\n/**\n * @returns Launch parameters from any known source.\n * @throws Error if extraction was unsuccessful.\n */\nexport function retrieveLaunchParams(): LaunchParams {\n  const errors: unknown[] = [];\n\n  for (const retrieve of [\n    // Try to retrieve launch parameters from the current location. This method can return\n    // nothing in case, location was changed and then page was reloaded.\n    retrieveFromLocation,\n    // Then, try using the lower level API - window.performance.\n    retrieveFromPerformance,\n    // Finally, try to extract launch parameters from the session storage.\n    retrieveFromStorage,\n  ]) {\n    try {\n      const lp = retrieve();\n      saveToStorage(lp);\n      return lp;\n    } catch (e) {\n      errors.push(e);\n    }\n  }\n\n  throw new Error('Unable to retrieve launch parameters from any known source.');\n}\n","import { getFirstNavigationEntry } from './getFirstNavigationEntry.js';\n\n/**\n * @returns True, if current page was reloaded.\n * @see https://stackoverflow.com/a/36444134/11894710\n */\nexport function isPageReload(): boolean {\n  const entry = getFirstNavigationEntry();\n  return !!(entry && entry.type === 'reload');\n}\n","import type { CreateRequestIdFn } from './types.js';\n\n/**\n * Creates function which generated request identifiers.\n */\nexport function createRequestIdGenerator(): CreateRequestIdFn {\n  let requestId = 0;\n  return () => (requestId += 1).toString();\n}\n","import { createPostEvent } from '@/bridge/methods/createPostEvent.js';\nimport { retrieveLaunchParams } from '@/launch-params/retrieveLaunchParams.js';\nimport { createSingleton } from '@/misc/createSingleton.js';\nimport { isPageReload } from '@/navigation/isPageReload.js';\nimport { createRequestIdGenerator } from '@/request-id/createRequestIdGenerator.js';\nimport type { StorageKey, StorageValue } from '@/storage/storage.js';\nimport { getStorageValue, setStorageValue } from '@/storage/storage.js';\nimport { createCleanup } from '@/misc/createCleanup.js';\n\nimport {\n  FactoryDynamic,\n  FactoryStatic,\n  InitStaticComponentFn,\n  InitDynamicComponentFn,\n  WithOnChange,\n} from './types.js';\n\nconst [createReqId] = createSingleton(createRequestIdGenerator);\n\n/**\n * Creates a new init function based on factory, creating a component, not synchronizing its\n * state with the session storage.\n * @param factory - function creating new component instance.\n */\nexport function createComponentInitFn<R>(factory: FactoryStatic<R>): InitStaticComponentFn<R>;\n\n/**\n * Creates a new init function based on factory, creating a component, synchronizing its\n * state with the session storage.\n * @param factory - function creating new component instance.\n * @param storageKey - storage key to restore component from.\n */\nexport function createComponentInitFn<\n  SK extends StorageKey,\n  R extends WithOnChange<StorageValue<SK>> | Promise<WithOnChange<StorageValue<SK>>>,\n>(\n  storageKey: SK,\n  factory: FactoryDynamic<R, SK>,\n): InitDynamicComponentFn<R>;\n\nexport function createComponentInitFn<\n  R extends WithOnChange<StorageValue<SK>> | Promise<WithOnChange<StorageValue<SK>>>,\n  SK extends StorageKey,\n>(\n  factoryStaticOrSK: FactoryStatic<R> | SK,\n  factoryDynamic?: FactoryDynamic<R, SK>,\n): InitStaticComponentFn<R> | InitDynamicComponentFn<R> {\n  return () => {\n    const lp = retrieveLaunchParams();\n    const factoryOptions = {\n      ...lp,\n      postEvent: createPostEvent(lp.version),\n      createRequestId: createReqId(),\n    };\n\n    // In static init mode we have no reason to use the storage to restore the state. In this\n    // case we should just call the factory.\n    if (typeof factoryStaticOrSK === 'function') {\n      return factoryStaticOrSK(factoryOptions);\n    }\n\n    // Otherwise, we create a new component instance from the storage if possible and add\n    // required change listeners.\n    const [addCleanup, cleanup, cleanedUp] = createCleanup();\n\n    const result = factoryDynamic!({\n      ...factoryOptions,\n      // State should only be passed only in case, current page was reloaded. If we don't add\n      // this check, state restoration will work improperly in the web version of Telegram,\n      // when we are always working in the same \"session\" (tab).\n      state: isPageReload() ? getStorageValue(factoryStaticOrSK) : undefined,\n      addCleanup,\n    });\n\n    const bindChange = (value: WithOnChange<StorageValue<SK>>) => {\n      if (!cleanedUp) {\n        addCleanup(\n          value.on('change', (state) => {\n            setStorageValue(factoryStaticOrSK, state);\n          }),\n        );\n      }\n      return value;\n    };\n\n    return [\n      result instanceof Promise ? result.then(bindChange) : bindChange(result),\n      cleanup,\n    ] as unknown as R;\n  };\n}\n","import { createComponentInitFn } from '@/misc/createComponentInitFn/createComponentInitFn.js';\n\nimport { BackButton } from './BackButton.js';\n\n/**\n * @returns A new initialized instance of the `BackButton` class.\n * @see BackButton\n */\nexport const initBackButton = createComponentInitFn('backButton', ({\n  postEvent,\n  version,\n  state = { isVisible: false },\n}) => new BackButton(state.isVisible, version, postEvent));\n","import { WithSupportsAndStateUtils } from '@/classes/WithSupportsAndStateUtils.js';\nimport type { StateEvents } from '@/classes/State/types.js';\nimport type { EventEmitter } from '@/events/event-emitter/EventEmitter.js';\n\ntype Emitter<StateShape extends object> = EventEmitter<StateEvents<StateShape>>;\n\nexport class WithSupportsAndTrackableState<StateShape extends object, SupportsMethod extends string>\n  extends WithSupportsAndStateUtils<StateShape, SupportsMethod> {\n  /**\n   * Adds a new event listener.\n   */\n  on: Emitter<StateShape>['on'] = this.state.on.bind(this.state);\n\n  /**\n   * Removes the event listener.\n   */\n  off: Emitter<StateShape>['off'] = this.state.off.bind(this.state);\n}\n","import type { BiometryType, MiniAppsEventPayload } from '@/bridge/events/types.js';\n\nexport interface FormatBiometryInfoResult {\n  /**\n   * Shows whether biometry is available.\n   */\n  available: boolean;\n  /**\n   * Shows whether permission to use biometrics has been requested.\n   */\n  accessRequested: boolean;\n  /**\n   * Shows whether permission to use biometrics has been granted.\n   */\n  accessGranted: boolean;\n  /**\n   * A unique device identifier that can be used to match the token to the device.\n   */\n  deviceId: string;\n  /**\n   * Show whether local storage contains previously saved token.\n   */\n  tokenSaved: boolean;\n  /**\n   * The type of biometrics currently available on the device.\n   */\n  type: BiometryType;\n}\n\n/**\n * Converts `biometry_info_received` to some common shape.\n * @param event - event payload.\n * @see biometry_info_received\n */\nexport function formatEvent(\n  event: MiniAppsEventPayload<'biometry_info_received'>,\n): FormatBiometryInfoResult {\n  const data = event.available ? event : {\n    available: false,\n    device_id: '',\n    token_saved: false,\n    access_requested: false,\n    access_granted: false,\n    type: '',\n  };\n\n  return {\n    available: true,\n    type: data.type,\n    deviceId: data.device_id,\n    tokenSaved: data.token_saved,\n    accessRequested: data.access_requested,\n    accessGranted: data.access_granted,\n  };\n}\n","import { request } from '@/bridge/request.js';\nimport { WithSupportsAndTrackableState } from '@/classes/WithSupportsAndTrackableState.js';\nimport { formatEvent } from '@/components/BiometryManager/formatEvent.js';\nimport type { BiometryType } from '@/bridge/events/types.js';\nimport type { PostEvent } from '@/bridge/methods/postEvent.js';\nimport type {\n  BiometryManagerAuthenticateOptions,\n  BiometryManagerProps,\n  BiometryManagerRequestAccessOptions,\n  BiometryManagerState,\n  BiometryManagerUpdateTokenOptions,\n} from '@/components/BiometryManager/types.js';\n\nexport class BiometryManager extends WithSupportsAndTrackableState<BiometryManagerState,\n  | 'auth'\n  | 'openSettings'\n  | 'requestAccess'\n  | 'updateToken'\n> {\n  private readonly postEvent: PostEvent;\n\n  private authPromise?: Promise<string | undefined>;\n\n  private accessPromise?: Promise<boolean>;\n\n  constructor({ postEvent, version, ...rest }: BiometryManagerProps) {\n    super(rest, version, {\n      auth: 'web_app_biometry_request_auth',\n      openSettings: 'web_app_biometry_open_settings',\n      requestAccess: 'web_app_biometry_request_access',\n      updateToken: 'web_app_biometry_update_token',\n    });\n    this.postEvent = postEvent;\n  }\n\n  /**\n   * Shows whether biometry is available.\n   */\n  get available(): boolean {\n    return this.get('available');\n  }\n\n  /**\n   * Shows whether permission to use biometrics has been granted.\n   */\n  get accessGranted(): boolean {\n    return this.get('accessGranted');\n  }\n\n  /**\n   * Shows whether if permission to use biometrics has been requested.\n   */\n  get accessRequested(): boolean {\n    return this.get('accessRequested');\n  }\n\n  /**\n   * Authenticates the user using biometrics.\n   * @param options - method options.\n   * @since 7.2\n   * @returns Token from the local secure storage, if authentication was successful.\n   */\n  async authenticate({\n    reason,\n    ...rest\n  }: BiometryManagerAuthenticateOptions): Promise<string | undefined> {\n    if (!this.authPromise) {\n      this.authPromise = request({\n        ...rest,\n        method: 'web_app_biometry_request_auth',\n        event: 'biometry_auth_requested',\n        postEvent: this.postEvent,\n        params: {\n          // TODO: Check if reason is empty works fine.\n          reason: (reason || '').trim(),\n        },\n      })\n        .then(({ token }) => token)\n        .finally(() => this.authPromise = undefined);\n    }\n    return this.authPromise;\n  }\n\n  /**\n   * A unique device identifier that can be used to match the token to the device.\n   */\n  get deviceId(): string {\n    return this.get('deviceId');\n  }\n\n  /**\n   * Opens the biometric access settings for bots. Useful when you need to request biometrics\n   * access to users who haven't granted it yet.\n   *\n   * _Note that this method can be called only in response to user interaction with the Mini App\n   * interface (e.g. a click inside the Mini App or on the main button)_.\n   * @since 7.2\n   */\n  openSettings(): void {\n    this.postEvent('web_app_biometry_open_settings');\n  }\n\n  /**\n   * Requests permission to use biometrics.\n   * @since 7.2\n   * @returns Promise with true, if access was granted.\n   */\n  requestAccess({ reason, ...rest }: BiometryManagerRequestAccessOptions = {}): Promise<boolean> {\n    if (!this.accessPromise) {\n      this.accessPromise = request({\n        ...rest,\n        postEvent: this.postEvent,\n        method: 'web_app_biometry_request_access',\n        event: 'biometry_info_received',\n        params: { reason: reason || '' },\n      })\n        .then((response) => {\n          // Actualize local state.\n          const formatted = formatEvent(response);\n          this.set(formatted);\n\n          return formatted.accessGranted;\n        })\n        .finally(() => this.accessPromise = undefined);\n    }\n    return this.accessPromise;\n  }\n\n  /**\n   * The type of biometrics currently available on the device.\n   */\n  get biometryType(): BiometryType | undefined {\n    return this.get('biometryType');\n  }\n\n  /**\n   * Shows whether token was saved previously in the local secure storage.\n   */\n  get tokenSaved(): boolean {\n    return this.get('tokenSaved');\n  }\n\n  /**\n   * Updates the biometric token in a secure storage on the device.\n   * @returns Promise with `true`, if token was updated.\n   */\n  async updateToken({ token, ...rest }: BiometryManagerUpdateTokenOptions = {}): Promise<boolean> {\n    return ['removed', 'updated'].includes(\n      (\n        await request({\n          ...rest,\n          postEvent: this.postEvent,\n          method: 'web_app_biometry_update_token',\n          event: 'biometry_token_updated',\n          params: { token: token || '' },\n        })\n      ).status,\n    );\n  }\n}\n","import { request } from '@/bridge/request.js';\nimport type { ExecuteWithOptions } from '@/types/index.js';\n\nimport { formatEvent } from './formatEvent.js';\nimport type { FormatBiometryInfoResult } from './formatEvent.js';\n\n/**\n * Requests biometry information.\n * @param options - additional execution options.\n */\nexport async function requestBiometryInfo(\n  options?: ExecuteWithOptions,\n): Promise<FormatBiometryInfoResult> {\n  return formatEvent(\n    await request({\n      ...(options || {}),\n      method: 'web_app_biometry_get_info',\n      event: 'biometry_info_received',\n    }),\n  );\n}\n","import { createComponentInitFn } from '@/misc/createComponentInitFn/createComponentInitFn.js';\nimport { supports } from '@/supports/supports.js';\n\nimport { BiometryManager } from './BiometryManager.js';\nimport { requestBiometryInfo } from './requestBiometryInfo.js';\n\n/**\n * @returns A promise with a new initialized instance of the `BiometryManager` class.\n * @see BiometryManager\n */\nexport const initBiometryManager = createComponentInitFn(\n  'biometryManager',\n  async ({ postEvent, version, state }) => {\n    return new BiometryManager({\n      ...(state || supports('web_app_biometry_get_info', version)\n        ? state || await requestBiometryInfo({ timeout: 1000 })\n        : {\n          available: false,\n          accessGranted: false,\n          accessRequested: false,\n          tokenSaved: false,\n          deviceId: '',\n        }),\n      version,\n      postEvent,\n    });\n  },\n);\n","import { WithStateUtils } from '@/classes/WithStateUtils.js';\nimport type { StateEvents } from '@/classes/State/types.js';\nimport type { EventEmitter } from '@/events/event-emitter/EventEmitter.js';\n\ntype Emitter<StateShape extends object> = EventEmitter<StateEvents<StateShape>>;\n\nexport class WithTrackableState<StateShape extends object>\n  extends WithStateUtils<StateShape> {\n  /**\n   * Adds a new event listener.\n   */\n  on: Emitter<StateShape>['on'] = this.state.on.bind(this.state);\n\n  /**\n   * Removes the event listener.\n   */\n  off: Emitter<StateShape>['off'] = this.state.off.bind(this.state);\n}\n","import { WithTrackableState } from '@/classes/WithTrackableState.js';\nimport type { PostEvent } from '@/bridge/methods/postEvent.js';\nimport type { ClosingBehaviorState } from '@/components/ClosingBehavior/types.js';\n\n/**\n * @see Usage: https://docs.telegram-mini-apps.com/platform/closing-behavior\n * @see API: https://docs.telegram-mini-apps.com/packages/tma-js-sdk/components/closing-behavior\n */\nexport class ClosingBehavior extends WithTrackableState<ClosingBehaviorState> {\n  constructor(isConfirmationNeeded: boolean, private readonly postEvent: PostEvent) {\n    super({ isConfirmationNeeded });\n  }\n\n  private set isConfirmationNeeded(value: boolean) {\n    this.set('isConfirmationNeeded', value);\n    this.postEvent('web_app_setup_closing_behavior', { need_confirmation: value });\n  }\n\n  /**\n   * True, if the confirmation dialog should be shown while the user is trying to close\n   * the Mini App.\n   */\n  get isConfirmationNeeded(): boolean {\n    return this.get('isConfirmationNeeded');\n  }\n\n  /**\n   * Disables the confirmation dialog when closing the Mini App.\n   */\n  disableConfirmation(): void {\n    this.isConfirmationNeeded = false;\n  }\n\n  /**\n   * Enables the confirmation dialog when closing the Mini App.\n   */\n  enableConfirmation(): void {\n    this.isConfirmationNeeded = true;\n  }\n}\n","import { createComponentInitFn } from '@/misc/createComponentInitFn/createComponentInitFn.js';\n\nimport { ClosingBehavior } from './ClosingBehavior.js';\n\n/**\n * @returns A new initialized instance of the `ClosingBehavior` class.\n * @see ClosingBehavior\n */\nexport const initClosingBehavior = createComponentInitFn(\n  'closingBehavior',\n  ({\n    postEvent,\n    state = { isConfirmationNeeded: false },\n  }) => new ClosingBehavior(state.isConfirmationNeeded, postEvent),\n);\n","import { createSupportsFn } from '@/supports/createSupportsFn.js';\nimport type { MiniAppsMethodName } from '@/bridge/methods/types/methods.js';\nimport type { SupportsFn } from '@/supports/types.js';\nimport type { Version } from '@/version/types.js';\n\nexport class WithSupports<SupportsMethod extends string> {\n  constructor(\n    /**\n     * Mini Apps version.\n     */\n    version: Version,\n    /**\n     * Supports method schema.\n     */\n    supportsSchema: Record<SupportsMethod, MiniAppsMethodName>,\n  ) {\n    this.supports = createSupportsFn(version, supportsSchema);\n  }\n\n  /**\n   * @returns True, if specified method is supported by the current component.\n   */\n  supports: SupportsFn<SupportsMethod>;\n}\n","import { createTypeError } from '../createTypeError.js';\nimport { ValueParser } from '../ValueParser/ValueParser.js';\nimport type { ArrayParserOfResult } from '../ArrayParser/types.js';\nimport type { AnyParser, Parser } from '../types.js';\nimport type { ValueParserParseResult } from '../ValueParser/types.js';\n\n/**\n * Parses incoming value as array.\n * @param value - value to parse.\n */\nfunction parseArray(value: unknown): unknown[] {\n  if (Array.isArray(value)) {\n    return value;\n  }\n\n  if (typeof value === 'string') {\n    try {\n      const json = JSON.parse(value);\n\n      if (Array.isArray(json)) {\n        return json;\n      }\n    } catch {}\n  }\n  throw createTypeError();\n}\n\nexport class ArrayParser<ItemType, IsOptional extends boolean>\n  extends ValueParser<unknown[], IsOptional> {\n  private itemParser: Parser<any>;\n\n  constructor(\n    itemParser: AnyParser<ItemType>,\n    isOptional: IsOptional,\n    type?: string,\n  ) {\n    super(parseArray, isOptional, type);\n\n    this.itemParser = typeof itemParser === 'function'\n      ? itemParser\n      : itemParser.parse.bind(itemParser);\n  }\n\n  /**\n   * Attempts to parse passed value\n   * @param value - value to parse.\n   * @throws {SDKError} ERR_PARSE\n   * @see ERR_PARSE\n   */\n  override parse(value: unknown): ValueParserParseResult<ItemType[], IsOptional> {\n    const arr = super.parse(value);\n    return arr === undefined ? arr : arr.map(this.itemParser);\n  }\n\n  of<Item>(itemParser: AnyParser<Item>): ArrayParserOfResult<this, Item, IsOptional> {\n    this.itemParser = typeof itemParser === 'function'\n      ? itemParser\n      : itemParser.parse.bind(itemParser);\n\n    return this as ArrayParserOfResult<this, Item, IsOptional>;\n  }\n}\n","import { ArrayParser } from '@/parsing/ArrayParser/ArrayParser.js';\n\n/**\n * Parses incoming value as an array.\n * @param parserTypeName - parser type name.\n */\nexport function array(parserTypeName?: string): ArrayParser<unknown, false> {\n  return new ArrayParser((value) => value, false, parserTypeName);\n}\n","import { invokeCustomMethod } from '@/bridge/invokeCustomMethod.js';\nimport { WithSupports } from '@/classes/WithSupports.js';\nimport { array } from '@/parsing/parsers/array.js';\nimport { json } from '@/parsing/parsers/json.js';\nimport { string } from '@/parsing/parsers/string.js';\nimport type { PostEvent } from '@/bridge/methods/postEvent.js';\nimport type { CreateRequestIdFn } from '@/request-id/types.js';\nimport type { ExecuteWithTimeout } from '@/types/methods.js';\nimport type { Version } from '@/version/types.js';\n\nfunction objectFromKeys<K extends string, V>(keys: K[], value: V): Record<K, V> {\n  return Object.fromEntries(keys.map((k) => [k, value])) as Record<K, V>;\n}\n\n// TODO: Usage.\n\n/**\n * @see API: https://docs.telegram-mini-apps.com/packages/tma-js-sdk/components/cloud-storage\n */\nexport class CloudStorage extends WithSupports<'delete' | 'get' | 'getKeys' | 'set'> {\n  constructor(\n    version: Version,\n    private readonly createRequestId: CreateRequestIdFn,\n    private readonly postEvent: PostEvent,\n  ) {\n    super(version, {\n      delete: 'web_app_invoke_custom_method',\n      get: 'web_app_invoke_custom_method',\n      getKeys: 'web_app_invoke_custom_method',\n      set: 'web_app_invoke_custom_method',\n    });\n  }\n\n  /**\n   * Deletes specified key or keys from the cloud storage.\n   * @param keyOrKeys - key or keys to delete.\n   * @param options - request execution options.\n   */\n  async delete(keyOrKeys: string | string[], options: ExecuteWithTimeout = {}): Promise<void> {\n    const keys = Array.isArray(keyOrKeys) ? keyOrKeys : [keyOrKeys];\n    if (keys.length) {\n      await invokeCustomMethod(\n        'deleteStorageValues',\n        { keys },\n        this.createRequestId(),\n        { ...options, postEvent: this.postEvent },\n      );\n    }\n  }\n\n  /**\n   * Returns list of all keys presented in the cloud storage.\n   * @param options - request execution options.\n   */\n  async getKeys(options: ExecuteWithTimeout = {}): Promise<string[]> {\n    return array().of(string()).parse(\n      await invokeCustomMethod(\n        'getStorageKeys',\n        {},\n        this.createRequestId(),\n        { ...options, postEvent: this.postEvent },\n      ),\n    );\n  }\n\n  /**\n   * Returns map, where key is one of the specified in keys argument, and value is according\n   * storage value.\n   * @param keys - keys list.\n   * @param options - request execution options.\n   */\n  get<K extends string>(keys: K[], options?: ExecuteWithTimeout): Promise<Record<K, string>>;\n\n  /**\n   * Returns value of the specified key.\n   * @param key - cloud storage key.\n   * @param options - request execution options.\n   * @return Value of the specified key. In case, key was not created previously, function\n   * will return empty string.\n   */\n  get(key: string, options?: ExecuteWithTimeout): Promise<string>;\n\n  async get(\n    keyOrKeys: string | string[],\n    options: ExecuteWithTimeout = {},\n  ): Promise<string | Record<string, string>> {\n    const keys = Array.isArray(keyOrKeys) ? keyOrKeys : [keyOrKeys];\n    if (!keys.length) {\n      return objectFromKeys(keys, '');\n    }\n\n    const data = await invokeCustomMethod(\n      'getStorageValues',\n      { keys },\n      this.createRequestId(),\n      { ...options, postEvent: this.postEvent },\n    );\n    const result = json(objectFromKeys(keys, string()), 'CloudStorageData').parse(data);\n\n    return Array.isArray(keyOrKeys) ? result : result[keyOrKeys];\n  }\n\n  /**\n   * Saves specified value by key.\n   * @param key - storage key.\n   * @param value - storage value.\n   * @param options - request execution options.\n   */\n  async set(key: string, value: string, options: ExecuteWithTimeout = {}): Promise<void> {\n    await invokeCustomMethod(\n      'saveStorageValue',\n      { key, value },\n      this.createRequestId(),\n      { ...options, postEvent: this.postEvent },\n    );\n  }\n}\n","import { createComponentInitFn } from '@/misc/createComponentInitFn/createComponentInitFn.js';\n\nimport { CloudStorage } from './CloudStorage.js';\n\n/**\n * @returns A new initialized instance of the `CloudStorage` class.\n * @see CloudStorage\n */\nexport const initCloudStorage = createComponentInitFn(\n  ({ createRequestId, postEvent, version }) => {\n    return new CloudStorage(version, createRequestId, postEvent);\n  },\n);\n","import { WithSupports } from '@/classes/WithSupports.js';\nimport type { PostEvent } from '@/bridge/methods/postEvent.js';\nimport type {\n  ImpactHapticFeedbackStyle,\n  NotificationHapticFeedbackType,\n} from '@/bridge/methods/types/haptic.js';\nimport type { Version } from '@/version/types.js';\n\n/**\n * @see Usage: https://docs.telegram-mini-apps.com/platform/haptic-feedback\n * @see API: https://docs.telegram-mini-apps.com/packages/tma-js-sdk/components/haptic-feedback\n */\nexport class HapticFeedback\n  extends WithSupports<'impactOccurred' | 'notificationOccurred' | 'selectionChanged'> {\n  constructor(version: Version, private readonly postEvent: PostEvent) {\n    super(version, {\n      impactOccurred: 'web_app_trigger_haptic_feedback',\n      notificationOccurred: 'web_app_trigger_haptic_feedback',\n      selectionChanged: 'web_app_trigger_haptic_feedback',\n    });\n  }\n\n  /**\n   * A method tells that an impact occurred. The Telegram app may play the\n   * appropriate haptics based on style value passed.\n   * @param style - impact style.\n   */\n  impactOccurred(style: ImpactHapticFeedbackStyle): void {\n    this.postEvent('web_app_trigger_haptic_feedback', {\n      type: 'impact',\n      impact_style: style,\n    });\n  }\n\n  /**\n   * A method tells that a task or action has succeeded, failed, or produced\n   * a warning. The Telegram app may play the appropriate haptics based on\n   * type value passed.\n   * @param type - notification type.\n   */\n  notificationOccurred(type: NotificationHapticFeedbackType): void {\n    this.postEvent('web_app_trigger_haptic_feedback', {\n      type: 'notification',\n      notification_type: type,\n    });\n  }\n\n  /**\n   * A method tells that the user has changed a selection. The Telegram app\n   * may play the appropriate haptics.\n   *\n   * Do not use this feedback when the user makes or confirms a selection;\n   * use it only when the selection changes.\n   */\n  selectionChanged(): void {\n    this.postEvent('web_app_trigger_haptic_feedback', { type: 'selection_change' });\n  }\n}\n","import { createComponentInitFn } from '@/misc/createComponentInitFn/createComponentInitFn.js';\n\nimport { HapticFeedback } from './HapticFeedback.js';\n\n/**\n * @returns A new initialized instance of the `HapticFeedback` class.\n * @see HapticFeedback\n */\nexport const initHapticFeedback = createComponentInitFn(\n  ({ version, postEvent }) => new HapticFeedback(version, postEvent),\n);\n","import type {\n  Chat,\n  ChatType,\n  InitDataParsed,\n  User,\n} from './types.js';\n\n/**\n * @see Usage: https://docs.telegram-mini-apps.com/platform/init-data\n * @see API: https://docs.telegram-mini-apps.com/packages/tma-js-sdk/init-data\n */\nexport class InitData {\n  constructor(private readonly initData: InitDataParsed) {\n  }\n\n  /**\n   * @see InitDataParsed.authDate\n   */\n  get authDate(): Date {\n    return this.initData.authDate;\n  }\n\n  /**\n   * @see InitDataParsed.canSendAfter\n   */\n  get canSendAfter(): number | undefined {\n    return this.initData.canSendAfter;\n  }\n\n  /**\n   * Date after which it is allowed to call\n   * the [answerWebAppQuery](https://core.telegram.org/bots/api#answerwebappquery) method.\n   */\n  get canSendAfterDate(): Date | undefined {\n    const { canSendAfter } = this;\n\n    return canSendAfter\n      ? new Date(this.authDate.getTime() + canSendAfter * 1000)\n      : undefined;\n  }\n\n  /**\n   * @see InitDataParsed.chat\n   */\n  get chat(): Chat | undefined {\n    return this.initData.chat;\n  }\n\n  /**\n   * @see InitDataParsed.chatType\n   */\n  get chatType(): ChatType | undefined {\n    return this.initData.chatType;\n  }\n\n  /**\n   * @see InitDataParsed.chatInstance\n   */\n  get chatInstance(): string | undefined {\n    return this.initData.chatInstance;\n  }\n\n  /**\n   * @see InitDataParsed.hash\n   */\n  get hash(): string {\n    return this.initData.hash;\n  }\n\n  /**\n   * @see InitDataParsed.queryId\n   */\n  get queryId(): string | undefined {\n    return this.initData.queryId;\n  }\n\n  /**\n   * @see InitDataParsed.receiver\n   */\n  get receiver(): User | undefined {\n    return this.initData.receiver;\n  }\n\n  /**\n   * @see InitDataParsed.startParam\n   */\n  get startParam(): string | undefined {\n    return this.initData.startParam;\n  }\n\n  /**\n   * @see InitDataParsed.user\n   */\n  get user(): User | undefined {\n    return this.initData.user;\n  }\n}\n","import { createComponentInitFn } from '@/misc/createComponentInitFn/createComponentInitFn.js';\n\nimport { InitData } from './InitData.js';\n\n/**\n * @returns A new initialized instance of the `InitData` class or undefined.\n * @see InitData\n */\nexport const initInitData = createComponentInitFn(\n  ({ initData }) => (initData ? new InitData(initData) : undefined),\n);\n","import { initData } from './parsers/initData.js';\nimport type { InitDataParsed } from './types.js';\n\n/**\n * Parses incoming value as init data.\n * @param value - value to parse.\n */\nexport function parseInitData(value: unknown): InitDataParsed {\n  return initData().parse(value);\n}\n","import { request } from '@/bridge/request.js';\nimport { WithSupportsAndTrackableState } from '@/classes/WithSupportsAndTrackableState.js';\nimport type { InvoiceStatus } from '@/bridge/events/types.js';\nimport type { PostEvent } from '@/bridge/methods/postEvent.js';\nimport type { Version } from '@/version/types.js';\n\nimport type { InvoiceState } from './types.js';\n\n// TODO: Usage.\n\n/**\n * @see API: https://docs.telegram-mini-apps.com/packages/tma-js-sdk/components/invoice\n */\nexport class Invoice extends WithSupportsAndTrackableState<InvoiceState, 'open'> {\n  constructor(\n    isOpened: boolean,\n    version: Version,\n    private readonly postEvent: PostEvent,\n  ) {\n    super({ isOpened }, version, { open: 'web_app_open_invoice' });\n  }\n\n  private set isOpened(value) {\n    this.set('isOpened', value);\n  }\n\n  /**\n   * True if invoice is currently opened.\n   */\n  get isOpened(): boolean {\n    return this.get('isOpened');\n  }\n\n  /**\n   * Opens an invoice using its slug.\n   * @param slug - invoice slug.\n   * @throws {Error} Invoice is already opened.\n   */\n  open(slug: string): Promise<InvoiceStatus>;\n\n  /**\n   * Opens an invoice using its url. It expects passing link in full format, with hostname \"t.me\".\n   * @param url - invoice URL.\n   * @param type - value type.\n   * @throws {Error} Invoice is already opened.\n   */\n  open(url: string, type: 'url'): Promise<InvoiceStatus>;\n\n  async open(urlOrSlug: string, type?: 'url'): Promise<InvoiceStatus> {\n    if (this.isOpened) {\n      throw new Error('Invoice is already opened');\n    }\n\n    let slug: string;\n    if (!type) {\n      slug = urlOrSlug;\n    } else {\n      const { hostname, pathname } = new URL(urlOrSlug, window.location.href);\n      if (hostname !== 't.me') {\n        throw new Error(`Incorrect hostname: ${hostname}`);\n      }\n\n      // Valid examples:\n      // \"/invoice/my-slug\"\n      // \"/$my-slug\"\n      const match = pathname.match(/^\\/(\\$|invoice\\/)([A-Za-z0-9\\-_=]+)$/);\n      if (!match) {\n        throw new Error('Link pathname has incorrect format. Expected to receive \"/invoice/{slug}\" or \"/${slug}\"');\n      }\n      [, , slug] = match;\n    }\n\n    this.isOpened = true;\n\n    try {\n      const result = await request({\n        method: 'web_app_open_invoice',\n        event: 'invoice_closed',\n        params: { slug },\n        postEvent: this.postEvent,\n        capture(data) {\n          return slug === data.slug;\n        },\n      });\n\n      return result.status;\n    } finally {\n      this.isOpened = false;\n    }\n  }\n}\n","import { createComponentInitFn } from '@/misc/createComponentInitFn/createComponentInitFn.js';\n\nimport { Invoice } from './Invoice.js';\n\n/**\n * @returns A new initialized instance of the `Invoice` class.\n * @see Invoice\n */\nexport const initInvoice = createComponentInitFn(\n  ({ version, postEvent }) => new Invoice(false, version, postEvent),\n);\n","import { off } from '@/bridge/events/listening/off.js';\nimport { on } from '@/bridge/events/listening/on.js';\nimport { WithStateUtils } from '@/classes/WithStateUtils.js';\nimport type { PostEvent } from '@/bridge/methods/postEvent.js';\nimport type { RGB } from '@/colors/types.js';\nimport type {\n  MainButtonEvents,\n  MainButtonParams,\n  MainButtonProps,\n  MainButtonState,\n} from '@/components/MainButton/types.js';\nimport type { EventEmitter } from '@/events/event-emitter/EventEmitter.js';\n\ntype Emitter = EventEmitter<MainButtonEvents>;\n\n/**\n * @see Usage: https://docs.telegram-mini-apps.com/platform/main-button\n * @see API: https://docs.telegram-mini-apps.com/packages/tma-js-sdk/components/main-button\n */\nexport class MainButton extends WithStateUtils<MainButtonState> {\n  private readonly postEvent: PostEvent;\n\n  constructor({ postEvent, ...rest }: MainButtonProps) {\n    super(rest);\n    this.postEvent = postEvent;\n  }\n\n  /**\n   * The MainButton background color.\n   */\n  get bgColor(): RGB {\n    return this.get('bgColor');\n  }\n\n  /**\n   * Sends current local state to the Telegram application.\n   */\n  private commit(): void {\n    // We should not commit changes until payload is correct. We could\n    // have some invalid values in case, button instance was created\n    // with empty values. Otherwise, an unexpected behavior could be received.\n    if (this.text === '') {\n      return;\n    }\n\n    this.postEvent('web_app_setup_main_button', {\n      is_visible: this.isVisible,\n      is_active: this.isEnabled,\n      is_progress_visible: this.isLoaderVisible,\n      text: this.text,\n      color: this.bgColor,\n      text_color: this.textColor,\n    });\n  }\n\n  /**\n   * Disables the MainButton.\n   * @see Does not work on Android: https://github.com/Telegram-Mini-Apps/issues/issues/1\n   */\n  disable(): this {\n    this.isEnabled = false;\n    return this;\n  }\n\n  /**\n   * Enables the MainButton.\n   */\n  enable(): this {\n    this.isEnabled = true;\n    return this;\n  }\n\n  /**\n   * Hides the MainButton.\n   */\n  hide(): this {\n    this.isVisible = false;\n    return this;\n  }\n\n  /**\n   * Hides the MainButton loading indicator.\n   */\n  hideLoader(): this {\n    this.isLoaderVisible = false;\n    return this;\n  }\n\n  private set isEnabled(isEnabled: boolean) {\n    this.setParams({ isEnabled });\n  }\n\n  /**\n   * True if the MainButton is enabled.\n   */\n  get isEnabled(): boolean {\n    return this.get('isEnabled');\n  }\n\n  private set isLoaderVisible(isLoaderVisible: boolean) {\n    this.setParams({ isLoaderVisible });\n  }\n\n  /**\n   * True if the MainButton loader is visible.\n   */\n  get isLoaderVisible(): boolean {\n    return this.get('isLoaderVisible');\n  }\n\n  private set isVisible(isVisible: boolean) {\n    this.setParams({ isVisible });\n  }\n\n  /**\n   * True if the MainButton is visible.\n   */\n  get isVisible(): boolean {\n    return this.get('isVisible');\n  }\n\n  /**\n   * Adds a new event listener.\n   * @param event - event to listen.\n   * @param listener - listener to add.\n   */\n  on: Emitter['on'] = (event, listener) => (\n    event === 'click'\n      ? on('main_button_pressed', listener)\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n      : this.state.on(event, listener as any)\n  );\n\n  /**\n   * Removes the event listener.\n   * @param event - event to listen.\n   * @param listener - listener to remove.\n   */\n  off: Emitter['off'] = (event, listener) => (\n    event === 'click'\n      ? off('main_button_pressed', listener)\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n      : this.state.off(event, listener as any)\n  );\n\n  /**\n   * Shows the MainButton.\n   *\n   * Note that opening the Mini App from the attachment menu hides the main button until the\n   * user interacts with the Mini App interface.\n   */\n  show(): this {\n    this.isVisible = true;\n    return this;\n  }\n\n  /**\n   * Shows a loading indicator on the Main Button.\n   */\n  showLoader(): this {\n    this.isLoaderVisible = true;\n    return this;\n  }\n\n  /**\n   * Sets a new MainButton text. Minimal length for the text is 1 symbol, and maximum is 64 symbols.\n   * @param text - a new text.\n   */\n  setText(text: string): this {\n    return this.setParams({ text });\n  }\n\n  /**\n   * Sets a new Main Button text color.\n   * @param textColor - new text color.\n   */\n  setTextColor(textColor: RGB): this {\n    return this.setParams({ textColor });\n  }\n\n  /**\n   * Updates current Main Button color.\n   * @param bgColor - color to set.\n   */\n  setBgColor(bgColor: RGB): this {\n    return this.setParams({ bgColor });\n  }\n\n  /**\n   * Allows setting multiple Main Button parameters.\n   * @param params - Main Button parameters.\n   */\n  setParams(params: Partial<MainButtonParams>): this {\n    this.set(params);\n    this.commit();\n    return this;\n  }\n\n  /**\n   * The MainButton text.\n   */\n  get text(): string {\n    return this.get('text');\n  }\n\n  /**\n   * The MainButton text color.\n   */\n  get textColor(): RGB {\n    return this.get('textColor');\n  }\n}\n","import { createComponentInitFn } from '@/misc/createComponentInitFn/createComponentInitFn.js';\n\nimport { MainButton } from './MainButton.js';\n\n/**\n * @returns A new initialized instance of the `MainButton` class.\n * @see MainButton\n */\nexport const initMainButton = createComponentInitFn(\n  'mainButton',\n  ({\n    postEvent,\n    themeParams,\n    state = {\n      isVisible: false,\n      isEnabled: false,\n      text: '',\n      isLoaderVisible: false,\n      textColor: themeParams.buttonTextColor || '#ffffff',\n      bgColor: themeParams.buttonColor || '#000000',\n    },\n  }) => new MainButton({ ...state, postEvent }),\n);\n","import { date } from '@/parsing/parsers/date.js';\nimport { json } from '@/parsing/parsers/json.js';\nimport { number } from '@/parsing/parsers/number.js';\nimport { searchParams } from '@/parsing/parsers/searchParams.js';\nimport { string } from '@/parsing/parsers/string.js';\nimport type { ValueParser } from '@/parsing/ValueParser/ValueParser.js';\n\nimport type { RequestedContact } from '../types.js';\n\n/**\n * Returns function which parses incoming value as a contact information.\n */\nexport function contact(): ValueParser<RequestedContact, false> {\n  return searchParams({\n    contact: json({\n      userId: {\n        type: number(),\n        from: 'user_id',\n      },\n      phoneNumber: {\n        type: string(),\n        from: 'phone_number',\n      },\n      firstName: {\n        type: string(),\n        from: 'first_name',\n      },\n      lastName: {\n        type: string().optional(),\n        from: 'last_name',\n      },\n    }),\n    authDate: {\n      type: date(),\n      from: 'auth_date',\n    },\n    hash: string(),\n  }, 'RequestedContact');\n}\n","import { supports } from '@/supports/supports.js';\nimport type {\n  MiniAppsMethodVersionedParams,\n  MiniAppsMethodWithVersionedParams,\n} from '@/bridge/methods/types/methods.js';\nimport type { SupportsFn } from '@/supports/types.js';\nimport type { Version } from '@/version/types.js';\n\ntype HasCheckSupportMethodTuple = {\n  [M in MiniAppsMethodWithVersionedParams]: [M, MiniAppsMethodVersionedParams<M>]\n}[MiniAppsMethodWithVersionedParams];\n\n/**\n * Returns function, which accepts predefined method name and checks if it is supported\n * via passed schema and version.\n * @param schema - object which contains methods names and TWA methods with specified parameter\n * as a dependency.\n * @param version - platform version.\n */\nexport function createSupportsParamFn<Method extends string>(\n  version: Version,\n  schema: Record<Method, HasCheckSupportMethodTuple>,\n): SupportsFn<Method> {\n  return (method) => {\n    const [tmaMethod, param] = schema[method];\n\n    return supports(tmaMethod, param, version);\n  };\n}\n","/**\n * Awaits for specified amount of time.\n * @param duration - duration in ms to await.\n */\nexport function sleep(duration: number): Promise<void> {\n  return new Promise((res) => {\n    setTimeout(res, duration);\n  });\n}\n","import { invokeCustomMethod } from '@/bridge/invokeCustomMethod.js';\nimport { request } from '@/bridge/request.js';\nimport { WithSupportsAndTrackableState } from '@/classes/WithSupportsAndTrackableState.js';\nimport { isColorDark } from '@/colors/isColorDark.js';\nimport { isRGB } from '@/colors/isRGB.js';\nimport { contact } from '@/components/MiniApp/parsing/contact.js';\nimport { createSupportsParamFn } from '@/supports/createSupportsParamFn.js';\nimport { createTimeoutError } from '@/timeout/createTimeoutError.js';\nimport { sleep } from '@/timeout/sleep.js';\nimport { withTimeout } from '@/timeout/withTimeout.js';\nimport type { PhoneRequestedStatus, WriteAccessRequestedStatus } from '@/bridge/events/types.js';\nimport type { PostEvent } from '@/bridge/methods/postEvent.js';\nimport type { SwitchInlineQueryChatType } from '@/bridge/methods/types/methods.js';\nimport type { RGB } from '@/colors/types.js';\nimport type {\n  MiniAppHeaderColor,\n  MiniAppProps,\n  MiniAppState,\n  RequestedContact,\n} from '@/components/MiniApp/types.js';\nimport type { CreateRequestIdFn } from '@/request-id/types.js';\nimport type { SupportsFn } from '@/supports/types.js';\nimport type { ExecuteWithTimeout } from '@/types/methods.js';\n\n/**\n * Provides common Mini Apps functionality not covered by other system components.\n */\nexport class MiniApp extends WithSupportsAndTrackableState<\n  MiniAppState,\n  | 'requestPhoneAccess'\n  | 'requestWriteAccess'\n  | 'switchInlineQuery'\n  | 'setHeaderColor'\n  | 'setBackgroundColor'\n> {\n  private readonly botInline: boolean;\n\n  private readonly postEvent: PostEvent;\n\n  private readonly createRequestId: CreateRequestIdFn;\n\n  private requestPhoneAccessPromise: Promise<PhoneRequestedStatus> | undefined;\n\n  private requestWriteAccessPromise: Promise<WriteAccessRequestedStatus> | undefined;\n\n  constructor({ postEvent, createRequestId, version, botInline, ...rest }: MiniAppProps) {\n    super(rest, version, {\n      requestPhoneAccess: 'web_app_request_phone',\n      requestWriteAccess: 'web_app_request_write_access',\n      switchInlineQuery: 'web_app_switch_inline_query',\n      setHeaderColor: 'web_app_set_header_color',\n      setBackgroundColor: 'web_app_set_background_color',\n    });\n\n    this.createRequestId = createRequestId;\n    this.postEvent = postEvent;\n    this.botInline = botInline;\n\n    const supportsOriginal = this.supports.bind(this);\n    this.supports = (method) => {\n      if (!supportsOriginal(method)) {\n        return false;\n      }\n\n      // web_app_switch_inline_query requires a Mini App to be in inline mode, that's why we\n      // add 1 more check here.\n      return method !== 'switchInlineQuery' || botInline;\n    };\n\n    this.supportsParam = createSupportsParamFn(version, {\n      'setHeaderColor.color': ['web_app_set_header_color', 'color'],\n    });\n  }\n\n  /**\n   * Attempts to get requested contact.\n   * @param timeout - request timeout.\n   */\n  private async getRequestedContact({\n    timeout = 10000,\n  }: ExecuteWithTimeout = {}): Promise<RequestedContact> {\n    return contact().parse(\n      await invokeCustomMethod(\n        'getRequestedContact',\n        {},\n        this.createRequestId(),\n        { postEvent: this.postEvent, timeout },\n      ),\n    );\n  }\n\n  /**\n   * The Mini App background color.\n   * @example \"#ffaabb\"\n   */\n  get bgColor(): RGB {\n    return this.get('bgColor');\n  }\n\n  /**\n   * Closes the Mini App.\n   * @param returnBack - should the application be wrapped into the bottom bar.\n   */\n  close(returnBack?: boolean): void {\n    this.postEvent('web_app_close', { return_back: returnBack });\n  }\n\n  /**\n   * The Mini App header color.\n   * @example \"#ffaabb\"\n   * @example \"bg_color\"\n   */\n  get headerColor(): MiniAppHeaderColor {\n    return this.get('headerColor');\n  }\n\n  /**\n   * True if the Mini App is currently launched in bot inline mode.\n   */\n  get isBotInline(): boolean {\n    return this.botInline;\n  }\n\n  /**\n   * True if the current Mini App background color is recognized as dark.\n   */\n  get isDark(): boolean {\n    return isColorDark(this.bgColor);\n  }\n\n  /**\n   * Informs the Telegram app that the Mini App is ready to be displayed.\n   *\n   * It is recommended to call this method as early as possible, as soon as all essential\n   * interface elements loaded. Once this method called, the loading placeholder is hidden\n   * and the Mini App shown.\n   *\n   * If the method not called, the placeholder will be hidden only when the page fully loaded.\n   */\n  ready(): void {\n    this.postEvent('web_app_ready');\n  }\n\n  /**\n   * Requests current user contact information. In contrary to requestPhoneAccess, this method\n   * returns promise with contact information that rejects in case, user denied access, or request\n   * failed.\n   * @param options - additional options.\n   */\n  async requestContact({ timeout = 5000 }: ExecuteWithTimeout = {}): Promise<RequestedContact> {\n    // First of all, let's try to get the requested contact. Probably, we already requested\n    // it before.\n    try {\n      return await this.getRequestedContact();\n    } catch { /* empty */\n    }\n\n    // Then, request access to user's phone.\n    const status = await this.requestPhoneAccess();\n    if (status !== 'sent') {\n      throw new Error('Access denied.');\n    }\n\n    // Expected deadline.\n    const deadlineAt = Date.now() + timeout;\n\n    // Time to wait before executing the next request.\n    let sleepTime = 50;\n\n    // We are trying to retrieve the requested contact until deadline was reached.\n    return withTimeout(async () => {\n      while (Date.now() < deadlineAt) {\n        try {\n          return await this.getRequestedContact();\n        } catch {}\n\n        // Sleep for some time.\n        await sleep(sleepTime);\n\n        // Increase the sleep time not to kill the backend service.\n        sleepTime += 50;\n      }\n\n      throw createTimeoutError(timeout);\n    }, timeout);\n  }\n\n  /**\n   * Requests current user phone access. Method returns promise, which resolves\n   * status of the request. In case, user accepted the request, Mini App bot will receive\n   * the according notification.\n   *\n   * To obtain the retrieved information instead, utilize the `requestContact` method.\n   * @param options - additional options.\n   * @see requestContact\n   */\n  async requestPhoneAccess(options: ExecuteWithTimeout = {}): Promise<PhoneRequestedStatus> {\n    if (!this.requestPhoneAccessPromise) {\n      this.requestPhoneAccessPromise = request({\n        ...options,\n        method: 'web_app_request_phone',\n        event: 'phone_requested',\n        postEvent: this.postEvent,\n      })\n        .then(({ status }) => status)\n        .finally(() => this.requestPhoneAccessPromise = undefined);\n    }\n    return this.requestPhoneAccessPromise;\n  }\n\n  /**\n   * Requests write message access to current user.\n   * @param options - additional options.\n   */\n  async requestWriteAccess(options: ExecuteWithTimeout = {}): Promise<WriteAccessRequestedStatus> {\n    if (!this.requestWriteAccessPromise) {\n      this.requestWriteAccessPromise = request({\n        ...options,\n        method: 'web_app_request_write_access',\n        event: 'write_access_requested',\n        postEvent: this.postEvent,\n      })\n        .then(({ status }) => status)\n        .finally(() => this.requestWriteAccessPromise = undefined);\n    }\n    return this.requestWriteAccessPromise;\n  }\n\n  /**\n   * A method used to send data to the bot. When this method called, a service message sent to\n   * the bot containing the data of the length up to 4096 bytes, and the Mini App closed. See the\n   * field `web_app_data` in the class [Message](https://core.telegram.org/bots/api#message).\n   *\n   * This method is only available for Mini Apps launched via a Keyboard button.\n   * @param data - data to send to bot.\n   * @throws {Error} data has incorrect size.\n   */\n  sendData(data: string): void {\n    const { size } = new Blob([data]);\n    if (!size || size > 4096) {\n      throw new Error(`Passed data has incorrect size: ${size}`);\n    }\n    this.postEvent('web_app_data_send', { data });\n  }\n\n  /**\n   * Updates current Mini App header color.\n   *\n   * @see No effect on desktop: https://github.com/Telegram-Mini-Apps/tma.js/issues/9\n   * @see Works incorrectly in Android: https://github.com/Telegram-Mini-Apps/tma.js/issues/8\n   * @param color - color key or RGB color.\n   */\n  setHeaderColor(color: MiniAppHeaderColor): void {\n    this.postEvent('web_app_set_header_color', isRGB(color) ? { color } : { color_key: color });\n    this.set('headerColor', color);\n  }\n\n  /**\n   * Updates current Mini App background color.\n   *\n   * @see No effect on desktop: https://github.com/Telegram-Mini-Apps/tma.js/issues/9\n   * @see Works incorrectly in Android: https://github.com/Telegram-Mini-Apps/tma.js/issues/8\n   * @param color - RGB color.\n   */\n  setBgColor(color: RGB): void {\n    this.postEvent('web_app_set_background_color', { color });\n    this.set('bgColor', color);\n  }\n\n  /**\n   * Checks if specified method parameter is supported by current component.\n   */\n  supportsParam: SupportsFn<'setHeaderColor.color'>;\n\n  /**\n   * Inserts the bot's username and the specified inline query in the current chat's input field.\n   * Query may be empty, in which case only the bot's username will be inserted. The client prompts\n   * the user to choose a specific chat, then opens that chat and inserts the bot's username and\n   * the specified inline query in the input field.\n   * @param text - text which should be inserted in the input after the current bot name. Max\n   * length is 256 symbols.\n   * @param chatTypes - List of chat types which could be chosen to send the message. Could be\n   * empty list.\n   */\n  switchInlineQuery(text: string, chatTypes: SwitchInlineQueryChatType[] = []): void {\n    if (!this.supports('switchInlineQuery') && !this.isBotInline) {\n      throw new Error('Method is unsupported because Mini App should be launched in inline mode.');\n    }\n    this.postEvent('web_app_switch_inline_query', { query: text, chat_types: chatTypes });\n  }\n}\n","import { createComponentInitFn } from '@/misc/createComponentInitFn/createComponentInitFn.js';\n\nimport { MiniApp } from './MiniApp.js';\n\n/**\n * @returns A new initialized instance of the `MiniApp` class.\n * @see MiniApp\n */\nexport const initMiniApp = createComponentInitFn(\n  'miniApp',\n  ({\n    themeParams,\n    botInline = false,\n    state = {\n      bgColor: themeParams.bgColor || '#ffffff',\n      headerColor: themeParams.headerBgColor || '#000000',\n    },\n    ...rest\n  }) => new MiniApp({ ...rest, ...state, botInline }),\n);\n","import type { PopupButton, PopupParams as BridgePopupParams } from '@/bridge/methods/types/popup.js';\n\nimport type { OpenPopupOptions } from './types.js';\n\n/**\n * Prepares popup parameters before sending them to native app.\n * @param params - popup parameters.\n */\nexport function preparePopupParams(params: OpenPopupOptions): BridgePopupParams {\n  const message = params.message.trim();\n  const title = (params.title || '').trim();\n  const buttons = params.buttons || [];\n  let preparedButtons: PopupButton[];\n\n  // Check title.\n  if (title.length > 64) {\n    throw new Error(`Title has incorrect size: ${title.length}`);\n  }\n\n  // Check message.\n  if (!message.length || message.length > 256) {\n    throw new Error(`Message has incorrect size: ${message.length}`);\n  }\n\n  // Check buttons.\n  if (buttons.length > 3) {\n    throw new Error(`Buttons have incorrect size: ${buttons.length}`);\n  }\n\n  // Append button in case, there are no buttons passed.\n  if (!buttons.length) {\n    preparedButtons = [{ type: 'close', id: '' }];\n  } else {\n    // Otherwise, check all the buttons.\n    preparedButtons = buttons.map((b) => {\n      const { id = '' } = b;\n\n      // Check button ID.\n      if (id.length > 64) {\n        throw new Error(`Button ID has incorrect size: ${id}`);\n      }\n\n      if (!b.type || b.type === 'default' || b.type === 'destructive') {\n        const text = b.text.trim();\n\n        if (!text.length || text.length > 64) {\n          const type = b.type || 'default';\n\n          throw new Error(`Button text with type \"${type}\" has incorrect size: ${b.text.length}`);\n        }\n\n        return { ...b, text, id };\n      }\n\n      return { ...b, id };\n    });\n  }\n  return { title, message, buttons: preparedButtons };\n}\n","import { request } from '@/bridge/request.js';\nimport { WithSupportsAndTrackableState } from '@/classes/WithSupportsAndTrackableState.js';\nimport { preparePopupParams } from '@/components/Popup/preparePopupParams.js';\nimport type { PostEvent } from '@/bridge/methods/postEvent.js';\nimport type { OpenPopupOptions, PopupState } from '@/components/Popup/types.js';\nimport type { Version } from '@/version/types.js';\n\n/**\n * @see Usage: https://docs.telegram-mini-apps.com/platform/popup\n * @see API: https://docs.telegram-mini-apps.com/packages/tma-js-sdk/components/popup\n */\nexport class Popup extends WithSupportsAndTrackableState<PopupState, 'open'> {\n  constructor(isOpened: boolean, version: Version, private readonly postEvent: PostEvent) {\n    super({ isOpened }, version, { open: 'web_app_open_popup' });\n  }\n\n  private set isOpened(value) {\n    this.set('isOpened', value);\n  }\n\n  /**\n   * True if the Popup is opened.\n   */\n  get isOpened(): boolean {\n    return this.get('isOpened');\n  }\n\n  /**\n   * A method that shows a native popup described by the `params` argument.\n   * Promise will be resolved when popup is closed. Resolved value will have\n   * an identifier of pressed button.\n   *\n   * In case, user clicked outside the popup or clicked top right popup close\n   * button, null will be returned.\n   *\n   * @param options - popup parameters.\n   * @throws {Error} Popup is already opened.\n   */\n  async open(options: OpenPopupOptions): Promise<string | null> {\n    if (this.isOpened) {\n      throw new Error('Popup is already opened.');\n    }\n\n    this.isOpened = true;\n\n    try {\n      const { button_id: buttonId = null } = await request({\n        event: 'popup_closed',\n        method: 'web_app_open_popup',\n        postEvent: this.postEvent,\n        params: preparePopupParams(options),\n      });\n      return buttonId;\n    } finally {\n      this.isOpened = false;\n    }\n  }\n}\n","import { createComponentInitFn } from '@/misc/createComponentInitFn/createComponentInitFn.js';\n\nimport { Popup } from './Popup.js';\n\n/**\n * @returns A new initialized instance of the `Popup` class.\n * @see Popup\n */\nexport const initPopup = createComponentInitFn(\n  ({ postEvent, version }) => new Popup(false, version, postEvent),\n);\n","import { request } from '@/bridge/request.js';\nimport { WithSupportsAndTrackableState } from '@/classes/WithSupportsAndTrackableState.js';\nimport type { PostEvent } from '@/bridge/methods/postEvent.js';\nimport type { Version } from '@/version/types.js';\n\nimport { QRScannerOpenOptions, QRScannerState } from './types.js';\n\n// TODO: Usage\n\n/**\n * @see API: https://docs.telegram-mini-apps.com/packages/tma-js-sdk/components/qr-scanner\n */\nexport class QRScanner extends WithSupportsAndTrackableState<QRScannerState, 'close' | 'open'> {\n  constructor(isOpened: boolean, version: Version, private readonly postEvent: PostEvent) {\n    super({ isOpened }, version, {\n      close: 'web_app_close_scan_qr_popup',\n      open: 'web_app_open_scan_qr_popup',\n    });\n  }\n\n  /**\n   * Closes the scanner.\n   */\n  close(): void {\n    this.postEvent('web_app_close_scan_qr_popup');\n    this.isOpened = false;\n  }\n\n  private set isOpened(value) {\n    this.set('isOpened', value);\n  }\n\n  /**\n   * Returns true if the scanner is currently opened.\n   */\n  get isOpened(): boolean {\n    return this.get('isOpened');\n  }\n\n  /**\n   * Opens the scanner with the specified title shown to user.\n   * The method returns a promise with a scanned QR content and null if the scanner was closed.\n   * @param options - method options.\n   */\n  async open(options?: QRScannerOpenOptions): Promise<string | null>;\n  /**\n   * Opens the scanner with the specified title shown to user.\n   * The method returns a promise with a scanned QR content and null if the scanner was closed.\n   * @param text - title to display.\n   */\n  async open(text?: string): Promise<string | null>;\n  async open(textOrOptions?: QRScannerOpenOptions | string): Promise<string | null> {\n    if (this.isOpened) {\n      throw new Error('The scanner is already opened');\n    }\n\n    const { text, capture }: QRScannerOpenOptions = (\n      typeof textOrOptions === 'string'\n        ? { text: textOrOptions }\n        : textOrOptions\n    ) || {};\n    this.isOpened = true;\n\n    try {\n      const result = await request({\n        method: 'web_app_open_scan_qr_popup',\n        event: ['qr_text_received', 'scan_qr_popup_closed'],\n        postEvent: this.postEvent,\n        params: { text },\n        capture(ev) {\n          return ev.event === 'scan_qr_popup_closed' || !capture || capture(ev.payload);\n        },\n      }) || {};\n\n      const qr = result.data || null;\n      if (qr) {\n        this.close();\n      }\n      return qr;\n    } finally {\n      this.isOpened = false;\n    }\n  }\n\n  // TODO: Streaming mode, allowing to scan several QRs until closed.\n}\n","import { createComponentInitFn } from '@/misc/createComponentInitFn/createComponentInitFn.js';\n\nimport { QRScanner } from './QRScanner.js';\n\n/**\n * @returns A new initialized instance of the `QRScanner` class.\n * @see QRScanner\n */\nexport const initQRScanner = createComponentInitFn(\n  ({ version, postEvent }) => new QRScanner(false, version, postEvent),\n);\n","import { off } from '@/bridge/events/listening/off.js';\nimport { on } from '@/bridge/events/listening/on.js';\nimport { WithSupportsAndStateUtils } from '@/classes/WithSupportsAndStateUtils.js';\nimport type { PostEvent } from '@/bridge/methods/postEvent.js';\nimport type {\n  SettingsButtonEvents,\n  SettingsButtonState,\n} from '@/components/SettingsButton/types.js';\nimport type { EventEmitter } from '@/events/event-emitter/EventEmitter.js';\nimport type { Version } from '@/version/types.js';\n\ntype Emitter = EventEmitter<SettingsButtonEvents>;\n\nexport class SettingsButton extends WithSupportsAndStateUtils<SettingsButtonState, 'show' | 'hide'> {\n  constructor(isVisible: boolean, version: Version, private readonly postEvent: PostEvent) {\n    super({ isVisible }, version, {\n      show: 'web_app_setup_settings_button',\n      hide: 'web_app_setup_settings_button',\n    });\n  }\n\n  private set isVisible(visible: boolean) {\n    this.set('isVisible', visible);\n    this.postEvent('web_app_setup_settings_button', { is_visible: visible });\n  }\n\n  /**\n   * True if the SettingsButton is visible.\n   */\n  get isVisible(): boolean {\n    return this.get('isVisible');\n  }\n\n  /**\n   * Hides the SettingsButton.\n   */\n  hide(): void {\n    this.isVisible = false;\n  }\n\n  /**\n   * Adds a new event listener.\n   * @param event - event to listen.\n   * @param listener - listener to add.\n   */\n  on: Emitter['on'] = (event, listener) => (\n    event === 'click'\n      ? on('settings_button_pressed', listener)\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n      : this.state.on(event, listener as any)\n  );\n\n  /**\n   * Removes the event listener.\n   * @param event - event to listen.\n   * @param listener - listener to remove.\n   */\n  off: Emitter['off'] = (event, listener) => (\n    event === 'click'\n      ? off('settings_button_pressed', listener)\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n      : this.state.off(event, listener as any)\n  );\n\n  /**\n   * Shows the SettingsButton.\n   */\n  show(): void {\n    this.isVisible = true;\n  }\n}\n","import { createComponentInitFn } from '@/misc/createComponentInitFn/createComponentInitFn.js';\n\nimport { SettingsButton } from './SettingsButton.js';\n\n/**\n * @returns A new initialized instance of the `SettingsButton` class.\n * @see SettingsButton\n */\nexport const initSettingsButton = createComponentInitFn(\n  'settingsButton',\n  ({\n    version,\n    postEvent,\n    state = { isVisible: false },\n  }) => new SettingsButton(state.isVisible, version, postEvent),\n);\n","import { themeParams } from '@/components/ThemeParams/parsing/themeParams.js';\n\nimport type { ThemeParamsParsed } from '../types.js';\n\n/**\n * Parses incoming value as theme parameters.\n * @param value - value to parse.\n */\nexport function parseThemeParams(value: unknown): ThemeParamsParsed {\n  return themeParams().parse(value);\n}\n","import { on } from '@/bridge/events/listening/on.js';\nimport { WithTrackableState } from '@/classes/WithTrackableState.js';\nimport { isColorDark } from '@/colors/isColorDark.js';\nimport type { RGB } from '@/colors/types.js';\nimport type { RemoveEventListenerFn } from '@/events/types.js';\n\nimport { parseThemeParams } from './parsing/parseThemeParams.js';\nimport type { ThemeParamsParsed, ThemeParamsState } from './types.js';\n\n/**\n * @see Usage: https://docs.telegram-mini-apps.com/platform/theming\n * @see API: https://docs.telegram-mini-apps.com/packages/tma-js-sdk/components/theme-params\n */\nexport class ThemeParams extends WithTrackableState<ThemeParamsState> {\n  /**\n   * @since v6.10\n   */\n  get accentTextColor(): RGB | undefined {\n    return this.get('accentTextColor');\n  }\n\n  get bgColor(): RGB | undefined {\n    return this.get('bgColor');\n  }\n\n  get buttonColor(): RGB | undefined {\n    return this.get('buttonColor');\n  }\n\n  get buttonTextColor(): RGB | undefined {\n    return this.get('buttonTextColor');\n  }\n\n  get destructiveTextColor(): RGB | undefined {\n    return this.get('destructiveTextColor');\n  }\n\n  /**\n   * Returns the copy of the internal state of the current component instance.\n   */\n  getState(): ThemeParamsParsed {\n    return this.clone();\n  }\n\n  /**\n   * @since v6.10\n   */\n  get headerBgColor(): RGB | undefined {\n    return this.get('headerBgColor');\n  }\n\n  get hintColor(): RGB | undefined {\n    return this.get('hintColor');\n  }\n\n  /**\n   * @returns True in case, current color scheme is recognized as dark. This\n   * value is calculated according to theme bg color.\n   */\n  get isDark(): boolean {\n    return !this.bgColor || isColorDark(this.bgColor);\n  }\n\n  get linkColor(): RGB | undefined {\n    return this.get('linkColor');\n  }\n\n  get secondaryBgColor(): RGB | undefined {\n    return this.get('secondaryBgColor');\n  }\n\n  /**\n   * @since v6.10\n   */\n  get sectionBgColor(): RGB | undefined {\n    return this.get('sectionBgColor');\n  }\n\n  /**\n   * @since v6.10\n   */\n  get sectionHeaderTextColor(): RGB | undefined {\n    return this.get('sectionHeaderTextColor');\n  }\n\n  /**\n   * @since v7.6\n   */\n  get sectionSeparatorColor(): RGB | undefined {\n    return this.get('sectionHeaderTextColor');\n  }\n\n  /**\n   * Starts listening to the external theme changes and applies them.\n   * @returns Function to stop listening.\n   */\n  listen(): RemoveEventListenerFn {\n    return on('theme_changed', (event) => {\n      this.set(parseThemeParams(event.theme_params));\n    });\n  }\n\n  /**\n   * @since v6.10\n   */\n  get subtitleTextColor(): RGB | undefined {\n    return this.get('subtitleTextColor');\n  }\n\n  get textColor(): RGB | undefined {\n    return this.get('textColor');\n  }\n}\n","import { ThemeParams } from '@/components/ThemeParams/ThemeParams.js';\nimport { createComponentInitFn } from '@/misc/createComponentInitFn/createComponentInitFn.js';\n\n/**\n * @returns A new initialized instance of the `ThemeParams` class.\n * @see ThemeParams\n */\nexport const initThemeParams = createComponentInitFn(\n  'themeParams',\n  ({ themeParams, state = themeParams, addCleanup }) => {\n    const tp = new ThemeParams(state);\n    addCleanup(tp.listen());\n    return tp;\n  },\n);\n","import { request } from '@/bridge/request.js';\nimport type { ExecuteWithOptions } from '@/types/index.js';\n\nimport { parseThemeParams } from './parsing/parseThemeParams.js';\nimport type { ThemeParamsParsed } from './types.js';\n\n/**\n * Requests current theme parameters from the Telegram application.\n * @param options - request options.\n */\nexport function requestThemeParams(options: ExecuteWithOptions = {}): Promise<ThemeParamsParsed> {\n  return request({\n    ...options,\n    method: 'web_app_request_theme',\n    event: 'theme_changed',\n  }).then(parseThemeParams);\n}\n","/**\n * Ensures, that specified value starts with the specified prefix. If it doesn't, function appends\n * prefix.\n * @param value - value to check.\n * @param prefix - prefix to add.\n */\nexport function ensurePrefix(value: string, prefix: string): string {\n  return value.startsWith(prefix) ? value : `${prefix}${value}`;\n}\n","import { ensurePrefix } from '@/navigation/ensurePrefix.js';\nimport type { URLLike } from '@/navigation/BrowserNavigator/types.js';\n\n/**\n * Safely creates new instance of URL with some predefined protocol and hostname.\n * @param urlOrPath - URL instance or path.\n */\nexport function createSafeURL(urlOrPath: string | Partial<URLLike>): URL {\n  return new URL(\n    typeof urlOrPath === 'string'\n      ? urlOrPath\n      : `${urlOrPath.pathname || ''}${ensurePrefix(urlOrPath.search || '', '?')}${ensurePrefix(urlOrPath.hash || '', '#')}`,\n    'http://a',\n  );\n}\n","import { captureSameReq } from '@/bridge/captureSameReq.js';\nimport { request } from '@/bridge/request.js';\nimport { WithSupports } from '@/classes/WithSupports.js';\nimport { createSupportsParamFn } from '@/supports/createSupportsParamFn.js';\nimport { supports } from '@/supports/supports.js';\nimport { createSafeURL } from '@/navigation/createSafeURL.js';\nimport type { PostEvent } from '@/bridge/methods/postEvent.js';\nimport type { CreateRequestIdFn } from '@/request-id/types.js';\nimport type { SupportsFn } from '@/supports/types.js';\nimport type { Version } from '@/version/types.js';\n\nexport interface UtilsOpenLinkOptions {\n  /**\n   * Attempts to use the instant view mode.\n   */\n  tryInstantView?: boolean;\n  /**\n   * Attempts to use user preferred browser.\n   */\n  tryBrowser?: boolean;\n}\n\n/**\n * @see API: https://docs.telegram-mini-apps.com/packages/tma-js-sdk/components/utils\n */\nexport class Utils extends WithSupports<'readTextFromClipboard'> {\n  constructor(\n    private readonly version: Version,\n    private readonly createRequestId: CreateRequestIdFn,\n    private readonly postEvent: PostEvent,\n  ) {\n    super(version, { readTextFromClipboard: 'web_app_read_text_from_clipboard' });\n\n    this.supportsParam = createSupportsParamFn(version, {\n      'openLink.tryInstantView': ['web_app_open_link', 'try_instant_view'],\n    });\n  }\n\n  /**\n   * Opens a link.\n   *\n   * The Mini App will not be closed.\n   *\n   * Note that this method can be called only in response to the user\n   * interaction with the Mini App interface (e.g. click inside the Mini App or on the main button).\n   * @param url - URL to be opened.\n   * @param options - additional options.\n   */\n  openLink(url: string, options?: UtilsOpenLinkOptions): void;\n\n  /**\n   * Opens a link.\n   *\n   * The Mini App will not be closed.\n   *\n   * Note that this method can be called only in response to the user\n   * interaction with the Mini App interface (e.g. click inside the Mini App or on the main button).\n   * @param url - URL to be opened.\n   * @param tryInstantView - try to use the instant view.\n   * @deprecated Use the second argument as an object.\n   */\n  openLink(url: string, tryInstantView?: boolean): void\n\n  openLink(url: string, instantOrOptions?: boolean | UtilsOpenLinkOptions): void {\n    const formattedUrl = createSafeURL(url).toString();\n\n    // If the method is not supported, we are doing it in legacy way.\n    if (!supports('web_app_open_link', this.version)) {\n      window.open(formattedUrl, '_blank');\n      return;\n    }\n\n    const options: UtilsOpenLinkOptions = typeof instantOrOptions === 'boolean'\n      ? { tryInstantView: instantOrOptions }\n      : instantOrOptions || {};\n\n    // Otherwise, do it normally.\n    this.postEvent('web_app_open_link', {\n      url: formattedUrl,\n      try_browser: options.tryBrowser,\n      try_instant_view: options.tryInstantView,\n    });\n  }\n\n  /**\n   * Opens a Telegram link inside Telegram app. The Mini App will be closed. It expects passing\n   * link in full format, with hostname \"t.me\".\n   * @param url - URL to be opened.\n   * @throws {Error} URL has not allowed hostname.\n   */\n  openTelegramLink(url: string): void {\n    const { hostname, pathname, search } = new URL(url, 'https://t.me');\n    if (hostname !== 't.me') {\n      throw new Error(`URL has not allowed hostname: ${hostname}. Only \"t.me\" is allowed`);\n    }\n\n    if (!supports('web_app_open_tg_link', this.version)) {\n      window.location.href = url;\n      return;\n    }\n\n    this.postEvent('web_app_open_tg_link', { path_full: pathname + search });\n  }\n\n  /**\n   * Reads text from clipboard and returns string or null. null is returned\n   * in cases:\n   * - Value in clipboard is not text\n   * - Access to clipboard is not allowed\n   */\n  async readTextFromClipboard(): Promise<string | null> {\n    const reqId = this.createRequestId();\n    const {\n      data = null,\n    } = await request({\n      method: 'web_app_read_text_from_clipboard',\n      event: 'clipboard_text_received',\n      postEvent: this.postEvent,\n      params: { req_id: reqId },\n      capture: captureSameReq(reqId),\n    });\n\n    return data;\n  }\n\n  /**\n   * Shares specified URL with the passed to the chats, selected by user. After being called,\n   * it closes the mini application.\n   *\n   * This method uses Telegram's Share Links.\n   * @param url - URL to share.\n   * @param text - text to append after the URL.\n   * @see https://core.telegram.org/api/links#share-links\n   * @see https://core.telegram.org/widgets/share#custom-buttons\n   */\n  shareURL(url: string, text?: string): void {\n    this.openTelegramLink(\n      `https://t.me/share/url?` + new URLSearchParams({ url, text: text || '' })\n        .toString()\n        // By default, URL search params encode spaces with \"+\".\n        // We are replacing them with \"%20\", because plus symbols are working incorrectly\n        // in Telegram.\n        .replace(/\\+/g, '%20'),\n    );\n  }\n\n  /**\n   * Checks if specified method parameter is supported by current component.\n   */\n  supportsParam: SupportsFn<'openLink.tryInstantView'>;\n}\n","import { Utils } from '@/components/Utils/Utils.js';\nimport { createComponentInitFn } from '@/misc/createComponentInitFn/createComponentInitFn.js';\n\n/**\n * @returns A new initialized instance of the `Utils` class.\n * @see Utils\n */\nexport const initUtils = createComponentInitFn(\n  ({ version, postEvent, createRequestId }) => {\n    return new Utils(version, createRequestId, postEvent);\n  },\n);\n","import { request } from '@/bridge/request.js';\nimport type { ExecuteWithOptions } from '@/types/index.js';\n\nexport interface RequestViewportResult {\n  height: number;\n  isStateStable: boolean;\n  isExpanded: boolean;\n  width: number;\n}\n\n/**\n * Requests viewport actual information from the Telegram application.\n * @param options - request options.\n */\nexport async function requestViewport(\n  options: ExecuteWithOptions = {},\n): Promise<RequestViewportResult> {\n  const {\n    is_expanded: isExpanded,\n    is_state_stable: isStateStable,\n    ...rest\n  } = await request({\n    ...options,\n    method: 'web_app_request_viewport',\n    event: 'viewport_changed',\n  });\n\n  return { ...rest, isExpanded, isStateStable };\n}\n","import { on } from '@/bridge/events/listening/on.js';\nimport { WithTrackableState } from '@/classes/WithTrackableState.js';\nimport type { PostEvent } from '@/bridge/methods/postEvent.js';\nimport type { RemoveEventListenerFn } from '@/events/types.js';\nimport type { ExecuteWithOptions } from '@/types/index.js';\n\nimport { requestViewport } from './requestViewport.js';\nimport type { ViewportProps, ViewportState } from './types.js';\n\n/**\n * Formats value to make it stay in bounds [0, +Inf).\n * @param value - value to format.\n */\nfunction truncate(value: number): number {\n  return value < 0 ? 0 : value;\n}\n\n/**\n * @see Usage: https://docs.telegram-mini-apps.com/platform/viewport\n * @see API: https://docs.telegram-mini-apps.com/packages/tma-js-sdk/components/viewport\n */\nexport class Viewport extends WithTrackableState<ViewportState> {\n  private readonly postEvent: PostEvent;\n\n  constructor({ postEvent, stableHeight, height, width, isExpanded }: ViewportProps) {\n    super({\n      height: truncate(height),\n      isExpanded,\n      stableHeight: truncate(stableHeight),\n      width: truncate(width),\n    });\n    this.postEvent = postEvent;\n  }\n\n  /**\n   * Requests viewport information from the Telegram application and updates current Viewport\n   * instance.\n   * @param options - options to request fresh data.\n   */\n  async sync(options?: ExecuteWithOptions): Promise<void> {\n    const { isStateStable, ...rest } = await requestViewport(options);\n    this.set({\n      ...rest,\n      stableHeight: isStateStable ? rest.height : this.get('stableHeight'),\n    });\n  }\n\n  /**\n   * The current height of the **visible area** of the Mini App.\n   *\n   * The application can display just the top part of the Mini App, with its lower part remaining\n   * outside the screen area. From this position, the user can \"pull\" the Mini App to its\n   * maximum height, while the bot can do the same by calling `expand` method. As the position of\n   * the Mini App changes, the current height value of the visible area will be updated  in real\n   * time.\n   *\n   * Please note that the refresh rate of this value is not sufficient to smoothly follow the\n   * lower border of the window. It should not be used to pin interface elements to the bottom\n   * of the visible area. It's more appropriate to use the value of the `stableHeight`\n   * field for this purpose.\n   *\n   * @see stableHeight\n   */\n  get height(): number {\n    return this.get('height');\n  }\n\n  /**\n   * The height of the visible area of the Mini App in its last stable state.\n   *\n   * The application can display just the top part of the Mini App, with its lower part remaining\n   * outside the screen area. From this position, the user can \"pull\" the Mini App to its\n   * maximum height, while the application can do the same by calling `expand` method.\n   *\n   * Unlike the value of `height`, the value of `stableHeight` does not change as the position\n   * of the Mini App changes with user gestures or during animations. The value of `stableHeight`\n   * will be updated after all gestures and animations are completed and\n   * the Mini App reaches its final size.\n   *\n   * @see height\n   */\n  get stableHeight(): number {\n    return this.get('stableHeight');\n  }\n\n  /**\n   * Starts listening to viewport changes and applies them.\n   * @returns Function to stop listening.\n   */\n  listen(): RemoveEventListenerFn {\n    return on('viewport_changed', (event) => {\n      const {\n        height,\n        width,\n        is_expanded: isExpanded,\n        is_state_stable: isStateStable,\n      } = event;\n      const truncatedHeight = truncate(height);\n\n      this.set({\n        height: truncatedHeight,\n        isExpanded,\n        width: truncate(width),\n        ...(isStateStable ? { stableHeight: truncatedHeight } : {}),\n      });\n    });\n  }\n\n  /**\n   * True if the Mini App is expanded to the maximum available height. Otherwise, if\n   * the Mini App occupies part of the screen and can be expanded to the full height using\n   * `expand` method.\n   * @see expand\n   */\n  get isExpanded(): boolean {\n    return this.get('isExpanded');\n  }\n\n  /**\n   * Current visible area width.\n   */\n  get width(): number {\n    return this.get('width');\n  }\n\n  /**\n   * A method that expands the Mini App to the maximum available height. To find out if the Mini\n   * App is expanded to the maximum height, refer to the value of the `isExpanded`.\n   * @see isExpanded\n   */\n  expand(): void {\n    this.postEvent('web_app_expand');\n    this.set('isExpanded', true);\n  }\n\n  /**\n   * True if the current viewport height is stable and is not going to change in the next moment.\n   */\n  get isStable(): boolean {\n    return this.stableHeight === this.height;\n  }\n}\n","import { createComponentInitFn } from '@/misc/createComponentInitFn/createComponentInitFn.js';\n\nimport { Viewport } from './Viewport.js';\nimport { requestViewport } from '@/components/Viewport/requestViewport.js';\n\n/**\n * @returns A promise with a new initialized instance of the `Viewport` class.\n * @see Viewport\n */\nexport const initViewport = createComponentInitFn(\n  'viewport',\n  async ({ state, platform, postEvent, addCleanup }) => {\n    let isExpanded = false;\n    let height = 0;\n    let width = 0;\n    let stableHeight = 0;\n\n    // State was saved previously, we restore the Viewport from this state.\n    if (state) {\n      isExpanded = state.isExpanded;\n      height = state.height;\n      width = state.width;\n      stableHeight = state.stableHeight;\n    } else if (['macos', 'tdesktop', 'unigram', 'webk', 'weba', 'web'].includes(platform)) {\n      // If platform has a stable viewport, it means we could instantiate Viewport using\n      // the window global object properties.\n      isExpanded = true;\n      height = window.innerHeight;\n      width = window.innerWidth;\n      stableHeight = window.innerHeight;\n    } else {\n      // We were unable to retrieve data locally. In this case we are sending a request returning\n      // a viewport information.\n      const response = await requestViewport({ timeout: 1000, postEvent });\n      isExpanded = response.isExpanded;\n      height = response.height;\n      width = response.width;\n      stableHeight = response.isStateStable ? height : 0;\n    }\n\n    // Otherwise, Viewport instance will be created using zero values.\n    const viewport = new Viewport({\n      postEvent,\n      height,\n      width,\n      stableHeight,\n      isExpanded,\n    });\n\n    // Listen to the viewport external changes and actualize local instance.\n    addCleanup(viewport.listen());\n\n    return viewport;\n  },\n);\n","/**\n * Sets CSS variable globally.\n * @param name - variable name.\n * @param value - variable value.\n */\nexport function setCSSVar(name: string, value: string): void {\n  document.documentElement.style.setProperty(name, value);\n}\n","import { isRGB } from '@/colors/isRGB.js';\nimport { setCSSVar } from '@/css-vars/setCSSVar.js';\nimport type { ThemeParams } from '@/components/ThemeParams/ThemeParams.js';\nimport type { MiniApp } from '@/components/MiniApp/MiniApp.js';\nimport type { CleanupFn } from '@/types/index.js';\n\nexport interface GetMiniAppCSSVarNameFn {\n  /**\n   * @param property - MiniApp property.\n   * @returns Computed complete CSS variable name.\n   */\n  (property: 'bg' | 'header'): string;\n}\n\n/**\n * Creates CSS variables connected with the MiniApps class instance background and header colors\n * based on the passed MiniApp and ThemeParams instances.\n *\n * Created variables by default:\n * - `--tg-bg-color`\n * - `--tg-header-color`\n *\n * Variables are being automatically updated in case, corresponding MiniApp and ThemeParams\n * properties were updated.\n *\n * @param miniApp - MiniApp instance.\n * @param themeParams - ThemeParams instance.\n * @param getVarName - function, returning complete CSS variable name for the specified\n * MiniApp property.\n * @returns Function to stop updating variables.\n */\nexport function bindMiniAppCSSVars(\n  miniApp: MiniApp,\n  themeParams: ThemeParams,\n  getVarName?: GetMiniAppCSSVarNameFn,\n): CleanupFn {\n  getVarName ||= (property) => `--tg-${property}-color`;\n\n  const headerVar = getVarName('header');\n  const bgVar = getVarName('bg');\n\n  const actualize = () => {\n    const { headerColor } = miniApp;\n\n    if (isRGB(headerColor)) {\n      setCSSVar(headerVar, headerColor);\n    } else {\n      const { bgColor, secondaryBgColor } = themeParams;\n\n      if (headerColor === 'bg_color' && bgColor) {\n        setCSSVar(headerVar, bgColor);\n      } else if (headerColor === 'secondary_bg_color' && secondaryBgColor) {\n        setCSSVar(headerVar, secondaryBgColor);\n      }\n    }\n\n    setCSSVar(bgVar, miniApp.bgColor)\n  };\n\n  const listeners = [\n    themeParams.on('change', actualize),\n    miniApp.on('change', actualize),\n  ];\n\n  actualize();\n\n  return () => listeners.forEach(off => off());\n}\n","import { setCSSVar } from '@/css-vars/setCSSVar.js';\nimport type { ThemeParams } from '@/components/ThemeParams/ThemeParams.js';\nimport type { CleanupFn } from '@/types/index.js';\n\nexport interface GetThemeParamsCSSVarNameFn {\n  /**\n   * @param property - ThemeParams property.\n   * @returns Computed complete CSS variable name.\n   */\n  (property: string): string;\n}\n\n/**\n * Creates CSS variables connected with the passed instance of the ThemeParams class.\n *\n * By default, created CSS variables names are following the pattern \"--tg-theme-{name}\", where\n * {name} is a theme parameters key name converted from camel case to kebab case.\n *\n * Example:\n * --tg-theme-bg-color\n * --tg-theme-secondary-text-color\n *\n * Variables are being automatically updated in case, corresponding properties updated in\n * the passed ThemeParams instance.\n *\n * @param themeParams - ThemeParams instance.\n * @param getCSSVarName - function, returning complete CSS variable name for the specified\n * ThemeParams property.\n * @returns Function to stop updating variables.\n */\nexport function bindThemeParamsCSSVars(\n  themeParams: ThemeParams,\n  getCSSVarName?: GetThemeParamsCSSVarNameFn,\n): CleanupFn {\n  getCSSVarName ||= (property) => {\n    return `--tg-theme-${property.replace(/[A-Z]/g, (m) => `-${m.toLowerCase()}`)}`;\n  };\n\n  const actualize = () => {\n    Object.entries(themeParams.getState()).forEach(([k, v]) => {\n      if (v) {\n        setCSSVar(getCSSVarName(k), v);\n      }\n    });\n  };\n\n  actualize();\n\n  return themeParams.on('change', actualize);\n}\n","import { setCSSVar } from '@/css-vars/setCSSVar.js';\nimport type { Viewport } from '@/components/Viewport/Viewport.js';\nimport type { CleanupFn } from '@/types/index.js';\n\nexport interface GetViewportCSSVarNameFn {\n  /**\n   * @param property - Viewport property.\n   * @returns Computed complete CSS variable name.\n   */\n  (property: 'width' | 'height' | 'stable-height'): string;\n}\n\n/**\n * Accepts Viewport instance and sets CSS variables connected with viewport\n * sizes.\n *\n * Be careful using this function as long as it can impact application\n * performance. Viewport size is changing rather often, this makes CSS\n * variables update, which leads to possible layout redraw.\n *\n * Variables:\n * - `--tg-viewport-height`\n * - `--tg-viewport-width`\n * - `--tg-viewport-stable-height`\n *\n * Variables are being automatically updated in case, corresponding properties\n * updated in passed Viewport instance.\n *\n * @param viewport - Viewport instance.\n * @param getCSSVarName - function, returning complete CSS variable name for the specified\n * Viewport property.\n * @returns Function to stop updating variables.\n */\nexport function bindViewportCSSVars(\n  viewport: Viewport,\n  getCSSVarName?: GetViewportCSSVarNameFn,\n): CleanupFn {\n  getCSSVarName ||= (property) => `--tg-viewport-${property}`;\n  const [\n    heightVar,\n    widthVar,\n    stableHeightVar,\n  ] = (['height', 'width', 'stable-height'] as const).map((prop) => getCSSVarName(prop));\n  const setHeight = () => setCSSVar(heightVar, `${viewport.height}px`);\n  const setWidth = () => setCSSVar(widthVar, `${viewport.width}px`);\n  const setStableHeight = () => setCSSVar(stableHeightVar, `${viewport.stableHeight}px`);\n\n  // TODO: Should probably add debounce or throttle.\n  const listeners = [\n    viewport.on('change:height', setHeight),\n    viewport.on('change:width', setWidth),\n    viewport.on('change:stableHeight', setStableHeight),\n  ];\n\n  setHeight();\n  setWidth();\n  setStableHeight();\n\n  return () => listeners.forEach(off => off());\n}\n","import { on } from '@/bridge/events/listening/on.js';\nimport { postEvent } from '@/bridge/methods/postEvent.js';\n\ninterface CleanupFn {\n  (): void;\n}\n\n/**\n * Performs initialization process in the web version of Telegram.\n * @returns Function, which performs cleanup removing all created elements and listeners.\n * @param acceptCustomStyles - true if SDK should accept styles sent from the Telegram web\n * application. This option is only used in web versions of Telegram. Default: false.\n */\nexport function initWeb(acceptCustomStyles = true): CleanupFn {\n  const listeners: CleanupFn[] = [\n    on('reload_iframe', () => {\n      postEvent('iframe_will_reload');\n      window.location.reload();\n    }),\n  ];\n  const cleanup: CleanupFn = () => listeners.forEach((l) => l());\n\n  if (acceptCustomStyles) {\n    const style = document.createElement('style');\n    style.id = 'telegram-custom-styles';\n    document.head.appendChild(style);\n\n    listeners.push(\n      on('set_custom_style', (html) => {\n        // It is safe to use innerHTML here as long as style tag has a special behavior related\n        // to the specified content. In case, any script will be passed here, it will not be\n        // executed.\n        style.innerHTML = html;\n      }),\n      () => document.head.removeChild(style),\n    );\n  }\n\n  // Notify Telegram, iframe is ready. This will result in sending style tag html from native\n  // application which is used in catchCustomStyles function. We should call this method also\n  // to start receiving \"reload_iframe\" events from the Telegram application.\n  postEvent('iframe_ready', { reload_supported: true });\n\n  return cleanup;\n}\n","/**\n * @returns True, if current environment is server.\n */\nexport function isSSR(): boolean {\n  return typeof window === 'undefined';\n}\n","import { request } from '@/bridge/request.js';\nimport { hasWebviewProxy } from '@/env/hasWebviewProxy.js';\n\n/**\n * Returns true in case, current environment is Telegram Mini Apps.\n */\nexport async function isTMA(): Promise<boolean> {\n  if (hasWebviewProxy(window)) {\n    return true;\n  }\n  try {\n    await request({ method: 'web_app_request_theme', event: 'theme_changed', timeout: 100 });\n    return true;\n  } catch {\n    return false;\n  }\n}\n","import { saveToStorage } from '@/launch-params/saveToStorage.js';\nimport { parseMessage } from '@/bridge/parseMessage.js';\nimport { isIframe } from '@/env/isIframe.js';\nimport { hasExternalNotify } from '@/env/hasExternalNotify.js';\nimport { emitMiniAppsEvent } from '@/bridge/events/event-handlers/emitMiniAppsEvent.js';\nimport { serializeThemeParams } from '@/components/ThemeParams/parsing/serializeThemeParams.js';\nimport { parseLaunchParams } from '@/launch-params/parseLaunchParams.js';\nimport type { LaunchParams } from '@/launch-params/types.js';\nimport type { MiniAppsEventPayload } from '@/bridge/events/types.js';\n\n/**\n * Mocks a Telegram application environment.\n * @param launchParamsRaw - launch parameters presented as a string or query parameters.\n */\nexport function mockTelegramEnv(launchParamsRaw: LaunchParams | string): void {\n  const lp = typeof launchParamsRaw === 'string'\n    ? parseLaunchParams(launchParamsRaw)\n    : launchParamsRaw;\n\n  // Save launch params in the storage, so retrieveLaunchParams will return them.\n  saveToStorage(lp);\n\n  function wiredPostMessage(data: unknown): void {\n    if (typeof data !== 'string') {\n      return;\n    }\n    try {\n      const { eventType } = parseMessage(data);\n\n      if (eventType === 'web_app_request_theme') {\n        emitMiniAppsEvent('theme_changed', {\n          theme_params: JSON.parse(serializeThemeParams(lp.themeParams)),\n        } satisfies MiniAppsEventPayload<'theme_changed'>);\n      }\n\n      if (eventType === 'web_app_request_viewport') {\n        emitMiniAppsEvent('viewport_changed', {\n          width: window.innerWidth,\n          height: window.innerHeight,\n          is_state_stable: true,\n          is_expanded: true,\n        } satisfies MiniAppsEventPayload<'viewport_changed'>);\n      }\n    } catch {\n    }\n  }\n\n  // Override all possible ways of calling a Mini Apps method.\n  if (isIframe()) {\n    const postMessage = window.parent.postMessage.bind(window.parent);\n    window.parent.postMessage = data => {\n      void wiredPostMessage(data);\n      postMessage(data);\n    };\n    return;\n  }\n\n  if (hasExternalNotify(window)) {\n    const notify = window.external.notify.bind(window.external);\n    window.external.notify = data => {\n      void wiredPostMessage(data);\n      notify(data);\n    };\n    return;\n  }\n\n  const proxy = (window as any).TelegramWebviewProxy;\n  (window as any).TelegramWebviewProxy = {\n    ...(proxy || {}),\n    postEvent(...args: any) {\n      void wiredPostMessage(JSON.stringify({ eventType: args[0], eventData: args[1] }));\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n      proxy && proxy.postEvent(...args);\n    },\n  };\n}\n","import { SDKError } from './SDKError.js';\n\n/**\n * @returns True, if passed value is an instance of SDKError.\n * @param value - value to check.\n */\nexport function isSDKError(value: unknown): value is SDKError {\n  return value instanceof SDKError;\n}\n","import { isSDKError } from './isSDKError.js';\nimport type { ErrorType } from './errors.js';\n\n/**\n * Returns true if passed value is an SDK error of specified type.\n * @param value - value to check.\n * @param type - error type.\n */\nexport function isSDKErrorOfType(value: unknown, type: ErrorType): boolean {\n  return isSDKError(value) && value.type === type;\n}\n","import type {\n  BasicNavigatorAnyHistoryItem,\n  BasicNavigatorHistoryItem,\n} from '@/navigation/BasicNavigator/types.js';\n\n/**\n * Converts any known history item type to the local one.\n * @param item - history item presented as a string or an object.\n * @param relativePathname - relative pathname.\n */\nexport function prepareItem<Params>(\n  item: BasicNavigatorAnyHistoryItem<Params>,\n  relativePathname: string,\n): Readonly<BasicNavigatorHistoryItem<Params>> {\n  let pathname: string;\n  let params: Params | undefined;\n  let id: string | undefined;\n\n  if (typeof item === 'string') {\n    pathname = item;\n  } else {\n    pathname = item.pathname === undefined\n      ? relativePathname\n      : item.pathname;\n    params = item.params;\n    id = item.id;\n  }\n\n  return Object.freeze({\n    id: id || ((Math.random() * 2 ** 14) | 0).toString(16),\n    pathname,\n    params,\n  });\n}\n","import { off } from '@/bridge/events/listening/off.js';\nimport { on } from '@/bridge/events/listening/on.js';\nimport { type PostEvent, postEvent as defaultPostEvent } from '@/bridge/methods/postEvent.js';\nimport { createError } from '@/errors/createError.js';\nimport {\n  ERR_NAVIGATION_HISTORY_EMPTY,\n  ERR_NAVIGATION_INDEX_INVALID,\n} from '@/errors/errors.js';\nimport { EventEmitter } from '@/events/event-emitter/EventEmitter.js';\nimport { prepareItem } from '@/navigation/BasicNavigator/prepareItem.js';\nimport type {\n  BasicNavigatorAnyHistoryItem,\n  BasicNavigatorEvents,\n  BasicNavigatorHistoryItem,\n} from '@/navigation/BasicNavigator/types.js';\n\ntype Emitter<Params> = EventEmitter<BasicNavigatorEvents<Params>>;\n\nexport class BasicNavigator<Params = {}> {\n  /**\n   * Navigation history.\n   */\n  readonly history: Readonly<BasicNavigatorHistoryItem<Params>>[];\n\n  private readonly ee: Emitter<Params> = new EventEmitter();\n\n  constructor(\n    /**\n     * Navigation history.\n     */\n    history: readonly BasicNavigatorAnyHistoryItem<Params>[],\n    /**\n     * Currently active history item.\n     */\n    private _index: number,\n    /**\n     * Function to call Mini Apps methods.\n     * @default Global `postEvent` function.\n     */\n    private readonly postEvent: PostEvent = defaultPostEvent,\n  ) {\n    if (history.length === 0) {\n      throw createError(ERR_NAVIGATION_HISTORY_EMPTY, 'History should not be empty.');\n    }\n\n    if (_index < 0 || _index >= history.length) {\n      throw createError(\n        ERR_NAVIGATION_INDEX_INVALID,\n        'Index should not be zero and higher or equal than history size.',\n      );\n    }\n    this.history = history.map((item) => prepareItem(item, ''));\n  }\n\n  /**\n   * True, if current navigator is currently attached.\n   */\n  private attached = false;\n\n  /**\n   * Allows this navigator to control the `BackButton` visibility state. It also tracks the\n   * `BackButton` clicks and calls the `back` method.\n   */\n  attach(): void {\n    if (!this.attached) {\n      this.attached = true;\n      this.sync();\n      on('back_button_pressed', this.back);\n    }\n  }\n\n  /**\n   * Goes to the previous history item.\n   */\n  back = (): void => this.go(-1);\n\n  /**\n   * Currently active history item.\n   */\n  get current(): Readonly<BasicNavigatorHistoryItem<Params>> {\n    return this.history[this.index];\n  }\n\n  /**\n   * Prevents current navigator from controlling the BackButton visibility state.\n   */\n  detach(): void {\n    this.attached = false;\n    off('back_button_pressed', this.back);\n  }\n\n  /**\n   * Goes to the next history item.\n   */\n  forward(): void {\n    this.go(1);\n  }\n\n  /**\n   * Changes currently active history item index by the specified delta. This method doesn't\n   * change index in case, the updated index points to the non-existing history item. This behavior\n   * is preserved until the `fit` argument is specified.\n   * @param delta - index delta.\n   * @param fit - cuts the delta argument to fit the bounds `[0, history.length - 1]`.\n   */\n  go(delta: number, fit?: boolean): void {\n    // Compute the next index.\n    const index = this.index + delta;\n\n    // Cut the index to be in bounds [0, history.length - 1].\n    const fitIndex = Math.min(\n      Math.max(0, index),\n      this.history.length - 1,\n    );\n\n    // We perform \"go\" only in case, computed and cut indexes are equal or \"fit\" option was\n    // specified.\n    if (index === fitIndex || fit) {\n      // We are just calling setter to update the index and emit all related events.\n      this.replaceAndMove(fitIndex, this.history[fitIndex]);\n    }\n  }\n\n  /**\n   * Goes to the specified index. Method does nothing in case, passed index is out of bounds.\n   *\n   * If \"fit\" option was specified and index is out of bounds, it will be cut to the nearest\n   * bound.\n   * @param index - target index.\n   * @param fit - cuts the index argument to fit the bounds `[0, history.length - 1]`.\n   */\n  goTo(index: number, fit?: boolean): void {\n    this.go(index - this.index, fit);\n  }\n\n  /**\n   * True if navigator has items before the current item.\n   */\n  get hasPrev(): boolean {\n    return this.index > 0;\n  }\n\n  /**\n   * True if navigator has items after the current item.\n   */\n  get hasNext(): boolean {\n    return this.index !== this.history.length - 1;\n  }\n\n  /**\n   * Currently active history item index.\n   */\n  get index(): number {\n    return this._index;\n  }\n\n  /**\n   * Adds new event listener.\n   */\n  on: Emitter<Params>['on'] = this.ee.on.bind(this.ee);\n\n  /**\n   * Removes event listener.\n   */\n  off: Emitter<Params>['off'] = this.ee.off.bind(this.ee);\n\n  /**\n   * Adds a new history item removing all after the current one.\n   * @param item - item to add.\n   */\n  push(item: BasicNavigatorAnyHistoryItem<Params>): void {\n    if (this.hasNext) {\n      this.history.splice(this.index + 1);\n    }\n    this.replaceAndMove(this.index + 1, prepareItem(item, this.current.pathname));\n  }\n\n  /**\n   * Replaces the current history item.\n   * @param item - item to replace the current item with.\n   */\n  replace(item: BasicNavigatorAnyHistoryItem<Params>): void {\n    this.replaceAndMove(this.index, prepareItem(item, this.current.pathname));\n  }\n\n  /**\n   * Sets history item by the specified index.\n   * @param index - history item index to replace.\n   * @param historyItem - history item to set.\n   */\n  private replaceAndMove(index: number, historyItem: BasicNavigatorHistoryItem<Params>): void {\n    const delta = index - this.index;\n    if (!delta && this.current === historyItem) {\n      // Nothing changed.\n      return;\n    }\n\n    const from = this.current;\n\n    if (this.index !== index) {\n      const prevIndex = this._index;\n      this._index = index;\n\n      // If navigator is attached and back button local visibility state changed, we should\n      // notify Telegram app about it.\n      if (this.attached && prevIndex > 0 !== index > 0) {\n        this.sync();\n      }\n    }\n\n    this.history[index] = historyItem;\n    this.ee.emit('change', {\n      navigator: this,\n      from,\n      to: this.current,\n      delta,\n    });\n  }\n\n  /**\n   * Actualizes the `BackButton` visibility state.\n   */\n  private sync(): void {\n    this.postEvent('web_app_setup_back_button', { is_visible: !!this.index });\n  }\n}\n","import type { BasicNavigatorHistoryItem } from '@/navigation/BasicNavigator/types.js';\nimport type {\n  BrowserNavigatorHistoryItem,\n  BrowserNavigatorHistoryItemParams,\n} from '@/navigation/BrowserNavigator/types.js';\n\n/**\n * Converts basic navigator entry to browser navigator entry.\n */\nexport function basicItemToBrowser<State>(\n  {\n    params,\n    ...rest\n  }: BasicNavigatorHistoryItem<BrowserNavigatorHistoryItemParams<State>>,\n): BrowserNavigatorHistoryItem<State> {\n  return { ...(params || { hash: '', search: '' }), ...rest };\n}\n","import { createSafeURL } from '@/navigation/createSafeURL.js';\nimport type { URLLike } from '@/navigation/BrowserNavigator/types.js';\n\n/**\n * Extracts path part from a URL.\n * @param urlOrPath - URL instance or path.\n */\nexport function urlToPath(urlOrPath: string | Partial<URLLike>): string {\n  const isAbsolute = typeof urlOrPath === 'string'\n    ? urlOrPath.startsWith('/')\n    : !!(urlOrPath.pathname && urlOrPath.pathname.startsWith('/'));\n  const url = createSafeURL(urlOrPath);\n\n  return `${isAbsolute ? url.pathname : url.pathname.slice(1)}${url.search}${url.hash}`;\n}\n","import { ensurePrefix } from '@/navigation/ensurePrefix.js';\nimport { urlToPath } from '@/navigation/urlToPath.js';\nimport type { BrowserNavigatorAnyHistoryItem } from '@/navigation/BrowserNavigator/types.js';\n\ninterface PrepareItemResult<State> {\n  id?: string;\n  pathname: string;\n  params: {\n    hash: string;\n    search: string;\n    state?: State;\n  };\n}\n\n/**\n * Converts a path, presented as a string to a basic navigator appropriate form.\n * @param path - full path.\n * @param relativePath - relative path.\n * @param state - history item state.\n */\nexport function prepareItem<State>(\n  path: string,\n  relativePath: string,\n  state?: State,\n): PrepareItemResult<State>;\n\n/**\n * Converts a path, presented as an object to a basic navigator appropriate form.\n * @param item - history item data.\n * @param relativePath - relative path.\n */\nexport function prepareItem<State>(\n  item: BrowserNavigatorAnyHistoryItem<State>,\n  relativePath: string,\n): PrepareItemResult<State>;\n\nexport function prepareItem<State>(\n  itemOrPath: string | BrowserNavigatorAnyHistoryItem<State>,\n  relativePath: string,\n  state?: State,\n): PrepareItemResult<State> {\n  let path: string;\n  let id: string | undefined;\n\n  if (typeof itemOrPath === 'string') {\n    path = itemOrPath;\n  } else {\n    path = urlToPath(itemOrPath);\n    state = itemOrPath.state;\n    id = itemOrPath.id;\n  }\n\n  const { pathname, search, hash } = new URL(path, `http://a${ensurePrefix(relativePath, '/')}`);\n  return { id, pathname, params: { hash, search, state } };\n}\n","import { onWindow } from '@/events/onWindow.js';\n\n/**\n * Performs window.history.go operation waiting for it to be completed.\n * @param delta - history change delta.\n */\nexport async function go(delta: number): Promise<boolean> {\n  if (delta === 0) {\n    return true;\n  }\n\n  // We expect popstate event to occur during some time. Yeah, this seems tricky and not stable,\n  // but it seems like we have no other way out. Waiting for Navigation API to be implemented in\n  // browsers.\n  return Promise.race<boolean>([\n    new Promise((res) => {\n      const remove = onWindow('popstate', () => {\n        remove();\n        res(true);\n      });\n\n      window.history.go(delta);\n    }),\n\n    // Usually, it takes about 1ms to emit this event, but we use some buffer.\n    new Promise((res) => {\n      setTimeout(res, 50, false);\n    }),\n  ]);\n}\n","import { go } from '@/navigation/go.js';\n\n/**\n * Drops current browser history switching browser history cursor to the first one entry.\n */\nexport async function drop(): Promise<void> {\n  if (window.history.length <= 1) {\n    return;\n  }\n\n  // Push empty state to cut states we have no access to, placed after the current one.\n  window.history.pushState(null, '');\n\n  // By this line of code we cover the most recent case, when application is opened in WebView,\n  // but not in iframe. Applications opened in WebView have simple browser history containing\n  // only entries belonging to the current web application.\n  const goPerformed = await go(1 - window.history.length);\n  if (goPerformed) {\n    return;\n  }\n\n  // Nevertheless, iframe works a bit different in context of browser history. Calling\n  // window.history.length in iframe will return browser history information related to the\n  // external web environment too (e.g. browser tab). So, iframe shares the browser history with\n  // the external application, but has no access to its history entries. Calling window.history.go\n  // pointing out to the entry belonging to the external application will have no impact, so the\n  // previous idea with go(1 - ...) will not work.\n  //\n  // This is the reason why we iteratively call go(-1) to meet the entry which is recognized as\n  // the initial one for the current iframe.\n  let shouldGoBack = await go(-1);\n  while (shouldGoBack) {\n    shouldGoBack = await go(-1);\n  }\n}\n","import { createSafeURL } from '@/navigation/createSafeURL.js';\nimport type { URLLike } from '@/navigation/BrowserNavigator/types.js';\n\n/**\n * Extracts pathname from the value.\n * @param value - source value.\n */\nexport function getPathname(value: string | Partial<URLLike>): string {\n  return createSafeURL(value).pathname;\n}\n","import { EventEmitter } from '@/events/event-emitter/EventEmitter.js';\nimport { BasicNavigator } from '@/navigation/BasicNavigator/BasicNavigator.js';\nimport { basicItemToBrowser } from '@/navigation/BrowserNavigator/basicItemToBrowser.js';\nimport { prepareItem } from '@/navigation/BrowserNavigator/prepareItem.js';\nimport { createSafeURL } from '@/navigation/createSafeURL.js';\nimport { drop } from '@/navigation/drop.js';\nimport { ensurePrefix } from '@/navigation/ensurePrefix.js';\nimport { getPathname } from '@/navigation/getPathname.js';\nimport { go } from '@/navigation/go.js';\nimport { urlToPath } from '@/navigation/urlToPath.js';\nimport type { BasicNavigatorEvents } from '@/navigation/BasicNavigator/types.js';\nimport type {\n  BrowserNavigatorAnyHistoryItem,\n  BrowserNavigatorConOptions,\n  BrowserNavigatorEvents,\n  BrowserNavigatorHashMode,\n  BrowserNavigatorHistoryItem,\n  BrowserNavigatorHistoryItemParams,\n  URLLike,\n} from '@/navigation/BrowserNavigator/types.js';\n\nconst CURSOR_VOID = 0;\nconst CURSOR_BACK = 1;\nconst CURSOR_FORWARD = 2;\n\ntype Navigator<State> = BasicNavigator<BrowserNavigatorHistoryItemParams<State>>;\ntype Emitter<State> = EventEmitter<BrowserNavigatorEvents<State>>;\n\nexport class BrowserNavigator<State = {}> {\n  private readonly navigator: Navigator<State>;\n\n  private readonly ee: Emitter<State> = new EventEmitter();\n\n  readonly hashMode: BrowserNavigatorHashMode | null;\n\n  readonly base: string;\n\n  constructor(\n    /**\n     * Navigation history.\n     */\n    history: readonly BrowserNavigatorAnyHistoryItem<State>[],\n    /**\n     * Currently active history item index.\n     */\n    index: number,\n    { postEvent, hashMode = 'classic', base }: BrowserNavigatorConOptions = {},\n  ) {\n    this.navigator = new BasicNavigator(\n      history.map((item) => prepareItem(item, '/')),\n      index,\n      postEvent,\n    );\n    this.navigator.on('change', (e) => {\n      void this.onNavigatorChange(e);\n    });\n    this.hashMode = hashMode;\n    this.base = getPathname(base || '');\n  }\n\n  /**\n   * Shows whether the navigator is currently attached to the browser history.\n   */\n  private attached = false;\n\n  /**\n   * Attaches current navigator to the browser history allowing navigator to manipulate it.\n   */\n  async attach(): Promise<void> {\n    if (!this.attached) {\n      this.attached = true;\n      this.navigator.attach();\n      window.addEventListener('popstate', this.onPopState);\n      await this.syncHistory();\n    }\n  }\n\n  /**\n   * Goes back in history by 1.\n   */\n  back(): void {\n    this.navigator.back();\n  }\n\n  /**\n   * Detaches current navigator from the browser history.\n   */\n  detach() {\n    this.attached = false;\n    this.navigator.detach();\n    window.removeEventListener('popstate', this.onPopState);\n  }\n\n  /**\n   * Goes forward in history.\n   */\n  forward(): void {\n    return this.navigator.forward();\n  }\n\n  /**\n   * Current history cursor.\n   */\n  get index(): number {\n    return this.navigator.index;\n  }\n\n  /**\n   * Current history item identifier.\n   */\n  get id(): string {\n    return this.navigator.current.id;\n  }\n\n  /**\n   * Changes currently active history item index by the specified delta. This method doesn't\n   * change index in case, the updated index points to the non-existing history item. This behavior\n   * is preserved until the `fit` argument is specified.\n   * @param delta - index delta.\n   * @param fit - cuts the delta argument to fit the bounds `[0, history.length - 1]`.\n   */\n  go(delta: number, fit?: boolean): void {\n    return this.navigator.go(delta, fit);\n  }\n\n  /**\n   * Goes to the specified index. Method does nothing in case, passed index is out of bounds.\n   *\n   * If \"fit\" option was specified and index is out of bounds, it will be cut to the nearest\n   * bound.\n   * @param index - target index.\n   * @param fit - cuts the index argument to fit the bounds `[0, history.length - 1]`.\n   */\n  goTo(index: number, fit?: boolean): void {\n    this.navigator.goTo(index, fit);\n  }\n\n  /**\n   * Current history item hash.\n   * @see URL.hash\n   * @example\n   * \"\", \"#my-hash\"\n   */\n  get hash(): string {\n    return (this.navigator.current.params || {}).hash || '';\n  }\n\n  /**\n   * True if navigator has items before the current item.\n   */\n  get hasPrev(): boolean {\n    return this.navigator.hasPrev;\n  }\n\n  /**\n   * True if navigator has items after the current item.\n   */\n  get hasNext(): boolean {\n    return this.navigator.hasNext;\n  }\n\n  /**\n   * Navigation history.\n   */\n  get history(): BrowserNavigatorHistoryItem<State>[] {\n    return this.navigator.history.map(basicItemToBrowser);\n  }\n\n  /**\n   * Handles the window \"popstate\" event.\n   * @param state - event state.\n   */\n  private onPopState = ({ state }: PopStateEvent) => {\n    // In case state is null, we recognize current event as occurring whenever user clicks\n    // any anchor.\n    // TODO: Should we do it?\n    if (state === null) {\n      return this.push(this.parsePath(window.location.href));\n    }\n\n    // There is only one case when state can be CURSOR_VOID - when history contains\n    // only one element. In this case, we should return user to the current history element.\n    if (state === CURSOR_VOID) {\n      window.history.forward();\n    } else if (state === CURSOR_BACK) {\n      this.back();\n    }\n    if (state === CURSOR_FORWARD) {\n      this.forward();\n    }\n  };\n\n  /**\n   * Underlying navigator change event listener.\n   */\n  private onNavigatorChange = async ({\n    to,\n    from,\n    delta,\n  }: BasicNavigatorEvents<BrowserNavigatorHistoryItemParams<State>>['change']) => {\n    // If this navigator is attached to the browser history, we should synchronize.\n    if (this.attached) {\n      await this.syncHistory();\n    }\n    this.ee.emit('change', {\n      delta,\n      from: basicItemToBrowser(from),\n      to: basicItemToBrowser(to),\n      navigator: this,\n    });\n  };\n\n  /**\n   * Adds new event listener.\n   */\n  on: Emitter<State>['on'] = this.ee.on.bind(this.ee);\n\n  /**\n   * Removes event listener.\n   */\n  off: Emitter<State>['off'] = this.ee.off.bind(this.ee);\n\n  /**\n   * Path, including pathname, search and hash.\n   * @example Pathname only.\n   * \"/pathname\"\n   * @example Pathname + search.\n   * \"/pathname?search\"\n   * @example Pathname + hash.\n   * \"/pathname#hash\"\n   * @example Pathname + search + hash.\n   * \"/pathname?search#hash\"\n   */\n  get path(): string {\n    return urlToPath(this);\n  }\n\n  /**\n   * Current pathname. Always starts with the slash.\n   * @see URL.pathname\n   * @example\n   * \"/\", \"/abc\"\n   */\n  get pathname(): string {\n    return this.navigator.current.pathname;\n  }\n\n  /**\n   * Depending on the current navigation type, parses incoming path and returns it presented as\n   * an object. In other words, this method parses the passed path and returns object, describing\n   * how the navigator \"sees\" it.\n   *\n   * @example Hash mode is omitted.\n   * parsePath('/abc?a=1#hash');\n   * // { pathname: '/abc', search: '?a=1', hash: '#hash' }\n   * parsePath('http://example.com/abc?a=1#hash');\n   * // { pathname: '/abc', search: '?a=1', hash: '#hash' }\n   *\n   * @example Hash mode is enabled.\n   * parsePath('/abc?a=1#tma?is=cool#yeah');\n   * // { pathname: '/tma', search: '?is=cool', hash: '#yeah' }\n   * parsePath('http://example.com/abc?a=1#tma?is=cool#yeah');\n   * // { pathname: '/tma', search: '?is=cool', hash: '#yeah' }\n   */\n  parsePath(path: string | URL): URLLike {\n    let url = createSafeURL(path);\n    if (this.hashMode) {\n      url = createSafeURL(url.hash.slice(1));\n    }\n\n    return {\n      pathname: url.pathname,\n      search: url.search,\n      hash: url.hash,\n    };\n  }\n\n  /**\n   * Pushes new history item. Method replaces all entries after the current one with the one\n   * being pushed. Take a note, that passed item is always relative. In case, you want to use\n   * it as an absolute one, use the \"/\" prefix. Example: \"/absolute\", { pathname: \"/absolute\" }.\n   *\n   * To create a final path, navigator uses a method, used in the URL class constructor, resolving\n   * a path based on the current one.\n   * @param path - entry path.\n   * @param state - entry state.\n   *\n   * @example Pushing an absolute path.\n   * push(\"/absolute\"); // \"/absolute\"\n   *\n   * @example Pushing a relative path.\n   * push(\"relative\"); // \"/home/root\" -> \"/home/relative\"\n   *\n   * @example Pushing query parameters.\n   * push(\"/absolute?my-param=1\"); // \"/home/root\" -> \"/absolute?my-param=1\"\n   * push(\"relative?my-param=1\"); // \"/home/root\" -> \"/home/relative?my-param=1\"\n   * push(\"?my-param=1\"); // \"/home\" -> \"/home?my-param=1\"\n   *\n   * @example Pushing hash.\n   * push(\"#my-hash\"); // \"/home\" -> \"/home#my-hash\"\n   * push(\"relative#my-hash\"); // \"/home/root\" -> \"/home/relative#my-hash\"\n   *\n   * @example Pushing state.\n   * push(\"\", { state: 'my-state' }); \"/home/root\" -> \"/home/root\"\n   * push({ state: 'my-state' }); \"/home/root\" -> \"/home/root\"\n   */\n  push(path: string, state?: State): void;\n  push(item: BrowserNavigatorAnyHistoryItem<State>): void;\n  push(itemOrPath: string | BrowserNavigatorAnyHistoryItem<State>, fnState?: State): void {\n    const item = prepareItem(itemOrPath, this.path);\n    const { state = fnState } = item.params;\n    this.navigator.push({ ...item, params: { ...item.params, state } });\n  }\n\n  /**\n   * Replaces the current history item. Has the same logic as the `push` method.\n   * @param path - entry path.\n   * @param state - entry state.\n   * @see push\n   */\n  replace(path: string, state?: State): void;\n  replace(item: BrowserNavigatorAnyHistoryItem<State>): void;\n  replace(itemOrPath: string | BrowserNavigatorAnyHistoryItem<State>, fnState?: State): void {\n    const item = prepareItem(itemOrPath, this.path);\n    const { state = fnState } = item.params;\n    this.navigator.replace({ ...item, params: { ...item.params, state } });\n  }\n\n  /**\n   * Combines the navigator `base` property with the passed path data applying the navigator\n   * navigation mode.\n   * @param value - path presented as string or URLLike.\n   */\n  renderPath(value: string | URLLike): string {\n    const path = (this.base.length === 1 ? '' : this.base)\n      + ensurePrefix(urlToPath(value), '/');\n\n    return this.hashMode\n      ? ensurePrefix(path.slice(1), this.hashMode === 'classic' ? '#' : '#/')\n      : path;\n  }\n\n  /**\n   * Synchronizes current navigator state with browser history.\n   */\n  private async syncHistory(): Promise<void> {\n    // Remove history change event listener to get rid of side effects related to the possible\n    // future calls of history.go.\n    window.removeEventListener('popstate', this.onPopState);\n\n    const { state } = this;\n    const path = this.renderPath(this);\n\n    // Drop the browser history and work with the clean one.\n    await drop();\n\n    if (this.hasPrev && this.hasNext) {\n      // We have both previous and next elements. History should be:\n      // [back, *current*, forward]\n      window.history.replaceState(CURSOR_BACK, '');\n      window.history.pushState(state, '', path);\n      window.history.pushState(CURSOR_FORWARD, '');\n\n      await go(-1);\n    } else if (this.hasPrev) {\n      // We have only previous element. History should be:\n      // [back, *current*]\n      window.history.replaceState(CURSOR_BACK, '');\n      window.history.pushState(state, '', path);\n    } else if (this.hasNext) {\n      // We have only next element. History should be:\n      // [*current*, forward]\n      window.history.replaceState(state, path);\n      window.history.pushState(CURSOR_FORWARD, '');\n\n      await go(-1);\n    } else {\n      // We have no back and next elements. History should be:\n      // [void, *current*]\n      window.history.replaceState(CURSOR_VOID, '');\n      window.history.pushState(state, '', path);\n    }\n\n    window.addEventListener('popstate', this.onPopState);\n  }\n\n  /**\n   * Current query parameters.\n   * @see URL.search\n   * @example\n   * \"\", \"?\", \"?a=1\"\n   */\n  get search(): string {\n    return (this.navigator.current.params || {}).search || '';\n  }\n\n  /**\n   * Current history item state.\n   */\n  get state(): State | undefined {\n    return (this.navigator.current.params || {}).state;\n  }\n}\n","import { createError } from '@/errors/createError.js';\nimport { ERR_INVALID_PATH_BASE } from '@/errors/errors.js';\nimport { BrowserNavigator } from '@/navigation/BrowserNavigator/BrowserNavigator.js';\nimport { getPathname } from '@/navigation/getPathname.js';\nimport { urlToPath } from '@/navigation/urlToPath.js';\nimport type { BrowserNavigatorConOptions } from '@/navigation/BrowserNavigator/types.js';\n\nexport function createBrowserNavigatorFromLocation<State>(\n  options?: BrowserNavigatorConOptions,\n): BrowserNavigator<State> {\n  options ||= {};\n  const { href, hash } = window.location;\n\n  let path = urlToPath(\n    options.hashMode === null\n      // Hash mode is explicitly disabled. We are working with the usual location path.\n      ? href\n      // If hash mode is enabled, we should create a navigator based on the location's hash.\n      // In this case we have 2 possible situations:\n      // 1. Hash contains only launch parameters. Example:\n      // #tgWebAppData=...&tgWebAppPlatform=...&...\n      // Here we should mark the launch parameters as query parameters and have pathname \"/\" as\n      // the initial one.\n      //\n      // 2. Hash contains value, passed from above and launch parameters as query parameters.\n      // For instance, we could have such a URL:\n      // https://t.me/mybot/myapp#my-hash\n      // In this case, the Mini App will be opened with this URL:\n      // https://example.com/#my-hash?tgWebAppData=...&tgWebAppPlatform=...&...\n      : hash.includes('?') ? hash.slice(1) : `?${hash.slice(1)}`,\n  );\n\n  // If some base was specified, we should check if computed path starts with this base. In\n  // case it does, it should be removed from the path. Otherwise, an error must be thrown.\n  const base = options.base ? getPathname(options.base) : undefined;\n  if (base) {\n    if (!path.startsWith(base)) {\n      throw createError(\n        ERR_INVALID_PATH_BASE,\n        `Path \"${path}\" expected to be starting with \"${base}\"`,\n      );\n    }\n    path = path.slice(base.length);\n  }\n\n  return new BrowserNavigator<State>([path], 0, options);\n}\n","/**\n * @param value - string to take hash part from.\n * @returns String after the first met \"#\" symbol. In case, value doesn't contain hashtag, the\n * function will return null.\n *\n * @example No hash.\n * getHash('/path'); // null\n *\n * @example Has hash.\n * getHash('/path#abc'); // 'abc'\n *\n * @example Has double hash.\n * getHash('/path#abc#another'); // 'abc#another'\n */\nexport function getHash(value: string): string | null {\n  const match = value.match(/#(.+)/);\n  return match ? match[1] : null;\n}\n","import {\n  BrowserNavigatorConOptions,\n  BrowserNavigatorHistoryItem,\n} from '@/navigation/BrowserNavigator/types.js';\nimport { BrowserNavigator } from '@/navigation/BrowserNavigator/BrowserNavigator.js';\nimport { isPageReload } from '@/navigation/isPageReload.js';\nimport {\n  createBrowserNavigatorFromLocation\n} from '@/navigation/BrowserNavigator/createBrowserNavigatorFromLocation.js';\n\n\nfunction instantiate<State>(\n  sessionStorageKey: string,\n  options?: BrowserNavigatorConOptions,\n): BrowserNavigator<State> {\n  // If page was reloaded, we assume that navigator had to previously save its state in the\n  // session storage.\n  if (isPageReload()) {\n    const stateRaw = sessionStorage.getItem(sessionStorageKey);\n    if (stateRaw) {\n      try {\n        const { index, history } = JSON.parse(stateRaw);\n        return new BrowserNavigator(\n          history as BrowserNavigatorHistoryItem<State>[],\n          index as number,\n          options\n        );\n      } catch (e) {\n        console.error('Unable to restore hash navigator state.', e);\n      }\n    }\n  }\n\n  // In case, we could not restore its state, or it is a fresh start, we can create an empty\n  // navigator. We are creating BrowserNavigator from the window.location.\n  return createBrowserNavigatorFromLocation(options);\n}\n\n/**\n * Initializes a standard Mini Apps navigator.\n * @param sessionStorageKey - session storage key, containing the navigator state.\n * @param options - additional BrowserNavigator options.\n */\nexport function initNavigator<State>(\n  sessionStorageKey: string,\n  options?: BrowserNavigatorConOptions,\n): BrowserNavigator<State> {\n  const navigator = instantiate<State>(sessionStorageKey, options);\n\n  const saveState = () => sessionStorage.setItem(sessionStorageKey, JSON.stringify({\n    index: navigator.index,\n    history: navigator.history,\n  }));\n\n  // Whenever navigator changes its state, we save it in the session storage.\n  navigator.on('change', saveState);\n\n  // Save the initial state to make sure nothing will break when the page was reloaded.\n  saveState();\n\n  return navigator;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}